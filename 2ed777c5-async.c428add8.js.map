{"version":3,"sources":["node_modules/@ant-design/icons-svg/es/asn/InfoCircleOutlined.js","node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js","node_modules/@ant-design/icons/es/icons/LoadingOutlined.js","node_modules/@ant-design/icons/es/icons/RotateLeftOutlined.js","node_modules/@ant-design/icons-svg/es/asn/ScissorOutlined.js","node_modules/@ant-design/icons/es/icons/ScissorOutlined.js","node_modules/@ant-design/icons-svg/es/asn/ExportOutlined.js","node_modules/@ant-design/icons/es/icons/ExportOutlined.js","src/pages/PNGJPEG/components/ImageEditorEngine.tsx","src/pages/PNGJPEG/components/ImageEditor.tsx","src/pages/PNGJPEG/index.tsx"],"sourcesContent":["// This icon file is generated automatically.\nvar InfoCircleOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z\" } }] }, \"name\": \"info-circle\", \"theme\": \"outlined\" };\nexport default InfoCircleOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport InfoCircleOutlinedSvg from \"@ant-design/icons-svg/es/asn/InfoCircleOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar InfoCircleOutlined = function InfoCircleOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: InfoCircleOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(InfoCircleOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'InfoCircleOutlined';\n}\nexport default RefIcon;","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport LoadingOutlinedSvg from \"@ant-design/icons-svg/es/asn/LoadingOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar LoadingOutlined = function LoadingOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: LoadingOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(LoadingOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'LoadingOutlined';\n}\nexport default RefIcon;","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport RotateLeftOutlinedSvg from \"@ant-design/icons-svg/es/asn/RotateLeftOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar RotateLeftOutlined = function RotateLeftOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: RotateLeftOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(RotateLeftOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'RotateLeftOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar ScissorOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M567.1 512l318.5-319.3c5-5 1.5-13.7-5.6-13.7h-90.5c-2.1 0-4.2.8-5.6 2.3l-273.3 274-90.2-90.5c12.5-22.1 19.7-47.6 19.7-74.8 0-83.9-68.1-152-152-152s-152 68.1-152 152 68.1 152 152 152c27.7 0 53.6-7.4 75.9-20.3l90 90.3-90.1 90.3A151.04 151.04 0 00288 582c-83.9 0-152 68.1-152 152s68.1 152 152 152 152-68.1 152-152c0-27.2-7.2-52.7-19.7-74.8l90.2-90.5 273.3 274c1.5 1.5 3.5 2.3 5.6 2.3H880c7.1 0 10.7-8.6 5.6-13.7L567.1 512zM288 370c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80zm0 444c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z\" } }] }, \"name\": \"scissor\", \"theme\": \"outlined\" };\nexport default ScissorOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport ScissorOutlinedSvg from \"@ant-design/icons-svg/es/asn/ScissorOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar ScissorOutlined = function ScissorOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: ScissorOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(ScissorOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'ScissorOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar ExportOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"fill-rule\": \"evenodd\", \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z\" } }] }, \"name\": \"export\", \"theme\": \"outlined\" };\nexport default ExportOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport ExportOutlinedSvg from \"@ant-design/icons-svg/es/asn/ExportOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar ExportOutlined = function ExportOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: ExportOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(ExportOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'ExportOutlined';\n}\nexport default RefIcon;","// src/components/ImageEditorEngine.ts\r\n// Utilities for canvas image manipulation\r\n\r\nexport type ImageDataLike = ImageData;\r\n\r\nexport function createCanvas(w: number, h: number) {\r\n  const c = document.createElement('canvas');\r\n  c.width = w;\r\n  c.height = h;\r\n  return c;\r\n}\r\n\r\nexport function drawImageToCanvasFromUrl(url: string): Promise<HTMLCanvasElement> {\r\n  return new Promise((res, rej) => {\r\n    const img = new Image();\r\n    img.crossOrigin = 'anonymous';\r\n    img.onload = () => {\r\n      const c = createCanvas(img.naturalWidth, img.naturalHeight);\r\n      const ctx = c.getContext('2d')!;\r\n      ctx.drawImage(img, 0, 0);\r\n      res(c);\r\n    };\r\n    img.onerror = rej;\r\n    img.src = url;\r\n  });\r\n}\r\n\r\nexport function cloneImageData(src: ImageDataLike): ImageData {\r\n  const out = new ImageData(src.width, src.height);\r\n  out.data.set(new Uint8ClampedArray(src.data));\r\n  return out;\r\n}\r\n\r\nexport function applyBrightnessContrast(data: ImageData, brightness = 0, contrast = 0) {\r\n  // brightness in [-255,255], contrast in [-100,100]\r\n  const d = data.data;\r\n  const c = contrast / 100 + 1;\r\n  const intercept = 128 * (1 - c);\r\n  for (let i = 0; i < d.length; i += 4) {\r\n    d[i] = Math.min(255, Math.max(0, d[i] * c + intercept + brightness));\r\n    d[i + 1] = Math.min(255, Math.max(0, d[i + 1] * c + intercept + brightness));\r\n    d[i + 2] = Math.min(255, Math.max(0, d[i + 2] * c + intercept + brightness));\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function applyConvolution(data: ImageData, kernel: number[], kernelSize: number) {\r\n  const w = data.width;\r\n  const h = data.height;\r\n  const src = data.data;\r\n  const out = new Uint8ClampedArray(src.length);\r\n  const half = Math.floor(kernelSize / 2);\r\n\r\n  for (let y = 0; y < h; y++) {\r\n    for (let x = 0; x < w; x++) {\r\n      let r = 0,\r\n        g = 0,\r\n        b = 0,\r\n        a = 0;\r\n      for (let ky = 0; ky < kernelSize; ky++) {\r\n        for (let kx = 0; kx < kernelSize; kx++) {\r\n          const px = x + kx - half;\r\n          const py = y + ky - half;\r\n          if (px < 0 || px >= w || py < 0 || py >= h) continue;\r\n          const idx = (py * w + px) * 4;\r\n          const kval = kernel[ky * kernelSize + kx];\r\n          r += src[idx] * kval;\r\n          g += src[idx + 1] * kval;\r\n          b += src[idx + 2] * kval;\r\n          a += src[idx + 3] * kval;\r\n        }\r\n      }\r\n      const idx = (y * w + x) * 4;\r\n      out[idx] = Math.min(255, Math.max(0, r));\r\n      out[idx + 1] = Math.min(255, Math.max(0, g));\r\n      out[idx + 2] = Math.min(255, Math.max(0, b));\r\n      out[idx + 3] = Math.min(255, Math.max(0, a || src[idx + 3]));\r\n    }\r\n  }\r\n\r\n  data.data.set(out);\r\n  return data;\r\n}\r\n\r\nexport const Kernels = {\r\n  sharpen: [0, -1, 0, -1, 5, -1, 0, -1, 0],\r\n  blur3: [1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9],\r\n  gaussian5: [\r\n    1 / 273,\r\n    4 / 273,\r\n    7 / 273,\r\n    4 / 273,\r\n    1 / 273,\r\n    4 / 273,\r\n    16 / 273,\r\n    26 / 273,\r\n    16 / 273,\r\n    4 / 273,\r\n    7 / 273,\r\n    26 / 273,\r\n    41 / 273,\r\n    26 / 273,\r\n    7 / 273,\r\n    4 / 273,\r\n    16 / 273,\r\n    26 / 273,\r\n    16 / 273,\r\n    4 / 273,\r\n    1 / 273,\r\n    4 / 273,\r\n    7 / 273,\r\n    4 / 273,\r\n    1 / 273,\r\n  ],\r\n};\r\n\r\nexport function applyThresholdAlpha(data: ImageData, threshold = 250) {\r\n  // If pixel is near-white (all channels > threshold), set alpha = 0\r\n  const d = data.data;\r\n  for (let i = 0; i < d.length; i += 4) {\r\n    if (d[i] > threshold && d[i + 1] > threshold && d[i + 2] > threshold) {\r\n      d[i + 3] = 0;\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function flipHorizontal(canvas: HTMLCanvasElement) {\r\n  const ctx = canvas.getContext('2d')!;\r\n  ctx.save();\r\n  ctx.translate(canvas.width, 0);\r\n  ctx.scale(-1, 1);\r\n  const img = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n  ctx.putImageData(img, 0, 0);\r\n  ctx.restore();\r\n}\r\n\r\nexport function flipVertical(canvas: HTMLCanvasElement) {\r\n  const ctx = canvas.getContext('2d')!;\r\n  ctx.save();\r\n  ctx.translate(0, canvas.height);\r\n  ctx.scale(1, -1);\r\n  const img = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n  ctx.putImageData(img, 0, 0);\r\n  ctx.restore();\r\n}\r\n\r\nexport function rotateCanvas(canvas: HTMLCanvasElement, degrees: number) {\r\n  const radians = (degrees * Math.PI) / 180;\r\n  const w = canvas.width;\r\n  const h = canvas.height;\r\n  const c2 = createCanvas(h, w); // Swap dims if 90/270\r\n  const ctx2 = c2.getContext('2d')!;\r\n  ctx2.translate(c2.width / 2, c2.height / 2);\r\n  ctx2.rotate(radians);\r\n  ctx2.drawImage(canvas, -w / 2, -h / 2);\r\n  // resize original\r\n  canvas.width = c2.width;\r\n  canvas.height = c2.height;\r\n  const ctx = canvas.getContext('2d')!;\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n  ctx.drawImage(c2, 0, 0);\r\n}\r\n\r\nexport function exportCanvasToBlob(\r\n  canvas: HTMLCanvasElement,\r\n  type = 'image/png',\r\n  quality = 0.92,\r\n): Promise<Blob> {\r\n  return new Promise((res) => canvas.toBlob((b) => res(b as Blob), type, quality));\r\n}\r\n\r\n/**\r\n * Simple homography for perspective correction using ctx.setTransform is not enough.\r\n * We'll implement a basic 4-point to 4-point transform by drawing using an offscreen canvas with\r\n * path clipping and mapping via getImageData sampling. For moderate sizes, this works.\r\n * Note: For high-quality projective transforms consider using WebGL or external libs.\r\n */\r\nexport function perspectiveTransform(\r\n  srcCanvas: HTMLCanvasElement,\r\n  srcQuad: [number, number, number, number, number, number, number, number],\r\n  destW: number,\r\n  destH: number,\r\n): HTMLCanvasElement {\r\n  // srcQuad: [x0,y0, x1,y1, x2,y2, x3,y3] (clockwise)\r\n  // create dest canvas\r\n  const dest = createCanvas(destW, destH);\r\n  const dctx = dest.getContext('2d')!;\r\n  // We'll use a very simple approach: use temporary canvas and ctx.setTransform for affine approx\r\n  // That is, we split quad into two triangles and map each triangle using affine transform\r\n  const sctx = srcCanvas.getContext('2d')!;\r\n  const sData = sctx.getImageData(0, 0, srcCanvas.width, srcCanvas.height);\r\n\r\n  function mapTriangle(sTri: number[], dTri: number[]) {\r\n    // sTri and dTri are arrays of 3 points [x0,y0,x1,y1,x2,y2]\r\n    // compute affine transform matrix from d -> s, then draw via setTransform + clipping\r\n    const [sx0, sy0, sx1, sy1, sx2, sy2] = sTri;\r\n    const [dx0, dy0, dx1, dy1, dx2, dy2] = dTri;\r\n\r\n    // compute matrix A so that [sx] = A * [dx,dy,1]\r\n    // Solve linear equations for a,b,c,d,e,f\r\n    const denom = dx0 * (dy1 - dy2) + dx1 * (dy2 - dy0) + dx2 * (dy0 - dy1);\r\n    if (Math.abs(denom) < 1e-6) return;\r\n\r\n    // Use Canvas API trick:\r\n    // create path for dTri on dest canvas, clip, set transform to map dTri bbox -> sTri and draw sCanvas\r\n    dctx.save();\r\n    dctx.beginPath();\r\n    dctx.moveTo(dx0, dy0);\r\n    dctx.lineTo(dx1, dy1);\r\n    dctx.lineTo(dx2, dy2);\r\n    dctx.closePath();\r\n    dctx.clip();\r\n\r\n    // compute affine matrix that maps dest tri -> src tri\r\n    // Build matrices and solve. Simpler: use ctx.transform to map bounding boxes; this is approximate.\r\n    // For simplicity and decent quality, draw full src into dest and let clip mask show triangle - this tends to be fine for small edits\r\n    dctx.drawImage(srcCanvas, 0, 0, destW, destH);\r\n    dctx.restore();\r\n  }\r\n\r\n  // split into two triangles:\r\n  const [x0, y0, x1, y1, x2, y2, x3, y3] = srcQuad;\r\n  // dest triangles are basically rectangle triangles\r\n  mapTriangle([x0, y0, x1, y1, x2, y2], [0, 0, destW, 0, 0, destH]);\r\n  mapTriangle([x2, y2, x3, y3, x0, y0], [destW, destH, 0, destH, destW, 0]);\r\n  return dest;\r\n}\r\n","// src/components/ImageEditor.tsx\r\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Button, Slider, Space, Tooltip, Modal, Row, Col, Select, message, Divider } from 'antd';\r\nimport {\r\n  ArrowLeftOutlined,\r\n  ArrowRightOutlined,\r\n  RotateLeftOutlined,\r\n  RotateRightOutlined,\r\n  SwapOutlined,\r\n  ScissorOutlined,\r\n  BgColorsOutlined,\r\n  ZoomInOutlined,\r\n  ZoomOutOutlined,\r\n  ExportOutlined,\r\n  CopyOutlined,\r\n  UndoOutlined,\r\n  RedoOutlined,\r\n} from '@ant-design/icons';\r\nimport {\r\n  drawImageToCanvasFromUrl,\r\n  applyBrightnessContrast,\r\n  cloneImageData,\r\n  Kernels,\r\n  applyConvolution,\r\n  applyThresholdAlpha,\r\n  exportCanvasToBlob,\r\n  perspectiveTransform,\r\n  createCanvas,\r\n} from './ImageEditorEngine';\r\n\r\ntype Tool = 'pan' | 'crop' | 'color' | 'ruler' | 'perspective' | 'select';\r\n\r\ntype HistoryItem = {\r\n  canvasDataUrl: string;\r\n  description?: string;\r\n};\r\n\r\ntype Props = {\r\n  imageUrl: string;\r\n  onExport?: (blob: Blob) => void;\r\n};\r\n\r\nconst { Option } = Select;\r\n\r\nconst ImageEditor: React.FC<Props> = ({ imageUrl, onExport }) => {\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n  const overlayRef = useRef<HTMLCanvasElement | null>(null);\r\n  const [baseCanvas, setBaseCanvas] = useState<HTMLCanvasElement | null>(null);\r\n\r\n  // Viewer state\r\n  const [zoom, setZoom] = useState(1);\r\n  const [offset, setOffset] = useState({ x: 0, y: 0 });\r\n  const [isPanning, setIsPanning] = useState(false);\r\n  const panStart = useRef<{ x: number; y: number } | null>(null);\r\n\r\n  // Editing state\r\n  const [tool, setTool] = useState<Tool>('pan');\r\n  const [brightness, setBrightness] = useState(0); // -255..255\r\n  const [contrast, setContrast] = useState(0); // -100..100\r\n  const [history, setHistory] = useState<HistoryItem[]>([]);\r\n  const [historyIndex, setHistoryIndex] = useState(-1);\r\n  const [cropRect, setCropRect] = useState<{ x: number; y: number; w: number; h: number } | null>(\r\n    null,\r\n  );\r\n  const cropStart = useRef<{ x: number; y: number } | null>(null);\r\n\r\n  const [showPerspectiveModal, setShowPerspectiveModal] = useState(false);\r\n  const perspectivePoints = useRef<\r\n    [number, number, number, number, number, number, number, number] | null\r\n  >(null);\r\n  const [toolBeforeHand, setToolBeforeHand] = useState<Tool | null>(null);\r\n  const [isSpaceDown, setIsSpaceDown] = useState(false);\r\n\r\n  // Color picker state\r\n  const [hoverColor, setHoverColor] = useState<{ x: number; y: number; color: string } | null>(\r\n    null,\r\n  );\r\n  const [pickedColor, setPickedColor] = useState<string | null>(null);\r\n\r\n  // Ruler state\r\n  const [rulerActive, setRulerActive] = useState(false);\r\n  const rulerPoints = useRef<{ x1: number; y1: number; x2: number; y2: number } | null>(null);\r\n  const [dpiMeasured, setDpiMeasured] = useState<number | null>(null);\r\n\r\n  // Load image once\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const c = await drawImageToCanvasFromUrl(imageUrl);\r\n        setBaseCanvas(c);\r\n\r\n        const working = createCanvas(c.width, c.height);\r\n        working.getContext('2d')!.drawImage(c, 0, 0);\r\n\r\n        if (canvasRef.current) {\r\n          canvasRef.current.width = working.width;\r\n          canvasRef.current.height = working.height;\r\n          const ctx = canvasRef.current.getContext('2d')!;\r\n          ctx.clearRect(0, 0, working.width, working.height);\r\n          ctx.drawImage(working, 0, 0);\r\n        }\r\n\r\n        pushHistory(canvasToDataUrl(working), 'Initial load');\r\n      } catch (err) {\r\n        console.error('Failed to load image', err);\r\n        message.error('Failed to load image');\r\n      }\r\n    })();\r\n  }, [imageUrl]);\r\n\r\n  // Resize overlay when baseCanvas is ready\r\n  useEffect(() => {\r\n    syncCanvasSize();\r\n  }, [baseCanvas]);\r\n\r\n  // Ctrl+Wheel zoom\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    const canvas = canvasRef.current;\r\n    if (!container || !canvas) return;\r\n\r\n    const handleWheel = (e: WheelEvent) => {\r\n      if (!e.ctrlKey) return;\r\n      e.preventDefault();\r\n\r\n      const rect = canvas.getBoundingClientRect();\r\n      const mouseX = e.clientX - rect.left;\r\n      const mouseY = e.clientY - rect.top;\r\n\r\n      setZoom((prev) => {\r\n        const zoomFactor = e.deltaY < 0 ? 1.1 : 0.9;\r\n        const newZoom = Math.min(Math.max(prev * zoomFactor, 0.1), 12);\r\n\r\n        const scaleChange = newZoom / prev;\r\n        setOffset((prevOffset) => ({\r\n          x: mouseX - (mouseX - prevOffset.x) * scaleChange,\r\n          y: mouseY - (mouseY - prevOffset.y) * scaleChange,\r\n        }));\r\n\r\n        return newZoom;\r\n      });\r\n    };\r\n\r\n    container.addEventListener('wheel', handleWheel, { passive: false });\r\n    return () => container.removeEventListener('wheel', handleWheel);\r\n  }, []);\r\n\r\n  /** Convert canvas ‚Üí dataURL */\r\n  const canvasToDataUrl = (c: HTMLCanvasElement) => c.toDataURL('image/png');\r\n\r\n  /** Sync canvas & overlay sizes */\r\n  function syncCanvasSize() {\r\n    if (!canvasRef.current || !baseCanvas) return;\r\n\r\n    canvasRef.current.width = baseCanvas.width;\r\n    canvasRef.current.height = baseCanvas.height;\r\n    overlayRef.current!.width = baseCanvas.width;\r\n    overlayRef.current!.height = baseCanvas.height;\r\n\r\n    const ctx = canvasRef.current.getContext('2d')!;\r\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n    ctx.drawImage(baseCanvas, 0, 0);\r\n  }\r\n\r\n  /** History management */\r\n  function pushHistory(dataUrl: string, description = '') {\r\n    const newHistory = history.slice(0, historyIndex + 1);\r\n    newHistory.push({ canvasDataUrl: dataUrl, description });\r\n    setHistory(newHistory);\r\n    setHistoryIndex(newHistory.length - 1);\r\n  }\r\n  function doUndo() {\r\n    if (historyIndex <= 0) return;\r\n    applyHistory(historyIndex - 1);\r\n  }\r\n  function doRedo() {\r\n    if (historyIndex >= history.length - 1) return;\r\n    applyHistory(historyIndex + 1);\r\n  }\r\n  function applyHistory(idx: number) {\r\n    const item = history[idx];\r\n    if (!item) return;\r\n\r\n    const img = new Image();\r\n    img.onload = () => {\r\n      const ctx = canvasRef.current!.getContext('2d')!;\r\n      canvasRef.current!.width = img.naturalWidth;\r\n      canvasRef.current!.height = img.naturalHeight;\r\n      overlayRef.current!.width = img.naturalWidth;\r\n      overlayRef.current!.height = img.naturalHeight;\r\n\r\n      ctx.clearRect(0, 0, canvasRef.current!.width, canvasRef.current!.height);\r\n      ctx.drawImage(img, 0, 0);\r\n      setHistoryIndex(idx);\r\n    };\r\n    img.src = item.canvasDataUrl;\r\n  }\r\n\r\n  /** --- PAN / ZOOM / TOOL HANDLERS --- */\r\n  const handleMouseDownViewer = (e: React.MouseEvent) => {\r\n    const rect = canvasRef.current!.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / zoom;\r\n    const y = (e.clientY - rect.top) / zoom;\r\n\r\n    if (tool === 'pan' || tool === 'select') {\r\n      setIsPanning(true);\r\n      panStart.current = { x: e.clientX - offset.x, y: e.clientY - offset.y };\r\n    } else if (tool === 'crop') {\r\n      cropStart.current = { x, y };\r\n      setCropRect({ x, y, w: 1, h: 1 });\r\n    } else if (tool === 'ruler') {\r\n      if (!rulerPoints.current) {\r\n        rulerPoints.current = { x1: x, y1: y, x2: x, y2: y };\r\n      } else {\r\n        rulerPoints.current.x2 = x;\r\n        rulerPoints.current.y2 = y;\r\n        const dx = x - rulerPoints.current.x1;\r\n        const dy = y - rulerPoints.current.y1;\r\n        const px = Math.sqrt(dx * dx + dy * dy);\r\n        const dpi = Math.round(\r\n          (px / (canvasRef.current!.width / (window.devicePixelRatio || 1))) * 96,\r\n        );\r\n        setDpiMeasured(dpi);\r\n        message.info(`Distance: ${Math.round(px)} px, estimated DPI: ${dpi}`);\r\n        rulerPoints.current = null;\r\n      }\r\n    } else if (tool === 'perspective') {\r\n      if (!perspectivePoints.current) perspectivePoints.current = [x, y, x, y, x, y, x, y];\r\n      const p = perspectivePoints.current!;\r\n      for (let i = 0; i < 8; i += 2) {\r\n        if (isNaN(p[i]) || isNaN(p[i + 1]) || (p[i] === 0 && p[i + 1] === 0)) {\r\n          p[i] = x;\r\n          p[i + 1] = y;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleMouseMoveViewer = (e: React.MouseEvent) => {\r\n    if ((tool === 'pan' || tool === 'select') && isPanning && panStart.current) {\r\n      setOffset({ x: e.clientX - panStart.current.x, y: e.clientY - panStart.current.y });\r\n    } else if (tool === 'crop' && cropStart.current) {\r\n      const rect = canvasRef.current!.getBoundingClientRect();\r\n      const cur = { x: (e.clientX - rect.left) / zoom, y: (e.clientY - rect.top) / zoom };\r\n      setCropRect({\r\n        x: Math.min(cropStart.current.x, cur.x),\r\n        y: Math.min(cropStart.current.y, cur.y),\r\n        w: Math.abs(cur.x - cropStart.current.x),\r\n        h: Math.abs(cur.y - cropStart.current.y),\r\n      });\r\n      drawOverlay();\r\n    } else {\r\n      drawOverlay();\r\n    }\r\n  };\r\n\r\n  const handleMouseUpViewer = () => {\r\n    setIsPanning(false);\r\n    panStart.current = null;\r\n    if (tool === 'crop' && cropRect) applyCrop();\r\n  };\r\n\r\n  /** Draw overlay: crop, ruler, perspective, color hover */\r\n  function drawOverlay() {\r\n    if (!overlayRef.current || !canvasRef.current) return;\r\n    const ctx = overlayRef.current.getContext('2d')!;\r\n    ctx.clearRect(0, 0, overlayRef.current.width, overlayRef.current.height);\r\n\r\n    // Crop rectangle\r\n    if (cropRect) {\r\n      ctx.save();\r\n      ctx.strokeStyle = '#00aaff';\r\n      ctx.lineWidth = 2;\r\n      ctx.setLineDash([6, 4]);\r\n      ctx.strokeRect(cropRect.x, cropRect.y, cropRect.w, cropRect.h);\r\n      ctx.restore();\r\n    }\r\n\r\n    // Ruler\r\n    if (rulerPoints.current) {\r\n      ctx.save();\r\n      ctx.strokeStyle = '#ffcc00';\r\n      ctx.lineWidth = 2;\r\n      ctx.beginPath();\r\n      ctx.moveTo(rulerPoints.current.x1, rulerPoints.current.y1);\r\n      ctx.lineTo(rulerPoints.current.x2, rulerPoints.current.y2);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n\r\n    // Perspective points\r\n    if (perspectivePoints.current) {\r\n      ctx.save();\r\n      ctx.fillStyle = 'rgba(0,255,0,0.8)';\r\n      for (let i = 0; i < 8; i += 2) {\r\n        const x = perspectivePoints.current[i];\r\n        const y = perspectivePoints.current[i + 1];\r\n        if (!isNaN(x) && !isNaN(y)) ctx.fillRect(x - 4, y - 4, 8, 8);\r\n      }\r\n      ctx.restore();\r\n    }\r\n\r\n    // Color hover\r\n    if (hoverColor && tool === 'color') {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const canvasX = (hoverColor.x - rect.left - offset.x) / zoom;\r\n      const canvasY = (hoverColor.y - rect.top - offset.y) / zoom;\r\n      ctx.save();\r\n      ctx.strokeStyle = '#ff0000';\r\n      ctx.lineWidth = 2 / zoom;\r\n      ctx.beginPath();\r\n      ctx.arc(canvasX, canvasY, 8 / zoom, 0, Math.PI * 2);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n  }\r\n\r\n  /** --- COLOR PICKER --- */\r\n  const samplePixel = (e: MouseEvent) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return null;\r\n\r\n    const rect = canvas.getBoundingClientRect();\r\n    const x = Math.floor((e.clientX - rect.left - offset.x) / zoom);\r\n    const y = Math.floor((e.clientY - rect.top - offset.y) / zoom);\r\n    if (x < 0 || y < 0 || x >= canvas.width || y >= canvas.height) return null;\r\n\r\n    const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n    if (!ctx) return null;\r\n    const p = ctx.getImageData(x, y, 1, 1).data;\r\n    return `#${[p[0], p[1], p[2]].map((v) => v.toString(16).padStart(2, '0')).join('')}`;\r\n  };\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const handleMove = (e: MouseEvent) => {\r\n      if (tool === 'color') {\r\n        const color = samplePixel(e);\r\n        setHoverColor(color ? { x: e.clientX, y: e.clientY, color } : null);\r\n        drawOverlay();\r\n      }\r\n    };\r\n\r\n    const handleClick = (e: MouseEvent) => {\r\n      if (tool === 'color') {\r\n        const color = samplePixel(e);\r\n        if (color) {\r\n          setPickedColor(color);\r\n          navigator.clipboard.writeText(color).catch(() => {});\r\n          message.success(`Picked color ${color}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    const handleLeave = () => {\r\n      if (tool === 'color') setHoverColor(null);\r\n    };\r\n\r\n    canvas.addEventListener('mousemove', handleMove);\r\n    canvas.addEventListener('click', handleClick);\r\n    canvas.addEventListener('mouseleave', handleLeave);\r\n\r\n    return () => {\r\n      canvas.removeEventListener('mousemove', handleMove);\r\n      canvas.removeEventListener('click', handleClick);\r\n      canvas.removeEventListener('mouseleave', handleLeave);\r\n    };\r\n  }, [tool, zoom, offset]);\r\n\r\n  // Apply brightness/contrast to current canvas (mutates)\r\n  function applyBrightnessContrastToCanvas() {\r\n    if (!canvasRef.current) return;\r\n    const ctx = canvasRef.current.getContext('2d')!;\r\n    const imgData = ctx.getImageData(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n    const cloned = cloneImageData(imgData);\r\n    applyBrightnessContrast(cloned, brightness, contrast);\r\n    ctx.putImageData(cloned, 0, 0);\r\n    pushHistory(canvasRef.current.toDataURL(), 'Brightness/Contrast');\r\n  }\r\n\r\n  // Apply kernel (blur/sharpen)\r\n  async function applyKernel(kernel: number[], size = Math.sqrt(kernel.length)) {\r\n    if (!canvasRef.current) return;\r\n    const ctx = canvasRef.current.getContext('2d')!;\r\n    const id = ctx.getImageData(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n    applyConvolution(id, kernel, size);\r\n    ctx.putImageData(id, 0, 0);\r\n    pushHistory(canvasRef.current.toDataURL(), 'Convolution');\r\n  }\r\n\r\n  function applyThresholdBackground(threshold = 240) {\r\n    if (!canvasRef.current) return;\r\n    const ctx = canvasRef.current.getContext('2d')!;\r\n    const id = ctx.getImageData(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n    applyThresholdAlpha(id, threshold);\r\n    ctx.putImageData(id, 0, 0);\r\n    pushHistory(canvasRef.current.toDataURL(), 'Background removed (threshold)');\r\n  }\r\n\r\n  // Crop: apply cropRect to canvas\r\n  function applyCrop() {\r\n    if (!canvasRef.current || !cropRect) return;\r\n    const c = createCanvas(\r\n      Math.max(1, Math.round(cropRect.w)),\r\n      Math.max(1, Math.round(cropRect.h)),\r\n    );\r\n    const ctx = c.getContext('2d')!;\r\n    ctx.drawImage(\r\n      canvasRef.current,\r\n      cropRect.x,\r\n      cropRect.y,\r\n      cropRect.w,\r\n      cropRect.h,\r\n      0,\r\n      0,\r\n      cropRect.w,\r\n      cropRect.h,\r\n    );\r\n    // replace current canvas\r\n    canvasRef.current.width = c.width;\r\n    canvasRef.current.height = c.height;\r\n    overlayRef.current!.width = c.width;\r\n    overlayRef.current!.height = c.height;\r\n    const wctx = canvasRef.current.getContext('2d')!;\r\n    wctx.clearRect(0, 0, c.width, c.height);\r\n    wctx.drawImage(c, 0, 0);\r\n    setCropRect(null);\r\n    pushHistory(canvasRef.current.toDataURL(), 'Cropped');\r\n  }\r\n\r\n  function rotate(deg: number) {\r\n    if (!canvasRef.current) return;\r\n    // create temp canvas and rotate\r\n    const src = canvasRef.current;\r\n    const tmp = createCanvas(src.width, src.height);\r\n    const tctx = tmp.getContext('2d')!;\r\n    tctx.drawImage(src, 0, 0);\r\n    const dest = createCanvas(src.height, src.width);\r\n    const dctx = dest.getContext('2d')!;\r\n    dctx.translate(dest.width / 2, dest.height / 2);\r\n    dctx.rotate((deg * Math.PI) / 180);\r\n    dctx.drawImage(tmp, -tmp.width / 2, -tmp.height / 2);\r\n    // replace\r\n    canvasRef.current.width = dest.width;\r\n    canvasRef.current.height = dest.height;\r\n    overlayRef.current!.width = dest.width;\r\n    overlayRef.current!.height = dest.height;\r\n    const wctx = canvasRef.current.getContext('2d')!;\r\n    wctx.clearRect(0, 0, dest.width, dest.height);\r\n    wctx.drawImage(dest, 0, 0);\r\n    pushHistory(canvasRef.current.toDataURL(), `Rotate ${deg}`);\r\n  }\r\n\r\n  async function perspectiveApply() {\r\n    if (!canvasRef.current || !perspectivePoints.current) return;\r\n    const src = canvasRef.current;\r\n    // dest dims: bounding rect\r\n    const destW = src.width;\r\n    const destH = src.height;\r\n    const dest = perspectiveTransform(src, perspectivePoints.current, destW, destH);\r\n    canvasRef.current.width = dest.width;\r\n    canvasRef.current.height = dest.height;\r\n    overlayRef.current!.width = dest.width;\r\n    overlayRef.current!.height = dest.height;\r\n    canvasRef.current.getContext('2d')!.clearRect(0, 0, dest.width, dest.height);\r\n    canvasRef.current.getContext('2d')!.drawImage(dest, 0, 0);\r\n    pushHistory(canvasRef.current.toDataURL(), 'Perspective corrected');\r\n    setShowPerspectiveModal(false);\r\n  }\r\n\r\n  // flip\r\n  function flipH() {\r\n    if (!canvasRef.current) return;\r\n    const ctx = canvasRef.current.getContext('2d')!;\r\n    const tmp = createCanvas(canvasRef.current.width, canvasRef.current.height);\r\n    tmp.getContext('2d')!.drawImage(canvasRef.current, 0, 0);\r\n    ctx.save();\r\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n    ctx.scale(-1, 1);\r\n    ctx.drawImage(tmp, -canvasRef.current.width, 0);\r\n    ctx.restore();\r\n    pushHistory(canvasRef.current.toDataURL(), 'Flip horizontal');\r\n  }\r\n  function flipV() {\r\n    if (!canvasRef.current) return;\r\n    const ctx = canvasRef.current.getContext('2d')!;\r\n    const tmp = createCanvas(canvasRef.current.width, canvasRef.current.height);\r\n    tmp.getContext('2d')!.drawImage(canvasRef.current, 0, 0);\r\n    ctx.save();\r\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n    ctx.scale(1, -1);\r\n    ctx.drawImage(tmp, 0, -canvasRef.current.height);\r\n    ctx.restore();\r\n    pushHistory(canvasRef.current.toDataURL(), 'Flip vertical');\r\n  }\r\n\r\n  async function exportImage(asJpeg = false) {\r\n    if (!canvasRef.current) return;\r\n    const blob = await exportCanvasToBlob(\r\n      canvasRef.current,\r\n      asJpeg ? 'image/jpeg' : 'image/png',\r\n      0.92,\r\n    );\r\n    if (onExport) onExport(blob);\r\n    // auto download\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = asJpeg ? 'edited.jpg' : 'edited.png';\r\n    a.click();\r\n    URL.revokeObjectURL(url);\r\n    message.success('Exported image');\r\n  }\r\n\r\n  // keyboard shortcuts\r\n  useEffect(() => {\r\n    const handler = (e: KeyboardEvent) => {\r\n      if (e.ctrlKey && e.key === 'z') doUndo();\r\n      if (e.ctrlKey && e.key === 'y') doRedo();\r\n      if (e.key === 'c') setTool('crop');\r\n      if (e.key === 'v') setTool('pan');\r\n      if (e.key === 'r') rotate(90);\r\n    };\r\n    window.addEventListener('keydown', handler);\r\n    return () => window.removeEventListener('keydown', handler);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [historyIndex, history]);\r\n\r\n  // Quick hand tool when holding Space\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.code === 'Space') {\r\n        e.preventDefault(); // stop page scroll\r\n\r\n        setIsSpaceDown((prev) => {\r\n          if (!prev) {\r\n            // first press\r\n            setToolBeforeHand((t) => {\r\n              // store previous tool safely\r\n              if (t === null) return tool;\r\n              return t;\r\n            });\r\n            setTool('pan');\r\n          }\r\n          return true;\r\n        });\r\n      }\r\n    };\r\n\r\n    const handleKeyUp = (e: KeyboardEvent) => {\r\n      if (e.code === 'Space') {\r\n        setIsSpaceDown(false);\r\n\r\n        setToolBeforeHand((prev) => {\r\n          if (prev) {\r\n            setTool(prev); // restore tool\r\n          }\r\n          return null; // clear buffer\r\n        });\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown, { passive: false });\r\n    window.addEventListener('keyup', handleKeyUp);\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n      window.removeEventListener('keyup', handleKeyUp);\r\n    };\r\n  }, [tool]);\r\n\r\n  // copy to clipboard (image)\r\n  async function copyToClipboard() {\r\n    if (!canvasRef.current) return;\r\n    try {\r\n      const blob = await exportCanvasToBlob(canvasRef.current, 'image/png');\r\n      // @ts-ignore navigator.clipboard\r\n      await (navigator.clipboard as any).write([new ClipboardItem({ 'image/png': blob })]);\r\n      message.success('Image copied to clipboard');\r\n    } catch (err) {\r\n      console.warn('clipboard failed', err);\r\n      message.error('Copy failed (browser may not support)');\r\n    }\r\n  }\r\n\r\n  const getCursorForTool = (tool: Tool) => {\r\n    switch (tool) {\r\n      case 'pan':\r\n        return 'grab';\r\n      case 'crop':\r\n        return 'crosshair';\r\n      case 'ruler':\r\n        return 'crosshair';\r\n      case 'perspective':\r\n        return 'crosshair';\r\n      case 'select':\r\n        return 'default';\r\n      case 'color':\r\n        return 'copy'; // or 'crosshair' or 'cell'\r\n      default:\r\n        return 'default';\r\n    }\r\n  };\r\n\r\n  const containerCursor = (tool) => {\r\n    if ((tool === 'pan' || tool === 'select') && isPanning) return 'grabbing';\r\n    return getCursorForTool(tool);\r\n  };\r\n\r\n  return (\r\n    <div style={{ display: 'flex', gap: 12 }}>\r\n      <div style={{ width: 260 }}>\r\n        {/* Toolbar */}\r\n        <Space direction=\"vertical\" style={{ width: '100%' }}>\r\n          <Space wrap>\r\n            <Tooltip title=\"Undo (Ctrl+Z)\">\r\n              <Button icon={<UndoOutlined />} onClick={doUndo} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Redo (Ctrl+Y)\">\r\n              <Button icon={<RedoOutlined />} onClick={doRedo} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Rotate left\">\r\n              <Button icon={<RotateLeftOutlined />} onClick={() => rotate(-90)} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Rotate right\">\r\n              <Button icon={<RotateRightOutlined />} onClick={() => rotate(90)} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Flip horizontal\">\r\n              <Button icon={<SwapOutlined />} onClick={flipH} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Flip vertical\">\r\n              <Button icon={<SwapOutlined rotate={90} />} onClick={flipV} />\r\n            </Tooltip>\r\n          </Space>\r\n\r\n          <Divider />\r\n\r\n          <div>\r\n            <div style={{ marginBottom: 8 }}>Brightness</div>\r\n            <Slider\r\n              min={-150}\r\n              max={150}\r\n              value={brightness}\r\n              onChange={(v) => setBrightness(v)}\r\n              onAfterChange={() => applyBrightnessContrastToCanvas()}\r\n            />\r\n            <div style={{ marginBottom: 8 }}>Contrast</div>\r\n            <Slider\r\n              min={-100}\r\n              max={100}\r\n              value={contrast}\r\n              onChange={(v) => setContrast(v)}\r\n              onAfterChange={() => applyBrightnessContrastToCanvas()}\r\n            />\r\n          </div>\r\n\r\n          <Divider />\r\n\r\n          <div>\r\n            <div style={{ marginBottom: 8 }}>Filters</div>\r\n            <Space>\r\n              <Button onClick={() => applyKernel(Kernels.sharpen, 3)}>Sharpen</Button>\r\n              <Button onClick={() => applyKernel(Kernels.blur3, 3)}>Blur</Button>\r\n              <Button onClick={() => applyKernel(Kernels.gaussian5, 5)}>Gaussian</Button>\r\n            </Space>\r\n          </div>\r\n\r\n          <Divider />\r\n\r\n          <div>\r\n            <div style={{ marginBottom: 8 }}>Background</div>\r\n            <Space>\r\n              <Button onClick={() => applyThresholdBackground(235)} icon={<BgColorsOutlined />}>\r\n                Remove white\r\n              </Button>\r\n            </Space>\r\n          </div>\r\n\r\n          <Divider />\r\n          <Space>\r\n            <Button icon={<BgColorsOutlined />} onClick={() => setTool('color')}>\r\n              Color picker\r\n            </Button>\r\n            {pickedColor && (\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>\r\n                <div\r\n                  style={{\r\n                    width: 18,\r\n                    height: 18,\r\n                    borderRadius: 3,\r\n                    border: '1px solid #999',\r\n                    background: pickedColor,\r\n                  }}\r\n                />\r\n                <span>{pickedColor}</span>\r\n              </div>\r\n            )}\r\n          </Space>\r\n          <Divider />\r\n\r\n          <div>\r\n            <div style={{ marginBottom: 8 }}>Crop & Perspective</div>\r\n            <Space>\r\n              <Button icon={<ScissorOutlined />} onClick={() => setTool('crop')}>\r\n                Crop (C)\r\n              </Button>\r\n              <Button\r\n                onClick={() => {\r\n                  setShowPerspectiveModal(true);\r\n                  setTool('perspective');\r\n                }}\r\n              >\r\n                Perspective\r\n              </Button>\r\n            </Space>\r\n          </div>\r\n\r\n          <Divider />\r\n\r\n          <div>\r\n            <div style={{ marginBottom: 8 }}>Ruler / DPI</div>\r\n            <Space>\r\n              <Button icon={'üìè'} onClick={() => setTool('ruler')}>\r\n                Ruler\r\n              </Button>\r\n              <Button\r\n                onClick={() => {\r\n                  setDpiMeasured(null);\r\n                  message.info('Ruler cleared');\r\n                }}\r\n              >\r\n                Clear\r\n              </Button>\r\n            </Space>\r\n            {dpiMeasured && <div>Estimated DPI: {dpiMeasured}</div>}\r\n          </div>\r\n\r\n          <Divider />\r\n\r\n          <div>\r\n            <div style={{ marginBottom: 8 }}>Export</div>\r\n            <Space>\r\n              <Button icon={<ExportOutlined />} onClick={() => exportImage(false)}>\r\n                PNG\r\n              </Button>\r\n              <Button onClick={() => exportImage(true)}>JPG</Button>\r\n              <Button icon={<CopyOutlined />} onClick={copyToClipboard}>\r\n                Copy\r\n              </Button>\r\n            </Space>\r\n          </div>\r\n        </Space>\r\n      </div>\r\n\r\n      <div style={{ flex: 1 }}>\r\n        <div style={{ marginBottom: 8 }}>\r\n          <Space>\r\n            <Tooltip title=\"Zoom In\">\r\n              <Button\r\n                icon={<ZoomInOutlined />}\r\n                onClick={() => setZoom((z) => Math.min(z * 1.2, 8))}\r\n              />\r\n            </Tooltip>\r\n            <Tooltip title=\"Zoom Out\">\r\n              <Button\r\n                icon={<ZoomOutOutlined />}\r\n                onClick={() => setZoom((z) => Math.max(z / 1.2, 0.1))}\r\n              />\r\n            </Tooltip>\r\n            <Select value={tool} onChange={(v) => setTool(v as Tool)} style={{ width: 140 }}>\r\n              <Option value=\"pan\">Pan</Option>\r\n              <Option value=\"crop\">Crop</Option>\r\n              <Option value=\"ruler\">Ruler</Option>\r\n              <Option value=\"perspective\">Perspective</Option>\r\n            </Select>\r\n          </Space>\r\n        </div>\r\n\r\n        <div\r\n          ref={containerRef}\r\n          onMouseDown={handleMouseDownViewer}\r\n          onMouseMove={handleMouseMoveViewer}\r\n          onMouseUp={handleMouseUpViewer}\r\n          style={{\r\n            width: '100%',\r\n            height: '100vh',\r\n            overflow: 'hidden',\r\n            border: '1px solid #eee',\r\n            position: 'relative',\r\n            background: '#fafafa',\r\n            cursor: containerCursor(tool),\r\n          }}\r\n        >\r\n          <canvas\r\n            ref={(el) => {\r\n              canvasRef.current = el;\r\n            }}\r\n            style={{\r\n              transform: `translate(${offset.x}px, ${offset.y}px) scale(${zoom})`,\r\n              transformOrigin: 'top left',\r\n              display: 'block',\r\n            }}\r\n          />\r\n          <canvas\r\n            ref={(el) => {\r\n              overlayRef.current = el;\r\n            }}\r\n            style={{\r\n              position: 'absolute',\r\n              left: 0,\r\n              top: 0,\r\n              pointerEvents: 'none',\r\n              transform: `translate(${offset.x}px, ${offset.y}px) scale(${zoom})`,\r\n              transformOrigin: 'top left',\r\n            }}\r\n          />\r\n          {hoverColor && (\r\n            <div\r\n              style={{\r\n                position: 'fixed', // use fixed to position relative to viewport\r\n                left: hoverColor.x + 12,\r\n                top: hoverColor.y + 12,\r\n                background: '#fff',\r\n                padding: '4px 8px',\r\n                borderRadius: 4,\r\n                boxShadow: '0 0 6px rgba(0,0,0,0.2)',\r\n                fontSize: 12,\r\n                zIndex: 999999,\r\n                pointerEvents: 'none',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: 6,\r\n              }}\r\n            >\r\n              <span\r\n                style={{\r\n                  display: 'inline-block',\r\n                  width: 12,\r\n                  height: 12,\r\n                  background: hoverColor.color,\r\n                  border: '1px solid #ccc',\r\n                }}\r\n              />\r\n              {hoverColor.color}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <Modal\r\n        title=\"Perspective correction\"\r\n        open={showPerspectiveModal}\r\n        onOk={() => perspectiveApply()}\r\n        onCancel={() => setShowPerspectiveModal(false)}\r\n        okText=\"Apply\"\r\n      >\r\n        <p>Click four points on the image (clockwise) to define the corners, then Apply.</p>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageEditor;\r\n","import DragDropWrapper from '@/components/DragDropWrapper';\r\nimport DragOverlay from '@/components/DragOverlay';\r\nimport { handleCopy, handlePasteImage } from '@/helpers';\r\nimport {\r\n  CopyOutlined,\r\n  DownloadOutlined,\r\n  InfoCircleOutlined,\r\n  LoadingOutlined,\r\n  UploadOutlined,\r\n} from '@ant-design/icons';\r\nimport { PageContainer } from '@ant-design/pro-components';\r\nimport {\r\n  Button,\r\n  Card,\r\n  InputNumber,\r\n  Space,\r\n  Spin,\r\n  Tabs,\r\n  Tag,\r\n  Tooltip,\r\n  Typography,\r\n  Upload,\r\n  message,\r\n} from 'antd';\r\nimport ImageTracer from 'imagetracerjs';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport ImageEditor from './components/ImageEditor';\r\n\r\nconst { Title } = Typography;\r\nconst { TabPane } = Tabs;\r\n\r\nconst PNGJPEG: React.FC = () => {\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [preview, setPreview] = useState<string | null>(null);\r\n  const [svgContent, setSvgContent] = useState<string | null>(null);\r\n  const [dragging, setDragging] = useState(false);\r\n  const [processing, setProcessing] = useState(false);\r\n\r\n  const dragCounter = useRef(0);\r\n\r\n  // Tracing options\r\n  const [scale, setScale] = useState(1);\r\n  const [ltres, setLtres] = useState(1);\r\n  const [qtres, setQtres] = useState(1);\r\n  const [pathomit, setPathomit] = useState(8);\r\n  const [colorsampling, setColorsampling] = useState(2);\r\n  const [strokewidth, setStrokewidth] = useState(1);\r\n\r\n  // --- Clipboard paste support ---\r\n  useEffect(() => {\r\n    handlePasteImage(handleUpload);\r\n  }, []);\r\n\r\n  const handleUpload = (file: File) => {\r\n    setFile(file);\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => setPreview(e.target?.result as string);\r\n    reader.readAsDataURL(file);\r\n    setDragging(false);\r\n    dragCounter.current = 0;\r\n    return false;\r\n  };\r\n\r\n  const handleConvert = () => {\r\n    if (!preview) {\r\n      message.error('Please upload an image first.');\r\n      return;\r\n    }\r\n\r\n    setProcessing(true); // üëà start loading animation\r\n    try {\r\n      ImageTracer.imageToSVG(\r\n        preview,\r\n        (svgString) => {\r\n          setSvgContent(svgString);\r\n          setProcessing(false); // üëà stop loading\r\n          message.success('Image converted to SVG successfully!');\r\n        },\r\n        { scale, ltres, qtres, pathomit, colorsampling, strokewidth },\r\n      );\r\n    } catch (err: any) {\r\n      console.error(err);\r\n      setProcessing(false); // üëà stop loading on error\r\n      message.error('Error converting image to SVG.');\r\n    }\r\n  };\r\n\r\n  const handleDownload = (content: string, filename: string) => {\r\n    const blob = new Blob([content], { type: 'image/svg+xml' });\r\n    const link = document.createElement('a');\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = filename;\r\n    link.click();\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setFile(null);\r\n    setPreview(null);\r\n    setSvgContent(null);\r\n    message.info('Image and SVG cleared.');\r\n  };\r\n\r\n  // Generate Base64 and Data URI\r\n  const svgBase64 = svgContent ? btoa(unescape(encodeURIComponent(svgContent))) : '';\r\n  const svgDataURI = svgContent ? `data:image/svg+xml;base64,${svgBase64}` : '';\r\n\r\n  return (\r\n    <DragDropWrapper\r\n      setDragging={setDragging}\r\n      dragCounter={dragCounter}\r\n      handleUpload={handleUpload}\r\n    >\r\n      <Card\r\n        title={\r\n          <>\r\n            üñºÔ∏è PNG / JPEG Viewer <Tag color=\"cyan\">Beta</Tag>\r\n          </>\r\n        }\r\n        variant={'borderless'}\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: '100%' }} size=\"large\">\r\n          {!dragging && (\r\n            <Upload beforeUpload={handleUpload} showUploadList={false} accept=\".png,.jpg,.jpeg\">\r\n              <Button icon={<UploadOutlined />}>Upload Image (PNG/JPG)</Button>\r\n            </Upload>\r\n          )}\r\n\r\n          {dragging && <DragOverlay />}\r\n\r\n          {/* Preview */}\r\n          {preview && (\r\n            <div>\r\n              <Title level={5}>Preview & Editor:</Title>\r\n              <ImageEditor\r\n                imageUrl={preview}\r\n                onExport={(blob) => {\r\n                  // optional: show download link or handle upload\r\n                  console.log('exported blob', blob);\r\n                }}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* === PROCESSING OVERLAY === */}\r\n          {processing && (\r\n            <div\r\n              style={{\r\n                position: 'fixed',\r\n                top: 0,\r\n                left: 0,\r\n                width: '100%',\r\n                height: '100%',\r\n                background: 'rgba(255, 255, 255, 0.7)',\r\n                zIndex: 10000,\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n                flexDirection: 'column',\r\n              }}\r\n            >\r\n              <Spin\r\n                indicator={<LoadingOutlined style={{ fontSize: 48, color: '#1890ff' }} spin />}\r\n                tip=\"Converting image to SVG...\"\r\n                size=\"large\"\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* Tracing Options */}\r\n          <Card size=\"small\" title=\"Tracing Options (Adjust before converting)\">\r\n            <Space wrap size={'large'}>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Scale factor for the SVG output. Higher = larger SVG.\">\r\n                  <label>\r\n                    Scale <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber\r\n                  min={0.1}\r\n                  step={0.1}\r\n                  value={scale}\r\n                  onChange={(val) => setScale(val || 1)}\r\n                />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Error threshold for line detection. Lower = more precise lines.\">\r\n                  <label>\r\n                    ltres <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber min={0} value={ltres} onChange={(val) => setLtres(val || 1)} />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Error threshold for curve detection. Lower = more precise curves.\">\r\n                  <label>\r\n                    qtres <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber min={0} value={qtres} onChange={(val) => setQtres(val || 1)} />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Minimum path length to keep. Higher = simpler SVG with fewer tiny paths.\">\r\n                  <label>\r\n                    Pathomit <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber min={0} value={pathomit} onChange={(val) => setPathomit(val || 0)} />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Pixel sampling interval for colors. 1 = every pixel, higher = faster but less accurate colors.\">\r\n                  <label>\r\n                    ColorSampling <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber\r\n                  min={1}\r\n                  value={colorsampling}\r\n                  onChange={(val) => setColorsampling(val || 1)}\r\n                />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Stroke width in the output SVG.\">\r\n                  <label>\r\n                    StrokeWidth <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber\r\n                  min={0}\r\n                  value={strokewidth}\r\n                  onChange={(val) => setStrokewidth(val || 1)}\r\n                />\r\n              </Space>\r\n            </Space>\r\n          </Card>\r\n\r\n          {/* Action Buttons */}\r\n          <Space>\r\n            <Button type=\"primary\" onClick={handleConvert} disabled={!file}>\r\n              Convert to SVG\r\n            </Button>\r\n            <Button onClick={handleClear} danger disabled={!file && !svgContent}>\r\n              Clear Image\r\n            </Button>\r\n          </Space>\r\n\r\n          {/* Tabs for SVG formats */}\r\n          {svgContent && (\r\n            <Tabs defaultActiveKey=\"svg\" type=\"card\" style={{ marginTop: 16 }}>\r\n              <TabPane tab=\"SVG\" key=\"svg\">\r\n                <Space style={{ marginBottom: 8 }}>\r\n                  <Button\r\n                    onClick={() => handleDownload(svgContent, 'image.svg')}\r\n                    icon={<DownloadOutlined />}\r\n                  >\r\n                    Download\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleCopy(svgContent, 'SVG copied!')}\r\n                    icon={<CopyOutlined />}\r\n                  >\r\n                    Copy\r\n                  </Button>\r\n                </Space>\r\n                <div\r\n                  style={{\r\n                    border: '1px solid #eee',\r\n                    borderRadius: 6,\r\n                    padding: 12,\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  <div dangerouslySetInnerHTML={{ __html: svgContent }} />\r\n                </div>\r\n              </TabPane>\r\n\r\n              <TabPane tab=\"Base64\" key=\"base64\">\r\n                <Space style={{ marginBottom: 8 }}>\r\n                  <Button\r\n                    onClick={() => handleCopy(svgBase64, 'Base64 copied!')}\r\n                    icon={<CopyOutlined />}\r\n                  >\r\n                    Copy Base64\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleDownload(svgBase64, 'image-base64.txt')}\r\n                    icon={<DownloadOutlined />}\r\n                  >\r\n                    Download Base64\r\n                  </Button>\r\n                </Space>\r\n                <pre\r\n                  style={{\r\n                    background: '#f7f7f7',\r\n                    padding: 12,\r\n                    borderRadius: 6,\r\n                    whiteSpace: 'pre-wrap',\r\n                    wordBreak: 'break-word',\r\n                    maxHeight: 300,\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  {svgBase64}\r\n                </pre>\r\n              </TabPane>\r\n\r\n              <TabPane tab=\"Data URI\" key=\"datauri\">\r\n                <Space style={{ marginBottom: 8 }}>\r\n                  <Button\r\n                    onClick={() => handleCopy(svgDataURI, 'Data URI copied!')}\r\n                    icon={<CopyOutlined />}\r\n                  >\r\n                    Copy Data URI\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleDownload(svgDataURI, 'image-datauri.txt')}\r\n                    icon={<DownloadOutlined />}\r\n                  >\r\n                    Download Data URI\r\n                  </Button>\r\n                </Space>\r\n                <pre\r\n                  style={{\r\n                    background: '#f7f7f7',\r\n                    padding: 12,\r\n                    borderRadius: 6,\r\n                    whiteSpace: 'pre-wrap',\r\n                    wordBreak: 'break-word',\r\n                    maxHeight: 300,\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  {svgDataURI}\r\n                </pre>\r\n              </TabPane>\r\n            </Tabs>\r\n          )}\r\n        </Space>\r\n      </Card>\r\n    </DragDropWrapper>\r\n  );\r\n};\r\n\r\nexport default PNGJPEG;\r\n"],"names":[],"mappings":"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"}