!function(){var e={},t={},r={"14476fbc":0},n="undefined"!=typeof globalThis?globalThis:self,a=function(n,a,o){var l,u,i,s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var r={id:e,exports:{}};s[e]=r;var a={id:e,module:r,factory:n[e],require:c};return c.requireInterceptors.forEach(function(e){e(a);}),a.factory.call(a.module.exports,a.module,a.module.exports,a.require),r.exports;}c.requireInterceptors=[],c.e=function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]});},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t);},c.m=n,c.c=s,c.es=function(e,t){Object.keys(t).forEach(function(r){"default"===r||c.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t[r]});});},c.d=Object.defineProperty.bind(Object),c.dr=function(e,t){return function(){var r=t();return r&&("object"==typeof r||"function"==typeof r)&&"function"==typeof r.then?r.then(function(t){return e(t);}):e(r);};},c.chunkEnsures={},c.ensure=function(e){return Promise.all(Object.keys(c.chunkEnsures).reduce(function(t,r){return c.chunkEnsures[r](e,t),t;},[]));},c.jsonpInstalled={},l=c.jsonpInstalled,c.chunkEnsures.jsonp=function(t,r){var n=l[t];if(0!==n){if(n)r.push(n[2]);else{var a=new Promise(function(e,r){n=l[t]=[e,r];});r.push(n[2]=a);var o=c.publicPath+e[t],u=Error();return c.loadScript(o,function(e){if(0!==(n=l[t])&&(l[t]=void 0),n){var r=e&&e.type,a=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed. ("+r+" : "+a+")",u.name="ChunkLoadError",u.type=r,n[1](u);}},"chunk-"+t),a;}}},c.cssInstalled=r,c.findStylesheet=function(e){try{u||(u=new URL(c.publicPath.replace(/^(\/\/)/,"https:$1")).pathname);}catch(e){}return Array.from(document.querySelectorAll("link[href][rel=stylesheet]")).find(function(t){var r=t.getAttribute("href").split("?")[0];return r===e||r===c.publicPath+e||u&&r===u+e;});},c.createStylesheet=function(e,t,n,a,o){var l=document.createElement("link");return l.rel="stylesheet",l.type="text/css",l.href=t,l.onerror=l.onload=function(t){if(l.onerror=l.onload=null,"load"===t.type)r[e]=0,a();else{delete r[e];var n=t&&t.type,u=t&&t.target&&t.target.href,i=Error("Loading CSS chunk "+e+" failed.\n("+u+")");i.code="CSS_CHUNK_LOAD_FAILED",i.type=n,i.request=u,l.parentNode.removeChild(l),o(i);}},n?n.parentNode.insertBefore(l,n.nextSibling):document.head.appendChild(l),l;},c.chunkEnsures.css=function(e,n){if(r[e])n.push(r[e]);else if(0!==r[e]&&t[e])return r[e]=new Promise(function(r,n){var a=t[e],o=c.publicPath+a;c.findStylesheet(a)?r():c.createStylesheet(e,o,null,r,n);}),n.push(r[e]),n;},i={},c.loadScript=function(e,t,r){if(!self.document)return importScripts(e),t();if(i[e])return i[e].push(t);var n=document.querySelector('script[src="'+e+'"], script[data-mako="ultimate-tool-web:'+r+'"]');n||((n=document.createElement("script")).timeout=120,n.src=e),i[e]=[t];var a=function(t,r){clearTimeout(o);var a=i[e];if(delete i[e],n.parentNode&&n.parentNode.removeChild(n),a&&a.forEach(function(e){return e(r);}),t)return t(r);},o=setTimeout(a.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=a.bind(null,n.onerror),n.onload=a.bind(null,n.onload),document.head.appendChild(n);};var f=function(e){for(var t in e)n[t]=e[t];},h=function(e){var t=c.jsonpInstalled,r=e[0],n=e[1];r.some(function(e){return 0!==t[e];})&&f(n);for(var a=0;a<r.length;a++){var o=r[a];t[o]&&t[o][0](),t[o]=0;}},d=o["makoChunk_ultimate-tool-web"]=o["makoChunk_ultimate-tool-web"]||[];return d.forEach(h.bind(null)),d.push=(function(e,t){e(t),h(t);}).bind(null,d.push.bind(d)),c.publicPath="/ultimate-tool-web/",f({"777fffbe":function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e};}r.d(t,"__esModule",{value:!0}),r.e(t,{_interop_require_default:function(){return n;},_:function(){return n;}});},"852bbaa9":function(e,t,r){function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t;})(e);}function a(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var u=o?Object.getOwnPropertyDescriptor(e,l):null;u&&(u.get||u.set)?Object.defineProperty(a,l,u):a[l]=e[l];}return a.default=e,r&&r.set(e,a),a;}r.d(t,"__esModule",{value:!0}),r.e(t,{_interop_require_wildcard:function(){return a;},_:function(){return a;}});},d1751d7c:function(e,t,r){function n(e,t){return Object.keys(e).forEach(function(r){"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r];}});}),e;}r.d(t,"__esModule",{value:!0}),r.e(t,{_export_star:function(){return n;},_:function(){return n;}});}}),o.__mako_require_module__=c,o.__mako_chunk_load__=c.ensure,c(a),{requireModule:c,_jsonpCallback:h};}({"14476fbc":function(e,t,r){let n=(e,t=0,r=255)=>Math.max(t,Math.min(r,Math.round(e))),a=e=>Math.max(0,Math.min(1,e)),o=(e,t,r)=>{let n=Math.max(e/=255,t/=255,r/=255),a=Math.min(e,t,r),o=0,l=0,u=(n+a)/2;if(n!==a){let i=n-a;switch(l=u>.5?i/(2-n-a):i/(n+a),n){case e:o=((t-r)/i+(t<r?6:0))/6;break;case t:o=((r-e)/i+2)/6;break;case r:o=((e-t)/i+4)/6;}}return[o,l,u];},l=(e,t,r)=>{let n,a,o;if(0===t)n=a=o=r;else{let l=(e,t,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e,u=r<.5?r*(1+t):r+t-r*t,i=2*r-u;n=l(i,u,e+1/3),a=l(i,u,e),o=l(i,u,e-1/3);}return[Math.round(255*n),Math.round(255*a),Math.round(255*o)];},u=[{name:"red",range:[345,15]},{name:"orange",range:[15,45]},{name:"yellow",range:[45,75]},{name:"green",range:[75,165]},{name:"cyan",range:[165,195]},{name:"blue",range:[195,255]},{name:"purple",range:[255,285]},{name:"magenta",range:[285,345]}],i=e=>{let t=[...e].sort((e,t)=>e.x-t.x);t[0].x>0&&t.unshift({x:0,y:t[0].y}),t[t.length-1].x<255&&t.push({x:255,y:t[t.length-1].y});let r=t.map(e=>e.x),a=t.map(e=>e.y),o=r.length,l=[],u=[],i=[];for(let e=0;e<o-1;e++){let t=r[e+1]-r[e],n=a[e+1]-a[e];u.push(t),l.push(n),i.push(n/t);}let s=[i[0]];for(let e=0;e<o-2;e++){let t=i[e],r=i[e+1];if(t*r<=0)s.push(0);else{let n=u[e],a=u[e+1],o=n+a;s.push(3*o/((o+a)/t+(o+n)/r));}}s.push(i[i.length-1]);let c=Array(256).fill(0);for(let e=0;e<o-1;e++){let t=r[e],o=r[e+1],l=a[e],u=a[e+1],i=s[e],f=s[e+1],h=o-t;for(let e=t;e<=o&&!(e>=256);e++){let r=(e-t)/h,a=r*r,o=a*r,s=(2*o-3*a+1)*l+(o-2*a+r)*h*i+(-2*o+3*a)*u+(o-a)*h*f;c[Math.round(e)]=n(Math.round(s));}}return c;},s=(e,t)=>{let r=e.data,{hsl:s,curves:c,colorGrading:f}=t,h=i(c.master),d=i(c.red),p=i(c.green),m=i(c.blue),b=l(f.shadows.h/360,f.shadows.s,2*f.shadows.l),g=l(f.midtones.h/360,f.midtones.s,2*f.midtones.l),y=l(f.highlights.h/360,f.highlights.s,2*f.highlights.l);for(let e=0;e<r.length;e+=4){let t=r[e],i=r[e+1],c=r[e+2];t=d[t],i=p[i],c=m[c];let[_,M,k]=o(t=h[t],i=h[i],c=h[c]),v=(360*_+360)%360,w=u.find(({range:e})=>{let[t,r]=e;return t<=r?v>=t&&v<=r:v>=t||v<=r;});if(w){let e=s[w.name];if(e){let[r,n]=w.range,o=n;r>o&&(o+=360);let u=v;if(u<r&&(u+=360),0!==e.h){let t=u+e.h;t<r&&(t=r),t>o&&(t=o),_=(v=(t%360+360)%360)/360;}0!==e.s&&(M=a(M*(1+(1>=Math.abs(e.s)?100*e.s:e.s)/100))),0!==e.l&&(k=a(k*(1+(1>=Math.abs(e.l)?100*e.l:e.l)/100))),[t,i,c]=l(_,M,k);}else[t,i,c]=l(_,M,k);}let P=(.299*t+.587*i+.114*c)/255,j=f.blending/100;f.balance;let x=Math.max(0,1-2*P)*j,E=Math.max(0,(P-.5)*2)*j,O=(1-2*Math.abs(P-.5))*j;t=n(t+b[0]*x+g[0]*O+y[0]*E),i=n(i+b[1]*x+g[1]*O+y[1]*E),c=n(c+b[2]*x+g[2]*O+y[2]*E);let C=f.temperature/100,S=f.tint/100;t=n(t+30*C),c=n(c-30*C),i=n(i+20*S),r[e]=t,r[e+1]=i,r[e+2]=c;}return e;},c=(e,t)=>{let{data:r,width:n,height:a}=e,o=new Uint8ClampedArray(r.length),l=2*Math.max(1,Math.floor(t))+1,u=t/3,i=[],s=0;for(let e=0;e<l;e++){let t=e-Math.floor(l/2),r=Math.exp(-(t*t)/(2*u*u));i.push(r),s+=r;}for(let e=0;e<i.length;e++)i[e]/=s;let c=Math.floor(l/2),f=new Uint8ClampedArray(r.length);for(let e=0;e<a;e++)for(let t=0;t<n;t++){let a=0,o=0,l=0,u=0;for(let s=-c;s<=c;s++){let f=Math.min(Math.max(t+s,0),n-1),h=(e*n+f)*4,d=i[s+c];a+=r[h]*d,o+=r[h+1]*d,l+=r[h+2]*d,u+=r[h+3]*d;}let s=(e*n+t)*4;f[s]=a,f[s+1]=o,f[s+2]=l,f[s+3]=u;}for(let e=0;e<a;e++)for(let t=0;t<n;t++){let r=0,l=0,u=0,s=0;for(let o=-c;o<=c;o++){let h=(Math.min(Math.max(e+o,0),a-1)*n+t)*4,d=i[o+c];r+=f[h]*d,l+=f[h+1]*d,u+=f[h+2]*d,s+=f[h+3]*d;}let h=(e*n+t)*4;o[h]=r,o[h+1]=l,o[h+2]=u,o[h+3]=s;}return new ImageData(o,n,a);},f=(e,t,r,n)=>{let a=c(e,r),{data:o,width:l,height:u}=e,{data:i}=a,{data:s}=t,f=t;n>1&&(f=c(t,n));let{data:h}=f,d=new Uint8ClampedArray(o.length);for(let e=0;e<o.length;e+=4){let t=h[e]/255;d[e]=o[e]*(1-t)+i[e]*t,d[e+1]=o[e+1]*(1-t)+i[e+1]*t,d[e+2]=o[e+2]*(1-t)+i[e+2]*t,d[e+3]=o[e+3];}return new ImageData(d,l,u);};self.onmessage=e=>{let{type:t,id:r,payload:n}=e.data;try{let e;switch(t){case"APPLY_BLUR":{let{imageData:t,maskData:r,blurAmount:a,feather:o}=n;e=f(t,r,a,o);break;}case"APPLY_CAMERA_RAW":{let{imageData:t,settings:r}=n;e=s(t,r);break;}case"APPLY_CURVES":{let{imageData:t,curves:r}=n,a=i(r.master),o=i(r.red),l=i(r.green),u=i(r.blue),s=t.data;for(let e=0;e<s.length;e+=4)s[e]=a[o[s[e]]],s[e+1]=a[l[s[e+1]]],s[e+2]=a[u[s[e+2]]];e=t;break;}case"PROCESS_IMAGE":e=n.imageData;break;default:throw Error(`Unknown message type: ${t}`);}let a={type:t,id:r,success:!0,data:e};self.postMessage(a,[e.data.buffer]);}catch(n){let e={type:t,id:r,success:!1,error:n instanceof Error?n.message:"Unknown error"};self.postMessage(e);}};}},"14476fbc",n);n.jsonpCallback=a._jsonpCallback;}();
//# sourceMappingURL=14476fbc-worker.6656b2d8.js.map