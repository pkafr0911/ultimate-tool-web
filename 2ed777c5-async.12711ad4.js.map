{"version":3,"sources":["node_modules/@ant-design/icons-svg/es/asn/InfoCircleOutlined.js","node_modules/@ant-design/icons/es/icons/InfoCircleOutlined.js","node_modules/@ant-design/icons/es/icons/LoadingOutlined.js","src/pages/PNGJPEG/utils/ImageEditorEngine.tsx","src/pages/PNGJPEG/utils/helpers.tsx","src/pages/PNGJPEG/components/ImageEditor/ImageCanvas.tsx","node_modules/@ant-design/icons/es/icons/RotateLeftOutlined.js","node_modules/@ant-design/icons-svg/es/asn/ScissorOutlined.js","node_modules/@ant-design/icons/es/icons/ScissorOutlined.js","node_modules/@ant-design/icons-svg/es/asn/ExportOutlined.js","node_modules/@ant-design/icons/es/icons/ExportOutlined.js","src/pages/PNGJPEG/components/ImageEditor/HslSlider.tsx","src/pages/PNGJPEG/components/ImageEditor/ImageEditorToolbar.tsx","src/pages/PNGJPEG/components/ImageEditor/index.tsx","src/pages/PNGJPEG/hooks/useCanvas.tsx","src/pages/PNGJPEG/hooks/useHistory.tsx","src/pages/PNGJPEG/index.tsx"],"sourcesContent":["// This icon file is generated automatically.\nvar InfoCircleOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z\" } }] }, \"name\": \"info-circle\", \"theme\": \"outlined\" };\nexport default InfoCircleOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport InfoCircleOutlinedSvg from \"@ant-design/icons-svg/es/asn/InfoCircleOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar InfoCircleOutlined = function InfoCircleOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: InfoCircleOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(InfoCircleOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'InfoCircleOutlined';\n}\nexport default RefIcon;","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport LoadingOutlinedSvg from \"@ant-design/icons-svg/es/asn/LoadingOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar LoadingOutlined = function LoadingOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: LoadingOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(LoadingOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'LoadingOutlined';\n}\nexport default RefIcon;","export type ImageDataLike = ImageData;\r\n\r\nexport function createCanvas(w: number, h: number) {\r\n  const c = document.createElement('canvas');\r\n  c.width = w;\r\n  c.height = h;\r\n  return c;\r\n}\r\n\r\nexport function drawImageToCanvasFromUrl(url: string): Promise<HTMLCanvasElement> {\r\n  return new Promise((res, rej) => {\r\n    const img = new Image();\r\n    img.crossOrigin = 'anonymous';\r\n    img.onload = () => {\r\n      const c = createCanvas(img.naturalWidth, img.naturalHeight);\r\n      const ctx = c.getContext('2d')!;\r\n      ctx.drawImage(img, 0, 0);\r\n      res(c);\r\n    };\r\n    img.onerror = rej;\r\n    img.src = url;\r\n  });\r\n}\r\n\r\nexport function cloneImageData(src: ImageDataLike): ImageData {\r\n  const out = new ImageData(src.width, src.height);\r\n  out.data.set(new Uint8ClampedArray(src.data));\r\n  return out;\r\n}\r\n\r\nexport function applyBrightnessContrast(data: ImageData, brightness = 0, contrast = 0) {\r\n  // brightness in [-255,255], contrast in [-100,100]\r\n  const d = data.data;\r\n  const c = contrast / 100 + 1;\r\n  const intercept = 128 * (1 - c);\r\n  for (let i = 0; i < d.length; i += 4) {\r\n    d[i] = Math.min(255, Math.max(0, d[i] * c + intercept + brightness));\r\n    d[i + 1] = Math.min(255, Math.max(0, d[i + 1] * c + intercept + brightness));\r\n    d[i + 2] = Math.min(255, Math.max(0, d[i + 2] * c + intercept + brightness));\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function applyConvolution(data: ImageData, kernel: number[], kernelSize: number) {\r\n  const w = data.width;\r\n  const h = data.height;\r\n  const src = data.data;\r\n  const out = new Uint8ClampedArray(src.length);\r\n  const half = Math.floor(kernelSize / 2);\r\n\r\n  for (let y = 0; y < h; y++) {\r\n    for (let x = 0; x < w; x++) {\r\n      let r = 0,\r\n        g = 0,\r\n        b = 0,\r\n        a = 0;\r\n      for (let ky = 0; ky < kernelSize; ky++) {\r\n        for (let kx = 0; kx < kernelSize; kx++) {\r\n          const px = x + kx - half;\r\n          const py = y + ky - half;\r\n          if (px < 0 || px >= w || py < 0 || py >= h) continue;\r\n          const idx = (py * w + px) * 4;\r\n          const kval = kernel[ky * kernelSize + kx];\r\n          r += src[idx] * kval;\r\n          g += src[idx + 1] * kval;\r\n          b += src[idx + 2] * kval;\r\n          a += src[idx + 3] * kval;\r\n        }\r\n      }\r\n      const idx = (y * w + x) * 4;\r\n      out[idx] = Math.min(255, Math.max(0, r));\r\n      out[idx + 1] = Math.min(255, Math.max(0, g));\r\n      out[idx + 2] = Math.min(255, Math.max(0, b));\r\n      out[idx + 3] = Math.min(255, Math.max(0, a || src[idx + 3]));\r\n    }\r\n  }\r\n\r\n  data.data.set(out);\r\n  return data;\r\n}\r\n\r\nexport const Kernels = {\r\n  sharpen: [0, -1, 0, -1, 5, -1, 0, -1, 0],\r\n  blur3: [1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9],\r\n  gaussian5: [\r\n    1 / 273,\r\n    4 / 273,\r\n    7 / 273,\r\n    4 / 273,\r\n    1 / 273,\r\n    4 / 273,\r\n    16 / 273,\r\n    26 / 273,\r\n    16 / 273,\r\n    4 / 273,\r\n    7 / 273,\r\n    26 / 273,\r\n    41 / 273,\r\n    26 / 273,\r\n    7 / 273,\r\n    4 / 273,\r\n    16 / 273,\r\n    26 / 273,\r\n    16 / 273,\r\n    4 / 273,\r\n    1 / 273,\r\n    4 / 273,\r\n    7 / 273,\r\n    4 / 273,\r\n    1 / 273,\r\n  ],\r\n  // -------- New dynamic blur kernel generators --------\r\n  generateBoxBlurKernel(size: number) {\r\n    const s = size | 0;\r\n    const count = s * s;\r\n    return Array(count).fill(1 / count);\r\n  },\r\n\r\n  generateGaussianKernel(radius: number) {\r\n    const r = radius | 0;\r\n    const size = r * 2 + 1;\r\n    const sigma = r / 2;\r\n    const twoSigmaSq = 2 * sigma * sigma;\r\n\r\n    let kernel: number[] = [];\r\n    let sum = 0;\r\n\r\n    for (let y = -r; y <= r; y++) {\r\n      for (let x = -r; x <= r; x++) {\r\n        const v = Math.exp(-(x * x + y * y) / twoSigmaSq);\r\n        kernel.push(v);\r\n        sum += v;\r\n      }\r\n    }\r\n\r\n    // normalize Gaussian kernel\r\n    return kernel.map((v) => v / sum);\r\n  },\r\n};\r\n\r\nexport function applyThresholdAlpha(data: ImageData, threshold = 255) {\r\n  // If pixel is near-white (all channels > threshold), set alpha = 0\r\n  const d = data.data;\r\n  for (let i = 0; i < d.length; i += 4) {\r\n    if (d[i] > threshold && d[i + 1] > threshold && d[i + 2] > threshold) {\r\n      d[i + 3] = 0;\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function applyThresholdAlphaBlack(data: ImageData, threshold = 0) {\r\n  // If pixel is near-black (all RGB channels < threshold), set alpha = 0\r\n  const d = data.data;\r\n  for (let i = 0; i < d.length; i += 4) {\r\n    if (d[i] < threshold && d[i + 1] < threshold && d[i + 2] < threshold) {\r\n      d[i + 3] = 0;\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function flipHorizontal(canvas: HTMLCanvasElement) {\r\n  const ctx = canvas.getContext('2d')!;\r\n  ctx.save();\r\n  ctx.translate(canvas.width, 0);\r\n  ctx.scale(-1, 1);\r\n  const img = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n  ctx.putImageData(img, 0, 0);\r\n  ctx.restore();\r\n}\r\n\r\nexport function flipVertical(canvas: HTMLCanvasElement) {\r\n  const ctx = canvas.getContext('2d')!;\r\n  ctx.save();\r\n  ctx.translate(0, canvas.height);\r\n  ctx.scale(1, -1);\r\n  const img = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n  ctx.putImageData(img, 0, 0);\r\n  ctx.restore();\r\n}\r\n\r\nexport function rotateCanvas(canvas: HTMLCanvasElement, degrees: number) {\r\n  const radians = (degrees * Math.PI) / 180;\r\n  const w = canvas.width;\r\n  const h = canvas.height;\r\n  const c2 = createCanvas(h, w); // Swap dims if 90/270\r\n  const ctx2 = c2.getContext('2d')!;\r\n  ctx2.translate(c2.width / 2, c2.height / 2);\r\n  ctx2.rotate(radians);\r\n  ctx2.drawImage(canvas, -w / 2, -h / 2);\r\n  // resize original\r\n  canvas.width = c2.width;\r\n  canvas.height = c2.height;\r\n  const ctx = canvas.getContext('2d')!;\r\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n  ctx.drawImage(c2, 0, 0);\r\n}\r\n\r\nexport function exportCanvasToBlob(\r\n  canvas: HTMLCanvasElement,\r\n  type = 'image/png',\r\n  quality = 0.92,\r\n): Promise<Blob> {\r\n  return new Promise((res) => canvas.toBlob((b) => res(b as Blob), type, quality));\r\n}\r\n\r\n/**\r\n * Simple homography for perspective correction using ctx.setTransform is not enough.\r\n * We'll implement a basic 4-point to 4-point transform by drawing using an offscreen canvas with\r\n * path clipping and mapping via getImageData sampling. For moderate sizes, this works.\r\n * Note: For high-quality projective transforms consider using WebGL or external libs.\r\n */\r\nexport function perspectiveTransform(\r\n  srcCanvas: HTMLCanvasElement,\r\n  srcQuad: [number, number, number, number, number, number, number, number],\r\n  destW: number,\r\n  destH: number,\r\n): HTMLCanvasElement {\r\n  // srcQuad: [x0,y0, x1,y1, x2,y2, x3,y3] (clockwise)\r\n  // create dest canvas\r\n  const dest = createCanvas(destW, destH);\r\n  const dctx = dest.getContext('2d')!;\r\n  // We'll use a very simple approach: use temporary canvas and ctx.setTransform for affine approx\r\n  // That is, we split quad into two triangles and map each triangle using affine transform\r\n  const sctx = srcCanvas.getContext('2d')!;\r\n  const sData = sctx.getImageData(0, 0, srcCanvas.width, srcCanvas.height);\r\n\r\n  function mapTriangle(sTri: number[], dTri: number[]) {\r\n    // sTri and dTri are arrays of 3 points [x0,y0,x1,y1,x2,y2]\r\n    // compute affine transform matrix from d -> s, then draw via setTransform + clipping\r\n    const [sx0, sy0, sx1, sy1, sx2, sy2] = sTri;\r\n    const [dx0, dy0, dx1, dy1, dx2, dy2] = dTri;\r\n\r\n    // compute matrix A so that [sx] = A * [dx,dy,1]\r\n    // Solve linear equations for a,b,c,d,e,f\r\n    const denom = dx0 * (dy1 - dy2) + dx1 * (dy2 - dy0) + dx2 * (dy0 - dy1);\r\n    if (Math.abs(denom) < 1e-6) return;\r\n\r\n    // Use Canvas API trick:\r\n    // create path for dTri on dest canvas, clip, set transform to map dTri bbox -> sTri and draw sCanvas\r\n    dctx.save();\r\n    dctx.beginPath();\r\n    dctx.moveTo(dx0, dy0);\r\n    dctx.lineTo(dx1, dy1);\r\n    dctx.lineTo(dx2, dy2);\r\n    dctx.closePath();\r\n    dctx.clip();\r\n\r\n    // compute affine matrix that maps dest tri -> src tri\r\n    // Build matrices and solve. Simpler: use ctx.transform to map bounding boxes; this is approximate.\r\n    // For simplicity and decent quality, draw full src into dest and let clip mask show triangle - this tends to be fine for small edits\r\n    dctx.drawImage(srcCanvas, 0, 0, destW, destH);\r\n    dctx.restore();\r\n  }\r\n\r\n  // split into two triangles:\r\n  const [x0, y0, x1, y1, x2, y2, x3, y3] = srcQuad;\r\n  // dest triangles are basically rectangle triangles\r\n  mapTriangle([x0, y0, x1, y1, x2, y2], [0, 0, destW, 0, 0, destH]);\r\n  mapTriangle([x2, y2, x3, y3, x0, y0], [destW, destH, 0, destH, destW, 0]);\r\n  return dest;\r\n}\r\n\r\nconst clamp = (value: number, min = 0, max = 255) => {\r\n  return Math.min(max, Math.max(min, value));\r\n};\r\n\r\n// For 0..1 ranges\r\nconst clamp01 = (value: number) => {\r\n  return Math.min(1, Math.max(0, value));\r\n};\r\n\r\nconst rgbToHsl = (r: number, g: number, b: number): [number, number, number] => {\r\n  r /= 255;\r\n  g /= 255;\r\n  b /= 255;\r\n\r\n  const max = Math.max(r, g, b);\r\n  const min = Math.min(r, g, b);\r\n  let h = 0,\r\n    s = 0,\r\n    l = (max + min) / 2;\r\n\r\n  if (max !== min) {\r\n    const d = max - min;\r\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n\r\n    switch (max) {\r\n      case r:\r\n        h = (g - b) / d + (g < b ? 6 : 0);\r\n        break;\r\n      case g:\r\n        h = (b - r) / d + 2;\r\n        break;\r\n      case b:\r\n        h = (r - g) / d + 4;\r\n        break;\r\n    }\r\n    h /= 6;\r\n  }\r\n\r\n  return [h, s, l];\r\n};\r\n\r\nconst hslToRgb = (h: number, s: number, l: number): [number, number, number] => {\r\n  let r: number, g: number, b: number;\r\n\r\n  if (s === 0) {\r\n    r = g = b = l; // achromatic\r\n  } else {\r\n    const hue2rgb = (p: number, q: number, t: number) => {\r\n      if (t < 0) t += 1;\r\n      if (t > 1) t -= 1;\r\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\r\n      if (t < 1 / 2) return q;\r\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\r\n      return p;\r\n    };\r\n\r\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n    const p = 2 * l - q;\r\n\r\n    r = hue2rgb(p, q, h + 1 / 3);\r\n    g = hue2rgb(p, q, h);\r\n    b = hue2rgb(p, q, h - 1 / 3);\r\n  }\r\n\r\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\r\n};\r\n\r\nexport const applyToneAdjustments = (\r\n  data: ImageData,\r\n  {\r\n    highlights = 0,\r\n    shadows = 0,\r\n    whites = 0,\r\n    blacks = 0,\r\n    vibrance = 0,\r\n    saturation = 0,\r\n    clarity = 0, // local contrast\r\n    dehaze = 0, // remove fog\r\n  }: {\r\n    highlights?: number;\r\n    shadows?: number;\r\n    whites?: number;\r\n    blacks?: number;\r\n    vibrance?: number;\r\n    saturation?: number;\r\n    clarity?: number;\r\n    dehaze?: number;\r\n  },\r\n) => {\r\n  const d = data.data;\r\n\r\n  // If clarity is applied, create a shallow copy for local contrast reference\r\n  const originalData = clarity !== 0 ? new Uint8ClampedArray(d) : null;\r\n\r\n  for (let i = 0; i < d.length; i += 4) {\r\n    let r = d[i];\r\n    let g = d[i + 1];\r\n    let b = d[i + 2];\r\n\r\n    /** ------------------------ 1Ô∏è‚É£ HIGHLIGHTS / SHADOWS ------------------------ **/\r\n    const luma = 0.299 * r + 0.587 * g + 0.114 * b;\r\n    if (luma > 192 && highlights !== 0) {\r\n      const hFactor = (luma - 192) / (255 - 192);\r\n      r = clamp(r + highlights * hFactor);\r\n      g = clamp(g + highlights * hFactor);\r\n      b = clamp(b + highlights * hFactor);\r\n    }\r\n    if (luma < 64 && shadows !== 0) {\r\n      const sFactor = 1 - luma / 64;\r\n      r = clamp(r + shadows * sFactor);\r\n      g = clamp(g + shadows * sFactor);\r\n      b = clamp(b + shadows * sFactor);\r\n    }\r\n\r\n    /** ------------------------ 2Ô∏è‚É£ WHITES / BLACKS ------------------------ **/\r\n    r = clamp(r + whites - blacks);\r\n    g = clamp(g + whites - blacks);\r\n    b = clamp(b + whites - blacks);\r\n\r\n    /** ------------------------ 3Ô∏è‚É£ DEHAZE ------------------------ **/\r\n    if (dehaze !== 0) {\r\n      const factor = 1 + dehaze / 100;\r\n      r = clamp(r * factor);\r\n      g = clamp(g * (1 - dehaze / 200)); // reduce green & blue to reduce 'fog'\r\n      b = clamp(b * (1 - dehaze / 200));\r\n    }\r\n\r\n    /** ------------------------ 4Ô∏è‚É£ VIBRANCE / SATURATION (HSL) ------------------------ **/\r\n    if (vibrance !== 0 || saturation !== 0) {\r\n      const tmp = [r, g, b];\r\n      applyVibranceSaturation(tmp as any, 0, { vibrance, saturation });\r\n      [r, g, b] = tmp;\r\n    }\r\n\r\n    /** ------------------------ 5Ô∏è‚É£ CLARITY (Local contrast) ------------------------ **/\r\n    if (clarity !== 0 && originalData) {\r\n      // baseline luma before enhancements\r\n      const baseLuma =\r\n        0.299 * originalData[i] + 0.587 * originalData[i + 1] + 0.114 * originalData[i + 2];\r\n\r\n      // Clarity: enhance mid-range contrast only\r\n      const contrastFactor = clarity / 100;\r\n      const lumaDiff = (luma - baseLuma) * contrastFactor;\r\n\r\n      r = clamp(r + lumaDiff);\r\n      g = clamp(g + lumaDiff);\r\n      b = clamp(b + lumaDiff);\r\n    }\r\n\r\n    /** ------------------------ WRITE BACK ------------------------ **/\r\n    d[i] = r;\r\n    d[i + 1] = g;\r\n    d[i + 2] = b;\r\n    // alpha unchanged\r\n  }\r\n\r\n  return data;\r\n};\r\n\r\nexport const applyDehaze = (p: Uint8ClampedArray | number[], i: number, dehaze: number) => {\r\n  // More natural algorithm: adjust luminance & slight desaturation\r\n  let [h, s, l] = rgbToHsl(p[i], p[i + 1], p[i + 2]);\r\n\r\n  // Example: +20 dehaze ‚Üí l *= 1.2\r\n  l = clamp01(l * (1 + dehaze / 100));\r\n\r\n  // Slight saturation reduction to avoid color shift\r\n  s = clamp01(s * (1 - Math.abs(dehaze) / 300));\r\n\r\n  const [r, g, b] = hslToRgb(h, s, l);\r\n  p[i] = r;\r\n  p[i + 1] = g;\r\n  p[i + 2] = b;\r\n};\r\n\r\nexport const applyVibranceSaturation = (\r\n  p: Uint8ClampedArray | number[],\r\n  i: number,\r\n  { vibrance = 0, saturation = 0 }: { vibrance?: number; saturation?: number },\r\n) => {\r\n  let [h, s, l] = rgbToHsl(p[i], p[i + 1], p[i + 2]);\r\n\r\n  // --- 1Ô∏è‚É£ Saturation (multiplicative, more natural) ---\r\n  // Example: saturation = 20 ‚Üí s *= 1.2 ; saturation = -10 ‚Üí s *= 0.9\r\n  if (saturation !== 0) {\r\n    s = clamp01(s * (1 + saturation / 100));\r\n  }\r\n\r\n  // --- 2Ô∏è‚É£ Vibrance (only boosts low-saturated areas) ---\r\n  if (vibrance !== 0) {\r\n    const factor = vibrance / 100;\r\n    s = clamp01(s + (1 - s) * factor * (1 - s)); // nonlinear ‚Üí strong effect only if s < 0.5\r\n  }\r\n\r\n  const [r, g, b] = hslToRgb(h, s, l);\r\n  p[i] = r;\r\n  p[i + 1] = g;\r\n  p[i + 2] = b;\r\n};\r\n\r\nexport const colorRanges = [\r\n  { name: 'red', range: [345, 15] },\r\n  { name: 'orange', range: [15, 45] },\r\n  { name: 'yellow', range: [45, 75] },\r\n  { name: 'green', range: [75, 165] },\r\n  { name: 'aqua', range: [165, 195] },\r\n  { name: 'blue', range: [195, 255] },\r\n  { name: 'purple', range: [255, 285] },\r\n  { name: 'magenta', range: [285, 345] },\r\n];\r\n\r\nexport const applyHslAdjustments = (\r\n  data: ImageData,\r\n  adjustments: Record<string, { h?: number; s?: number; l?: number }>, // h: degrees, s/l: percent or fractional\r\n) => {\r\n  const d = data.data;\r\n\r\n  for (let i = 0; i < d.length; i += 4) {\r\n    // Loop through each pixel (step 4: R,G,B,A)\r\n    let [r, g, b] = [d[i], d[i + 1], d[i + 2]]; // Extract RGB\r\n    let [h, s, l] = rgbToHsl(r, g, b); // Convert to HSL (h: 0‚Äì1)\r\n    let deg = (h * 360 + 360) % 360; // Convert hue to 0‚Äì360¬∞ safely\r\n\r\n    // find color range (handles wrap ranges like [345,15])\r\n    const entry = colorRanges.find(({ range }) => {\r\n      const [start, end] = range;\r\n      if (start <= end) {\r\n        return deg >= start && deg <= end;\r\n      } else {\r\n        // wrapped range (e.g. 345 -> 15)\r\n        return deg >= start || deg <= end;\r\n      }\r\n    });\r\n\r\n    if (!entry) {\r\n      // no matching range ‚Äî write back unchanged\r\n      [d[i], d[i + 1], d[i + 2]] = hslToRgb(h, s, l);\r\n      continue;\r\n    }\r\n\r\n    const adj = adjustments[entry.name];\r\n    if (!adj) {\r\n      [d[i], d[i + 1], d[i + 2]] = hslToRgb(h, s, l);\r\n      continue;\r\n    }\r\n\r\n    const [startRaw, endRaw] = entry.range;\r\n    // Normalize start/end so start <= end (for clamping). If wrapped, push end +360.\r\n    let start = startRaw;\r\n    let end = endRaw;\r\n    if (start > end) end += 360; // e.g., 345..15 => 345..375\r\n\r\n    // Normalize deg into the same space as start..end\r\n    let degNorm = deg;\r\n    if (degNorm < start) degNorm += 360;\r\n\r\n    // ----- HUE: apply degree shift but clamp within the color's range -----\r\n    if (typeof adj.h === 'number' && adj.h !== 0) {\r\n      let newDeg = degNorm + adj.h; // tentative\r\n      // clamp to the range boundaries so it cannot jump outside the color band\r\n      if (newDeg < start) newDeg = start;\r\n      if (newDeg > end) newDeg = end;\r\n      // bring back to 0..360\r\n      deg = ((newDeg % 360) + 360) % 360; // Normalize back to 0‚Äì360¬∞\r\n      h = deg / 360; // Convert back to 0‚Äì1 for HSL\r\n    }\r\n\r\n    // ----- SATURATION: flexible input handling -----\r\n    if (typeof adj.s === 'number' && adj.s !== 0) {\r\n      // interpret 0.2 as +20% for backward compatibility\r\n      const satPercent = Math.abs(adj.s) <= 1 ? adj.s * 100 : adj.s; // Allow 0.2 or 20 ‚Üí both = +20%\r\n      s = clamp01(s * (1 + satPercent / 100)); // Apply proportionally\r\n    }\r\n\r\n    // ----- LUMINANCE: same handling as saturation -----\r\n    if (typeof adj.l === 'number' && adj.l !== 0) {\r\n      const lumPercent = Math.abs(adj.l) <= 1 ? adj.l * 100 : adj.l; // e.g. 0.1 ‚Üí +10%\r\n      l = clamp01(l * (1 + lumPercent / 100)); // Apply multiplicatively\r\n    }\r\n\r\n    // Write final adjusted color back to RGBA buffer\r\n    [d[i], d[i + 1], d[i + 2]] = hslToRgb(h, s, l);\r\n  }\r\n\r\n  return data;\r\n};\r\n","import { message } from 'antd';\r\nimport {\r\n  applyBrightnessContrast,\r\n  applyConvolution,\r\n  applyDehaze,\r\n  applyHslAdjustments,\r\n  applyThresholdAlpha,\r\n  applyThresholdAlphaBlack,\r\n  applyToneAdjustments,\r\n  applyVibranceSaturation,\r\n  cloneImageData,\r\n  createCanvas,\r\n  exportCanvasToBlob,\r\n  Kernels,\r\n} from './ImageEditorEngine';\r\n\r\n// rotate\r\nexport const rotate = (deg: number, canvasRef, overlayRef, history) => {\r\n  if (!canvasRef.current) return;\r\n  // create temp canvas and rotate\r\n  const src = canvasRef.current;\r\n  const tmp = createCanvas(src.width, src.height);\r\n  const tctx = tmp.getContext('2d')!;\r\n  tctx.drawImage(src, 0, 0);\r\n  const dest = createCanvas(src.height, src.width);\r\n  const dctx = dest.getContext('2d')!;\r\n  dctx.translate(dest.width / 2, dest.height / 2);\r\n  dctx.rotate((deg * Math.PI) / 180);\r\n  dctx.drawImage(tmp, -tmp.width / 2, -tmp.height / 2);\r\n  // replace\r\n  canvasRef.current.width = dest.width;\r\n  canvasRef.current.height = dest.height;\r\n  overlayRef.current!.width = dest.width;\r\n  overlayRef.current!.height = dest.height;\r\n  const wctx = canvasRef.current.getContext('2d')!;\r\n  wctx.clearRect(0, 0, dest.width, dest.height);\r\n  wctx.drawImage(dest, 0, 0);\r\n  history.push(canvasRef.current.toDataURL(), `Rotate ${deg}`);\r\n};\r\n\r\n// exportImage\r\nexport const exportImage = async (asJpeg = false, canvasRef, onExport) => {\r\n  if (!canvasRef.current) return;\r\n  const blob = await exportCanvasToBlob(\r\n    canvasRef.current,\r\n    asJpeg ? 'image/jpeg' : 'image/png',\r\n    0.92,\r\n  );\r\n  if (onExport) onExport(blob);\r\n  // auto download\r\n  const url = URL.createObjectURL(blob);\r\n  const a = document.createElement('a');\r\n  a.href = url;\r\n  a.download = asJpeg ? 'edited.jpg' : 'edited.png';\r\n  a.click();\r\n  URL.revokeObjectURL(url);\r\n  message.success('Exported image');\r\n};\r\n\r\n// copy to clipboard (image)\r\nexport const copyToClipboard = async (canvasRef) => {\r\n  if (!canvasRef.current) return;\r\n  try {\r\n    const blob = await exportCanvasToBlob(canvasRef.current, 'image/png');\r\n    // @ts-ignore navigator.clipboard\r\n    await (navigator.clipboard as any).write([new ClipboardItem({ 'image/png': blob })]);\r\n    message.success('Image copied to clipboard');\r\n  } catch (err) {\r\n    console.warn('clipboard failed', err);\r\n    message.error('Copy failed (browser may not support)');\r\n  }\r\n};\r\n\r\n// flip\r\nexport const flipH = (canvasRef, history) => {\r\n  if (!canvasRef.current) return;\r\n  const ctx = canvasRef.current.getContext('2d')!;\r\n  const tmp = createCanvas(canvasRef.current.width, canvasRef.current.height);\r\n  tmp.getContext('2d')!.drawImage(canvasRef.current, 0, 0);\r\n  ctx.save();\r\n  ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n  ctx.scale(-1, 1);\r\n  ctx.drawImage(tmp, -canvasRef.current.width, 0);\r\n  ctx.restore();\r\n  history.push(canvasRef.current.toDataURL(), 'Flip horizontal');\r\n};\r\nexport const flipV = (canvasRef, history) => {\r\n  if (!canvasRef.current) return;\r\n  const ctx = canvasRef.current.getContext('2d')!;\r\n  const tmp = createCanvas(canvasRef.current.width, canvasRef.current.height);\r\n  tmp.getContext('2d')!.drawImage(canvasRef.current, 0, 0);\r\n  ctx.save();\r\n  ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n  ctx.scale(1, -1);\r\n  ctx.drawImage(tmp, 0, -canvasRef.current.height);\r\n  ctx.restore();\r\n  history.push(canvasRef.current.toDataURL(), 'Flip vertical');\r\n};\r\n\r\n// Crop: apply cropRect to canvas\r\nexport const applyCrop = (canvasRef, overlayRef, cropRect, setCropRect, history) => {\r\n  if (!canvasRef.current || !cropRect) return;\r\n  const c = createCanvas(Math.max(1, Math.round(cropRect.w)), Math.max(1, Math.round(cropRect.h)));\r\n  const ctx = c.getContext('2d')!;\r\n  ctx.drawImage(\r\n    canvasRef.current,\r\n    cropRect.x,\r\n    cropRect.y,\r\n    cropRect.w,\r\n    cropRect.h,\r\n    0,\r\n    0,\r\n    cropRect.w,\r\n    cropRect.h,\r\n  );\r\n  // replace current canvas\r\n  canvasRef.current.width = c.width;\r\n  canvasRef.current.height = c.height;\r\n  overlayRef.current!.width = c.width;\r\n  overlayRef.current!.height = c.height;\r\n  const wctx = canvasRef.current.getContext('2d')!;\r\n  wctx.clearRect(0, 0, c.width, c.height);\r\n  wctx.drawImage(c, 0, 0);\r\n  setCropRect(null);\r\n  history.push(canvasRef.current.toDataURL(), 'Cropped');\r\n};\r\n\r\n/** --- COLOR PICKER --- */\r\nexport const samplePixel = (e: MouseEvent, canvasRef, zoom) => {\r\n  const canvas = canvasRef.current;\r\n  if (!canvas) return null;\r\n\r\n  const rect = canvas.getBoundingClientRect();\r\n  const x = Math.floor((e.clientX - rect.left) / zoom);\r\n  const y = Math.floor((e.clientY - rect.top) / zoom);\r\n  if (x < 0 || y < 0 || x >= canvas.width || y >= canvas.height) return null;\r\n\r\n  const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n  if (!ctx) return null;\r\n  const p = ctx.getImageData(x, y, 1, 1).data;\r\n  return `#${[p[0], p[1], p[2]].map((v) => v.toString(16).padStart(2, '0')).join('')}`;\r\n};\r\n\r\n// Store previous effects to detect changes\r\nlet previousEffects = {\r\n  // Convolution / blur effects\r\n  blur: 0,\r\n  gaussian: 0,\r\n  sharpen: 0,\r\n  texture: 0,\r\n  clarity: 0,\r\n\r\n  // Threshold\r\n  bgThreshold: 255,\r\n  bgThresholdBlack: 0,\r\n\r\n  // Brightness / contrast\r\n  brightness: 0,\r\n  contrast: 0,\r\n\r\n  // Tone adjustments\r\n  highlights: 0,\r\n  shadows: 0,\r\n  whites: 0,\r\n  blacks: 0,\r\n  vibrance: 0,\r\n  saturation: 0,\r\n  dehaze: 0,\r\n\r\n  // HSL adjustments (per-color)\r\n  hslAdjustments: {} as Record<string, { h?: number; s?: number; l?: number }>,\r\n};\r\n\r\n//cache the base image once\r\nlet cachedBaseImageData: ImageData | null = null;\r\n\r\nexport const applyEffects = (\r\n  canvasRef: React.RefObject<HTMLCanvasElement>,\r\n  baseCanvas: HTMLCanvasElement | null | undefined,\r\n  {\r\n    blur = 0,\r\n    gaussian = 0,\r\n    sharpen = 0,\r\n    bgThreshold = 255,\r\n    bgThresholdBlack = 0,\r\n    brightness = 0,\r\n    contrast = 0,\r\n    texture = 0,\r\n    clarity = 0,\r\n    highlights = 0,\r\n    shadows = 0,\r\n    whites = 0,\r\n    blacks = 0,\r\n    vibrance = 0,\r\n    saturation = 0,\r\n    dehaze = 0,\r\n    hslAdjustments = {} as Record<string, { h?: number; s?: number; l?: number }>,\r\n  },\r\n  history: { push: (img: string, label: string) => void },\r\n) => {\r\n  if (!canvasRef.current || !baseCanvas) return;\r\n\r\n  const ctx = canvasRef.current.getContext('2d')!;\r\n  const baseCtx = baseCanvas.getContext('2d')!;\r\n\r\n  // cache original image data once\r\n  if (!cachedBaseImageData)\r\n    cachedBaseImageData = baseCtx.getImageData(0, 0, baseCanvas.width, baseCanvas.height);\r\n  if (!cachedBaseImageData) return;\r\n\r\n  let cloned = cloneImageData(cachedBaseImageData);\r\n\r\n  // Early exit if no effects\r\n  if (\r\n    blur === 0 &&\r\n    gaussian === 0 &&\r\n    sharpen === 0 &&\r\n    texture === 0 &&\r\n    clarity === 0 &&\r\n    bgThreshold === 255 &&\r\n    bgThresholdBlack === 0 &&\r\n    brightness === 0 &&\r\n    contrast === 0 &&\r\n    highlights === 0 &&\r\n    shadows === 0 &&\r\n    whites === 0 &&\r\n    blacks === 0 &&\r\n    vibrance === 0 &&\r\n    saturation === 0 &&\r\n    dehaze === 0 &&\r\n    Object.keys(hslAdjustments).length === 0\r\n  ) {\r\n    ctx.putImageData(cloned, 0, 0);\r\n    return;\r\n  }\r\n\r\n  // Apply convolution effects\r\n  if (blur > 0) {\r\n    const size = blur % 2 === 0 ? blur + 1 : blur;\r\n    applyConvolution(cloned, Kernels.generateBoxBlurKernel(size), size);\r\n  }\r\n  if (gaussian > 0) {\r\n    const r = gaussian;\r\n    applyConvolution(cloned, Kernels.generateGaussianKernel(r), r * 2 + 1);\r\n  }\r\n  if (sharpen > 0) {\r\n    const kernel = Kernels.sharpen.map((v) =>\r\n      v === 5 ? 1 + sharpen * 4 : v === -1 ? -sharpen : v,\r\n    );\r\n    applyConvolution(cloned, kernel, 3);\r\n  }\r\n  if (texture !== 0) {\r\n    const detailKernel = [0, -1, 0, -1, 5 + texture * 0.05, -1, 0, -1, 0];\r\n    applyConvolution(cloned, detailKernel, 3);\r\n  }\r\n  if (clarity !== 0) {\r\n    const midtoneKernel = [0, -1, 0, -1, 5 + clarity * 0.08, -1, 0, -1, 0];\r\n    applyConvolution(cloned, midtoneKernel, 3);\r\n  }\r\n\r\n  // Threshold effects\r\n  if (bgThreshold < 255) applyThresholdAlpha(cloned, bgThreshold);\r\n  if (bgThresholdBlack > 0) applyThresholdAlphaBlack(cloned, bgThresholdBlack);\r\n\r\n  // Brightness/Contrast\r\n  if (brightness !== 0 || contrast !== 0) applyBrightnessContrast(cloned, brightness, contrast);\r\n\r\n  // Tone adjustments (highlights, shadows, whites, blacks, vibrance, saturation, dehaze)\r\n  if (\r\n    highlights !== 0 ||\r\n    shadows !== 0 ||\r\n    whites !== 0 ||\r\n    blacks !== 0 ||\r\n    vibrance !== 0 ||\r\n    saturation !== 0 ||\r\n    dehaze !== 0\r\n  ) {\r\n    const d = cloned.data;\r\n    for (let i = 0; i < d.length; i += 4) {\r\n      if (dehaze) applyDehaze(d, i, dehaze);\r\n      if (vibrance || saturation) applyVibranceSaturation(d, i, { vibrance, saturation });\r\n    }\r\n    applyToneAdjustments(cloned, {\r\n      highlights,\r\n      shadows,\r\n      whites,\r\n      blacks,\r\n      vibrance,\r\n      saturation,\r\n      clarity,\r\n      dehaze,\r\n    });\r\n  }\r\n\r\n  // HSL / Color mixer\r\n  if (Object.keys(hslAdjustments).length > 0) applyHslAdjustments(cloned, hslAdjustments);\r\n\r\n  // Draw final image\r\n  ctx.putImageData(cloned, 0, 0);\r\n\r\n  // Detect changes for history\r\n  const changedEffects = Object.entries({\r\n    blur,\r\n    gaussian,\r\n    sharpen,\r\n    texture,\r\n    clarity,\r\n    bgThreshold,\r\n    bgThresholdBlack,\r\n    brightness,\r\n    contrast,\r\n    highlights,\r\n    shadows,\r\n    whites,\r\n    blacks,\r\n    vibrance,\r\n    saturation,\r\n    dehaze,\r\n    hslAdjustments,\r\n  }).filter(([key, value]) => previousEffects[key] !== value);\r\n\r\n  if (changedEffects.length > 0) {\r\n    const historyLabel = changedEffects\r\n      .map(([key, value]) => `${key}=${JSON.stringify(value)}`)\r\n      .join(', ');\r\n    history.push(canvasRef.current.toDataURL(), `${historyLabel}`);\r\n    previousEffects = {\r\n      blur,\r\n      gaussian,\r\n      sharpen,\r\n      texture,\r\n      clarity,\r\n      bgThreshold,\r\n      bgThresholdBlack,\r\n      brightness,\r\n      contrast,\r\n      highlights,\r\n      shadows,\r\n      whites,\r\n      blacks,\r\n      vibrance,\r\n      saturation,\r\n      dehaze,\r\n      hslAdjustments,\r\n    };\r\n  }\r\n};\r\n\r\nexport const resetEffectsToBase = (\r\n  canvasRef: React.RefObject<HTMLCanvasElement>,\r\n  baseCanvas: HTMLCanvasElement | null | undefined,\r\n  history: { push: (img: string, label: string) => void },\r\n) => {\r\n  if (!canvasRef.current || !baseCanvas || !cachedBaseImageData) return;\r\n\r\n  const ctx = canvasRef.current.getContext('2d')!;\r\n  ctx.putImageData(cachedBaseImageData, 0, 0);\r\n\r\n  // Reset previous effects so history won‚Äôt re-detect old ones\r\n  previousEffects = {\r\n    blur: 0,\r\n    gaussian: 0,\r\n    sharpen: 0,\r\n    texture: 0,\r\n    clarity: 0,\r\n    bgThreshold: 255,\r\n    bgThresholdBlack: 0,\r\n    brightness: 0,\r\n    contrast: 0,\r\n    highlights: 0,\r\n    shadows: 0,\r\n    whites: 0,\r\n    blacks: 0,\r\n    vibrance: 0,\r\n    saturation: 0,\r\n    dehaze: 0,\r\n    hslAdjustments: {},\r\n  };\r\n\r\n  // Add to history\r\n  history.push(canvasRef.current.toDataURL(), 'Reset to base image');\r\n};\r\n","// src/components/ImageCanvas.tsx\r\nimport React from 'react';\r\n\r\ntype HoverColor = {\r\n  x: number;\r\n  y: number;\r\n  color: string;\r\n};\r\n\r\ntype ImageCanvasProps = {\r\n  canvasRef: React.RefObject<HTMLCanvasElement>;\r\n  overlayRef: React.RefObject<HTMLCanvasElement>;\r\n  containerRef: React.RefObject<HTMLDivElement>;\r\n  offset: { x: number; y: number };\r\n  zoom: number;\r\n  tool: string;\r\n  currentCursor: string;\r\n  hoverColor: HoverColor | null;\r\n  onMouseDown: (e: React.MouseEvent) => void;\r\n  onMouseMove: (e: React.MouseEvent) => void;\r\n  onMouseUp: () => void;\r\n};\r\n\r\nconst ImageCanvas: React.FC<ImageCanvasProps> = ({\r\n  canvasRef,\r\n  overlayRef,\r\n  containerRef,\r\n  offset,\r\n  zoom,\r\n  tool,\r\n  currentCursor,\r\n  hoverColor,\r\n  onMouseDown,\r\n  onMouseMove,\r\n  onMouseUp,\r\n}) => {\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      onMouseDown={onMouseDown}\r\n      onMouseMove={onMouseMove}\r\n      onMouseUp={onMouseUp}\r\n      style={{\r\n        width: '100%',\r\n        height: '100vh',\r\n        overflow: 'hidden',\r\n        border: '1px solid #eee',\r\n        position: 'relative',\r\n        background: '#fafafa',\r\n        cursor: currentCursor,\r\n      }}\r\n    >\r\n      <canvas\r\n        ref={canvasRef}\r\n        style={{\r\n          transform: `translate(${offset.x}px, ${offset.y}px) scale(${zoom})`,\r\n          transformOrigin: 'top left',\r\n          display: 'block',\r\n        }}\r\n      />\r\n      <canvas\r\n        ref={overlayRef}\r\n        style={{\r\n          position: 'absolute',\r\n          left: 0,\r\n          top: 0,\r\n          pointerEvents: 'none',\r\n          transform: `translate(${offset.x}px, ${offset.y}px) scale(${zoom})`,\r\n          transformOrigin: 'top left',\r\n        }}\r\n      />\r\n      {hoverColor && tool === 'color' && (\r\n        <div\r\n          style={{\r\n            position: 'fixed', // use fixed to position relative to viewport\r\n            left: hoverColor.x + 12,\r\n            top: hoverColor.y + 12,\r\n            background: '#fff',\r\n            padding: '4px 8px',\r\n            borderRadius: 4,\r\n            boxShadow: '0 0 6px rgba(0,0,0,0.2)',\r\n            fontSize: 12,\r\n            zIndex: 999999,\r\n            pointerEvents: 'none',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            gap: 6,\r\n          }}\r\n        >\r\n          <span\r\n            style={{\r\n              display: 'inline-block',\r\n              width: 12,\r\n              height: 12,\r\n              background: hoverColor.color,\r\n              border: '1px solid #ccc',\r\n            }}\r\n          />\r\n          {hoverColor.color}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageCanvas;\r\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport RotateLeftOutlinedSvg from \"@ant-design/icons-svg/es/asn/RotateLeftOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar RotateLeftOutlined = function RotateLeftOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: RotateLeftOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(RotateLeftOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'RotateLeftOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar ScissorOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M567.1 512l318.5-319.3c5-5 1.5-13.7-5.6-13.7h-90.5c-2.1 0-4.2.8-5.6 2.3l-273.3 274-90.2-90.5c12.5-22.1 19.7-47.6 19.7-74.8 0-83.9-68.1-152-152-152s-152 68.1-152 152 68.1 152 152 152c27.7 0 53.6-7.4 75.9-20.3l90 90.3-90.1 90.3A151.04 151.04 0 00288 582c-83.9 0-152 68.1-152 152s68.1 152 152 152 152-68.1 152-152c0-27.2-7.2-52.7-19.7-74.8l90.2-90.5 273.3 274c1.5 1.5 3.5 2.3 5.6 2.3H880c7.1 0 10.7-8.6 5.6-13.7L567.1 512zM288 370c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80zm0 444c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z\" } }] }, \"name\": \"scissor\", \"theme\": \"outlined\" };\nexport default ScissorOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport ScissorOutlinedSvg from \"@ant-design/icons-svg/es/asn/ScissorOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar ScissorOutlined = function ScissorOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: ScissorOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(ScissorOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'ScissorOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar ExportOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"fill-rule\": \"evenodd\", \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z\" } }] }, \"name\": \"export\", \"theme\": \"outlined\" };\nexport default ExportOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport ExportOutlinedSvg from \"@ant-design/icons-svg/es/asn/ExportOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar ExportOutlined = function ExportOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: ExportOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(ExportOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'ExportOutlined';\n}\nexport default RefIcon;","import { InputNumber, Slider } from 'antd';\r\n\r\ntype HslSliderProps = {\r\n  label: string;\r\n  value: number;\r\n  min: number;\r\n  max: number;\r\n  onChange: (v: number) => void;\r\n  onChangeComplete?: () => void;\r\n  gradient: string; // üëà dynamic CSS gradient for track\r\n};\r\n\r\nexport const HslSlider = ({\r\n  label,\r\n  value,\r\n  min,\r\n  max,\r\n  gradient,\r\n  onChange,\r\n  onChangeComplete,\r\n}: HslSliderProps) => (\r\n  <div className=\"hsl-slider-container\">\r\n    <span className=\"hsl-label\">{label}</span>\r\n\r\n    <Slider\r\n      min={min}\r\n      max={max}\r\n      value={value}\r\n      onChange={onChange}\r\n      onChangeComplete={onChangeComplete}\r\n      className=\"hsl-slider\"\r\n      trackStyle={{ background: gradient }}\r\n      railStyle={{ background: gradient }}\r\n      handleStyle={{ opacity: 1 }}\r\n    />\r\n\r\n    <InputNumber\r\n      min={min}\r\n      max={max}\r\n      value={value}\r\n      onChange={(v) => onChange(Number(v))}\r\n      onBlur={() => onChangeComplete?.()}\r\n      className=\"hsl-number\"\r\n      size=\"small\"\r\n    />\r\n  </div>\r\n);\r\n","import React, { useState } from 'react';\r\nimport {\r\n  Button,\r\n  Divider,\r\n  Slider,\r\n  Space,\r\n  Tooltip,\r\n  message,\r\n  ColorPicker,\r\n  InputNumber,\r\n  Collapse,\r\n  Select,\r\n} from 'antd';\r\nimport {\r\n  UndoOutlined,\r\n  RedoOutlined,\r\n  RotateLeftOutlined,\r\n  RotateRightOutlined,\r\n  SwapOutlined,\r\n  ScissorOutlined,\r\n  ExportOutlined,\r\n  CopyOutlined,\r\n  EditOutlined,\r\n} from '@ant-design/icons';\r\nimport { applyEffects, copyToClipboard, flipH, flipV, rotate } from '../../utils/helpers';\r\nimport { HslSlider } from './HslSlider';\r\n\r\nconst { Panel } = Collapse;\r\n\r\ntype HistoryItem = {\r\n  url: string;\r\n  label?: string;\r\n};\r\n\r\nconst { Option } = Select;\r\n\r\ntype Props = {\r\n  canvasRef: React.RefObject<HTMLCanvasElement>;\r\n  baseCanvas?: HTMLCanvasElement | null;\r\n  history: {\r\n    history: HistoryItem[];\r\n    index: number;\r\n    current: HistoryItem;\r\n    push: (url: string, label?: string) => void;\r\n    undo: () => void;\r\n    redo: () => void;\r\n  };\r\n  drawColor: string;\r\n  setDrawColor: (color: string) => void;\r\n  drawLineWidth: number;\r\n  setDrawLineWidth: (width: number) => void;\r\n  brushType: 'hard' | 'soft';\r\n  setBrushType: (type: 'hard' | 'soft') => void;\r\n  brushOpacity: number; // 0-1\r\n  setBrushOpacity: (v: number) => void;\r\n  brushFlow: number; // 0-1\r\n  setBrushFlow: (v: number) => void;\r\n  setTool: any;\r\n  brightness: number;\r\n  setBrightness: (v: number) => void;\r\n  contrast: number;\r\n  setContrast: (v: number) => void;\r\n  blur: number;\r\n  setBlur: (v: number) => void;\r\n  gaussian: number;\r\n  setGaussian: (v: number) => void;\r\n  sharpen: number;\r\n  setSharpen: (v: number) => void;\r\n  bgThreshold: number;\r\n  setBgThreshold: (v: number) => void;\r\n  bgThresholdBlack: number;\r\n  setBgThresholdBlack: (v: number) => void;\r\n  setShowPerspectiveModal: (show: boolean) => void;\r\n  dpiMeasured?: number | null;\r\n  setDpiMeasured?: (v: number | null) => void;\r\n  exportImage: (\r\n    jpg: boolean,\r\n    canvasRef: React.RefObject<HTMLCanvasElement>,\r\n    callback?: (blob: Blob) => void,\r\n  ) => void;\r\n  onExport?: (blob: Blob) => void;\r\n  overlayRef: React.RefObject<HTMLCanvasElement>;\r\n  texture: number;\r\n  setTexture: (v: number) => void;\r\n  clarity: number;\r\n  setClarity: (v: number) => void;\r\n  highlights: number;\r\n  setHighlights: (v: number) => void;\r\n  shadows: number;\r\n  setShadows: (v: number) => void;\r\n  whites: number;\r\n  setWhites: (v: number) => void;\r\n  blacks: number;\r\n  setBlacks: (v: number) => void;\r\n  vibrance: number;\r\n  setVibrance: (v: number) => void;\r\n  saturation: number;\r\n  setSaturation: (v: number) => void;\r\n  dehaze: number;\r\n  setDehaze: (v: number) => void;\r\n  hslAdjustments: Record<string, { h?: number; s?: number; l?: number }>;\r\n  setHslAdjustments: (name: string, values: Partial<{ h: number; s: number; l: number }>) => void;\r\n};\r\n\r\nconst ImageEditorToolbar: React.FC<Props> = ({\r\n  canvasRef,\r\n  baseCanvas,\r\n  history,\r\n  drawColor,\r\n  setDrawColor,\r\n  drawLineWidth,\r\n  setDrawLineWidth,\r\n  brushType,\r\n  setBrushType,\r\n  brushOpacity,\r\n  setBrushOpacity,\r\n  brushFlow,\r\n  setBrushFlow,\r\n  setTool,\r\n  brightness,\r\n  setBrightness,\r\n  contrast,\r\n  setContrast,\r\n  blur,\r\n  setBlur,\r\n  gaussian,\r\n  setGaussian,\r\n  sharpen,\r\n  setSharpen,\r\n  bgThreshold,\r\n  setBgThreshold,\r\n  bgThresholdBlack,\r\n  setBgThresholdBlack,\r\n  setShowPerspectiveModal,\r\n  dpiMeasured,\r\n  setDpiMeasured,\r\n  exportImage,\r\n  onExport,\r\n  overlayRef,\r\n  texture,\r\n  setTexture,\r\n  clarity,\r\n  setClarity,\r\n  highlights,\r\n  setHighlights,\r\n  shadows,\r\n  setShadows,\r\n  whites,\r\n  setWhites,\r\n  blacks,\r\n  setBlacks,\r\n  vibrance,\r\n  setVibrance,\r\n  saturation,\r\n  setSaturation,\r\n  dehaze,\r\n  setDehaze,\r\n  hslAdjustments,\r\n  setHslAdjustments,\r\n}) => {\r\n  const [activeColor, setActiveColor] = useState('red');\r\n  const colorSwatches = [\r\n    { name: 'red', color: '#ff4d4d' },\r\n    { name: 'orange', color: '#ffa500' },\r\n    { name: 'yellow', color: '#ffd700' },\r\n    { name: 'green', color: '#00c853' },\r\n    { name: 'aqua', color: '#00e5ff' },\r\n    { name: 'blue', color: '#2979ff' },\r\n    { name: 'purple', color: '#9c27b0' },\r\n    { name: 'magenta', color: '#ff00aa' },\r\n  ];\r\n\r\n  const getSliderGradient = (activeColor: string, type: 'h' | 's' | 'l') => {\r\n    const base = colorSwatches.find((c) => c.name === activeColor)?.color || '#ffffff';\r\n\r\n    const index = colorSwatches.findIndex((c) => c.name === activeColor);\r\n\r\n    // If not found, default to grayscale\r\n    if (index === -1) return '#555';\r\n\r\n    const current = colorSwatches[index].color;\r\n    const left = colorSwatches[index - 1]?.color || current; // If first, use itself\r\n    const right = colorSwatches[index + 1]?.color || current; // If last, use itself\r\n\r\n    switch (type) {\r\n      case 'h':\r\n        return `linear-gradient(90deg, ${left}, ${current}, ${right})`;\r\n      case 's':\r\n        return `linear-gradient(90deg, gray, ${base})`;\r\n      case 'l':\r\n        return `linear-gradient(90deg, black, ${base}, white)`;\r\n      default:\r\n        return '#555';\r\n    }\r\n  };\r\n\r\n  const apply = () =>\r\n    applyEffects(\r\n      canvasRef,\r\n      baseCanvas,\r\n      {\r\n        blur,\r\n        gaussian,\r\n        sharpen,\r\n        texture,\r\n        clarity,\r\n        bgThreshold,\r\n        bgThresholdBlack,\r\n        brightness,\r\n        contrast,\r\n        highlights,\r\n        shadows,\r\n        whites,\r\n        blacks,\r\n        vibrance,\r\n        saturation,\r\n        dehaze,\r\n        hslAdjustments,\r\n      },\r\n      history,\r\n    );\r\n\r\n  return (\r\n    <div style={{ width: 260 }}>\r\n      <Collapse defaultActiveKey={['basic', 'lights', 'effects']} ghost expandIconPosition=\"end\">\r\n        {/* üîß Basic Tools */}\r\n        <Panel header=\"üõ† Basic\" key=\"basic\">\r\n          <Space wrap>\r\n            <Tooltip title=\"Undo (Ctrl+Z)\">\r\n              <Button icon={<UndoOutlined />} onClick={history.undo} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Redo (Ctrl+Shift+Z)\">\r\n              <Button icon={<RedoOutlined />} onClick={history.redo} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Rotate left\">\r\n              <Button\r\n                icon={<RotateLeftOutlined />}\r\n                onClick={() => rotate(-90, canvasRef, overlayRef, history)}\r\n              />\r\n            </Tooltip>\r\n            <Tooltip title=\"Rotate right\">\r\n              <Button\r\n                icon={<RotateRightOutlined />}\r\n                onClick={() => rotate(90, canvasRef, overlayRef, history)}\r\n              />\r\n            </Tooltip>\r\n            <Tooltip title=\"Flip horizontal\">\r\n              <Button icon={<SwapOutlined />} onClick={() => flipH(canvasRef, history)} />\r\n            </Tooltip>\r\n            <Tooltip title=\"Flip vertical\">\r\n              <Button\r\n                icon={<SwapOutlined rotate={90} />}\r\n                onClick={() => flipV(canvasRef, history)}\r\n              />\r\n            </Tooltip>\r\n\r\n            <Tooltip title=\"Brush\">\r\n              <Button icon={<EditOutlined />} onClick={() => setTool('draw')} />\r\n            </Tooltip>\r\n          </Space>\r\n        </Panel>\r\n\r\n        {/* üîÜ Light */}\r\n        <Panel header=\"üîÜ Light\" key=\"lights\">\r\n          <div>Brightness</div>\r\n          <Slider\r\n            min={-150}\r\n            max={150}\r\n            value={brightness}\r\n            onChange={setBrightness}\r\n            onChangeComplete={apply}\r\n          />\r\n          <div>Contrast</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={contrast}\r\n            onChange={setContrast}\r\n            onChangeComplete={apply}\r\n          />\r\n        </Panel>\r\n\r\n        {/* üé® Color & HSL */}\r\n        <Panel header=\"üé® Color\" key=\"color\">\r\n          <div style={{ marginBottom: 8 }}>Vibrance</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={vibrance}\r\n            onChange={setVibrance}\r\n            onChangeComplete={apply}\r\n          />\r\n\r\n          <div style={{ marginBottom: 8 }}>Saturation</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={saturation}\r\n            onChange={setSaturation}\r\n            onChangeComplete={apply}\r\n          />\r\n\r\n          <div style={{ marginBottom: 8 }}>Dehaze</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={dehaze}\r\n            onChange={setDehaze}\r\n            onChangeComplete={apply}\r\n          />\r\n\r\n          {/* HSL Picker */}\r\n          <div style={{ marginTop: 10 }}>HSL Mixer</div>\r\n          <div style={{ display: 'flex', gap: 8, marginBottom: 10 }}>\r\n            {colorSwatches.map(({ name, color }) => (\r\n              <Tooltip title={name.toUpperCase()}>\r\n                <div\r\n                  key={name}\r\n                  onClick={() => setActiveColor(name)}\r\n                  style={{\r\n                    width: 20,\r\n                    height: 20,\r\n                    borderRadius: '50%',\r\n                    background: color,\r\n                    border: activeColor === name ? '2px solid white' : '1px solid #555',\r\n                    boxShadow: activeColor === name ? '0 0 6px rgba(255,255,255,0.8)' : '',\r\n                    cursor: 'pointer',\r\n                  }}\r\n                />\r\n              </Tooltip>\r\n            ))}\r\n          </div>\r\n          {/* <div>{activeColor.toUpperCase()}</div> */}\r\n\r\n          {['Hue', 'Saturation', 'Luminance'].map((label) => {\r\n            const key = label[0].toLowerCase(); // h/s/l\r\n            return (\r\n              <HslSlider\r\n                key={label}\r\n                label={label}\r\n                value={hslAdjustments[activeColor]?.[key] ?? 0}\r\n                min={label === 'Hue' ? -180 : -100}\r\n                max={label === 'Hue' ? 180 : 100}\r\n                onChange={(v) => setHslAdjustments(activeColor, { [key]: v })}\r\n                onChangeComplete={apply}\r\n                gradient={getSliderGradient(activeColor, key as 'h' | 's' | 'l')}\r\n              />\r\n            );\r\n          })}\r\n\r\n          <Button size=\"small\" onClick={() => setHslAdjustments(activeColor, { h: 0, s: 0, l: 0 })}>\r\n            Reset\r\n          </Button>\r\n        </Panel>\r\n\r\n        {/* ‚ú® Effects */}\r\n        <Panel header=\"‚ú® Effects\" key=\"effects\">\r\n          <div>Texture</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={texture}\r\n            onChange={setTexture}\r\n            onChangeComplete={apply}\r\n          />\r\n          <div>Clarity</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={clarity}\r\n            onChange={setClarity}\r\n            onChangeComplete={apply}\r\n          />\r\n\r\n          <div>Highlights</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={highlights}\r\n            onChange={setHighlights}\r\n            onChangeComplete={apply}\r\n          />\r\n\r\n          <div>Shadows</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={shadows}\r\n            onChange={setShadows}\r\n            onChangeComplete={apply}\r\n          />\r\n\r\n          <div>Whites</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={whites}\r\n            onChange={setWhites}\r\n            onChangeComplete={apply}\r\n          />\r\n\r\n          <div>Blacks</div>\r\n          <Slider\r\n            min={-100}\r\n            max={100}\r\n            value={blacks}\r\n            onChange={setBlacks}\r\n            onChangeComplete={apply}\r\n          />\r\n        </Panel>\r\n\r\n        {/* üé≠ Filters */}\r\n        <Panel header=\"üé≠ Filters\" key=\"filters\">\r\n          <div>Box Blur</div>\r\n          <Slider min={0} max={25} value={blur} onChange={setBlur} onChangeComplete={apply} />\r\n          <div>Gaussian</div>\r\n          <Slider\r\n            min={0}\r\n            max={20}\r\n            value={gaussian}\r\n            onChange={setGaussian}\r\n            onChangeComplete={apply}\r\n          />\r\n          <div>Sharpen</div>\r\n          <Slider min={0} max={5} value={sharpen} onChange={setSharpen} onChangeComplete={apply} />\r\n\r\n          <div>Remove White</div>\r\n          <Slider\r\n            min={0}\r\n            max={255}\r\n            value={bgThreshold}\r\n            onChange={setBgThreshold}\r\n            onChangeComplete={apply}\r\n          />\r\n          <div>Remove Black</div>\r\n          <Slider\r\n            min={0}\r\n            max={255}\r\n            value={bgThresholdBlack}\r\n            onChange={setBgThresholdBlack}\r\n            onChangeComplete={apply}\r\n          />\r\n        </Panel>\r\n\r\n        {/* üìê Crop / Ruler */}\r\n        <Panel header=\"üìê Crop & Ruler\" key=\"crop\">\r\n          <Space>\r\n            <Button icon={<ScissorOutlined />} onClick={() => setTool('crop')}>\r\n              Crop\r\n            </Button>\r\n            <Button\r\n              onClick={() => {\r\n                setShowPerspectiveModal(true);\r\n                setTool('perspective');\r\n              }}\r\n            >\r\n              Perspective\r\n            </Button>\r\n          </Space>\r\n\r\n          <div style={{ marginTop: 10 }}>Ruler</div>\r\n          <Space>\r\n            <Button onClick={() => setTool('ruler')}>üìè Ruler</Button>\r\n            <Button\r\n              onClick={() => {\r\n                setDpiMeasured?.(null);\r\n                message.info('Ruler cleared');\r\n              }}\r\n            >\r\n              Clear\r\n            </Button>\r\n          </Space>\r\n          {dpiMeasured && <div>Estimated DPI: {dpiMeasured}</div>}\r\n        </Panel>\r\n\r\n        {/* üì§ Export */}\r\n        <Panel header=\"üì§ Export\" key=\"export\">\r\n          <Space>\r\n            <Button\r\n              icon={<ExportOutlined />}\r\n              onClick={() => exportImage(false, canvasRef, onExport)}\r\n            >\r\n              PNG\r\n            </Button>\r\n            <Button onClick={() => exportImage(true, canvasRef, onExport)}>JPG</Button>\r\n            <Button icon={<CopyOutlined />} onClick={() => copyToClipboard(canvasRef)}>\r\n              Copy\r\n            </Button>\r\n          </Space>\r\n        </Panel>\r\n      </Collapse>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageEditorToolbar;\r\n","//#region Imports\r\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { Button, Space, Tooltip, Modal, Select, message, InputNumber, ColorPicker } from 'antd';\r\nimport { ZoomInOutlined, ZoomOutOutlined } from '@ant-design/icons';\r\n\r\nimport { perspectiveTransform } from '@/pages/PNGJPEG/utils/ImageEditorEngine';\r\n\r\nimport useCanvas from '../../hooks/useCanvas';\r\nimport useHistory from '../../hooks/useHistory';\r\nimport { applyCrop, exportImage, rotate, samplePixel } from '../../utils/helpers';\r\nimport ImageCanvas from './ImageCanvas';\r\nimport ImageEditorToolbar from './ImageEditorToolbar';\r\n//#endregion\r\n\r\n//#region Types\r\ntype Tool = 'pan' | 'crop' | 'color' | 'ruler' | 'perspective' | 'select' | 'draw';\r\n\r\ntype Props = {\r\n  imageUrl: string;\r\n  onExport?: (blob: Blob) => void;\r\n};\r\n\r\nconst { Option } = Select;\r\n//#endregion\r\n\r\nconst ImageEditor: React.FC<Props> = ({ imageUrl, onExport }) => {\r\n  //#region Canvas Setup\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n  const onLoad = (dataUrl: string) => history.push(dataUrl, 'Initial load');\r\n  const { canvasRef, overlayRef, baseCanvas } = useCanvas(imageUrl, onLoad);\r\n  const history = useHistory(canvasRef, overlayRef);\r\n  //#endregion\r\n\r\n  //#region Viewer State (pan/zoom)\r\n  const [zoom, setZoom] = useState(1);\r\n  const [offset, setOffset] = useState({ x: 0, y: 0 });\r\n  const [isPanning, setIsPanning] = useState(false);\r\n  const panStart = useRef<{ x: number; y: number } | null>(null);\r\n  //#endregion\r\n\r\n  //#region Active Tool\r\n  const [tool, setTool] = useState<Tool>('pan');\r\n  //#endregion\r\n\r\n  //#region Image Adjustments\r\n  const [brightness, setBrightness] = useState(0);\r\n  const [contrast, setContrast] = useState(0);\r\n\r\n  const [highlights, setHighlights] = useState(0);\r\n  const [shadows, setShadows] = useState(0);\r\n  const [whites, setWhites] = useState(0);\r\n  const [blacks, setBlacks] = useState(0);\r\n\r\n  const [vibrance, setVibrance] = useState(0);\r\n  const [saturation, setSaturation] = useState(0);\r\n\r\n  const [dehaze, setDehaze] = useState(0);\r\n  //#endregion\r\n\r\n  //#region Crop Tool\r\n  const [cropRect, setCropRect] = useState<{ x: number; y: number; w: number; h: number } | null>(\r\n    null,\r\n  );\r\n  const cropStart = useRef<{ x: number; y: number } | null>(null);\r\n  //#endregion\r\n\r\n  //#region Perspective Tool\r\n  const [showPerspectiveModal, setShowPerspectiveModal] = useState(false);\r\n  const perspectivePoints = useRef<\r\n    [number, number, number, number, number, number, number, number] | null\r\n  >(null);\r\n  //#endregion\r\n\r\n  //#region Hotkey States\r\n  const [toolBefore, setToolBefore] = useState<Tool | null>(null);\r\n  const [isSpaceDown, setIsSpaceDown] = useState(false);\r\n  const [isAltDown, setIsAltDown] = useState(false);\r\n  //#endregion\r\n\r\n  //#region Color Picker\r\n  const [hoverColor, setHoverColor] = useState<{ x: number; y: number; color: string } | null>(\r\n    null,\r\n  );\r\n  const [pickedColor, setPickedColor] = useState<string | null>(null);\r\n  //#endregion\r\n\r\n  //#region Ruler Tool\r\n  const [rulerActive] = useState(false);\r\n  const rulerPoints = useRef<{ x1: number; y1: number; x2: number; y2: number } | null>(null);\r\n  const [dpiMeasured, setDpiMeasured] = useState<number | null>(null);\r\n  //#endregion\r\n\r\n  //#region Drawing Tool\r\n  const [drawColor, setDrawColor] = useState('#ff0000');\r\n  const [drawLineWidth, setDrawLineWidth] = useState(2);\r\n  const [brushType, setBrushType] = useState<'hard' | 'soft'>('hard');\r\n  const [brushOpacity, setBrushOpacity] = useState(1); // 0 - 1\r\n  const [brushFlow, setBrushFlow] = useState(1); // 0 - 1\r\n  const [isDrawing, setIsDrawing] = useState(false);\r\n  const drawPoints = useRef<{ x: number; y: number }[]>([]);\r\n  const resizingBrush = useRef(false);\r\n  const resizeStartX = useRef<number | null>(null);\r\n  const initialLineWidth = useRef(drawLineWidth);\r\n  // Drag-to-adjust opacity refs\r\n  const draggingOpacity = useRef(false);\r\n  const opacityDragStartX = useRef<number | null>(null);\r\n  const opacityStartValue = useRef<number>(brushOpacity);\r\n  // Drag-to-adjust flow refs\r\n  const draggingFlow = useRef(false);\r\n  const flowDragStartX = useRef<number | null>(null);\r\n  const flowStartValue = useRef<number>(brushFlow);\r\n  //#endregion\r\n\r\n  //#region Filters\r\n  const [blur, setBlur] = useState(0);\r\n  const [gaussian, setGaussian] = useState(0);\r\n  const [sharpen, setSharpen] = useState(0);\r\n  const [texture, setTexture] = useState(0);\r\n  const [clarity, setClarity] = useState(0);\r\n\r\n  const [bgThreshold, setBgThreshold] = useState(255);\r\n  const [bgThresholdBlack, setBgThresholdBlack] = useState(0);\r\n\r\n  const [hslAdjustments, setHslAdjustmentsState] = useState<\r\n    Record<string, { h?: number; s?: number; l?: number }>\r\n  >({});\r\n  const setHslAdjustments = (\r\n    name: string,\r\n    values: Partial<{ h: number; s: number; l: number }>,\r\n  ) => {\r\n    setHslAdjustmentsState((prev) => ({\r\n      ...prev,\r\n      [name]: { ...(prev[name] || {}), ...values },\r\n    }));\r\n  };\r\n  //#endregion\r\n\r\n  //#region Event Effects & Handlers\r\n  // #region üñ±Ô∏è Disable Right-Click Context Menu\r\n  useEffect(() => {\r\n    const canvas = containerRef.current;\r\n    if (!canvas) return;\r\n    const handleContextMenu = (e: MouseEvent) => e.preventDefault();\r\n    canvas.addEventListener('contextmenu', handleContextMenu);\r\n    return () => canvas.removeEventListener('contextmenu', handleContextMenu);\r\n  }, []);\r\n\r\n  //#endregion\r\n\r\n  // #region üîç Ctrl + Wheel Zoom Handler\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    const canvas = canvasRef.current;\r\n    if (!container || !canvas) return;\r\n\r\n    const handleWheel = (e: WheelEvent) => {\r\n      if (!e.ctrlKey) return;\r\n      e.preventDefault();\r\n\r\n      const rect = canvas.getBoundingClientRect();\r\n      const mouseX = e.clientX - rect.left;\r\n      const mouseY = e.clientY - rect.top;\r\n\r\n      setZoom((prev) => {\r\n        const zoomFactor = e.deltaY < 0 ? 1.1 : 0.9;\r\n        const newZoom = Math.min(Math.max(prev * zoomFactor, 0.1), 12);\r\n\r\n        const scaleChange = newZoom / prev;\r\n        setOffset((prevOffset) => ({\r\n          x: mouseX - (mouseX - prevOffset.x) * scaleChange,\r\n          y: mouseY - (mouseY - prevOffset.y) * scaleChange,\r\n        }));\r\n\r\n        return newZoom;\r\n      });\r\n    };\r\n\r\n    container.addEventListener('wheel', handleWheel, { passive: false });\r\n    return () => container.removeEventListener('wheel', handleWheel);\r\n  }, []);\r\n  //#endregion\r\n\r\n  //#region üñ≤Ô∏è Mouse Events (Down/Move/Up for Tools)\r\n  const handleMouseDownViewer = (e: React.MouseEvent) => {\r\n    const rect = canvasRef.current!.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / zoom;\r\n    const y = (e.clientY - rect.top) / zoom;\r\n\r\n    if (tool === 'color' && e.altKey && e.button === 2) setTool('draw');\r\n    // ALT + right button for brush resize\r\n    if ((tool === 'draw' || tool === 'color') && e.altKey && e.button === 2) {\r\n      e.preventDefault();\r\n      resizingBrush.current = true;\r\n      resizeStartX.current = e.clientX;\r\n      initialLineWidth.current = drawLineWidth;\r\n      return;\r\n    }\r\n\r\n    if (tool === 'pan' || tool === 'select') {\r\n      setIsPanning(true);\r\n      panStart.current = { x: e.clientX - offset.x, y: e.clientY - offset.y };\r\n    } else if (tool === 'crop') {\r\n      cropStart.current = { x, y };\r\n      setCropRect({ x, y, w: 1, h: 1 });\r\n    } else if (tool === 'ruler') {\r\n      if (!rulerPoints.current) {\r\n        rulerPoints.current = { x1: x, y1: y, x2: x, y2: y };\r\n      } else {\r\n        rulerPoints.current.x2 = x;\r\n        rulerPoints.current.y2 = y;\r\n        const dx = x - rulerPoints.current.x1;\r\n        const dy = y - rulerPoints.current.y1;\r\n        const px = Math.sqrt(dx * dx + dy * dy);\r\n        const dpi = Math.round(\r\n          (px / (canvasRef.current!.width / (window.devicePixelRatio || 1))) * 96,\r\n        );\r\n        setDpiMeasured(dpi);\r\n        message.info(`Distance: ${Math.round(px)} px, estimated DPI: ${dpi}`);\r\n        rulerPoints.current = null;\r\n      }\r\n    } else if (tool === 'perspective') {\r\n      if (!perspectivePoints.current) perspectivePoints.current = [x, y, x, y, x, y, x, y];\r\n      const p = perspectivePoints.current!;\r\n      for (let i = 0; i < 8; i += 2) {\r\n        if (isNaN(p[i]) || isNaN(p[i + 1]) || (p[i] === 0 && p[i + 1] === 0)) {\r\n          p[i] = x;\r\n          p[i + 1] = y;\r\n          break;\r\n        }\r\n      }\r\n    } else if (tool === 'draw') {\r\n      setIsDrawing(true);\r\n      drawPoints.current = [{ x, y }];\r\n    }\r\n  };\r\n\r\n  const handleMouseMoveViewer = (e: React.MouseEvent) => {\r\n    if (resizingBrush.current && resizeStartX.current !== null) {\r\n      const deltaX = e.clientX - resizeStartX.current;\r\n      const newWidth = Math.max(\r\n        1,\r\n        Math.round(Math.min(500, initialLineWidth.current + deltaX / 5) * 10) / 10,\r\n      );\r\n      setDrawLineWidth(newWidth);\r\n      return;\r\n    }\r\n\r\n    if ((tool === 'pan' || tool === 'select') && isPanning && panStart.current) {\r\n      setOffset({ x: e.clientX - panStart.current.x, y: e.clientY - panStart.current.y });\r\n    } else if (tool === 'crop' && cropStart.current) {\r\n      const rect = canvasRef.current!.getBoundingClientRect();\r\n      const cur = { x: (e.clientX - rect.left) / zoom, y: (e.clientY - rect.top) / zoom };\r\n      setCropRect({\r\n        x: Math.min(cropStart.current.x, cur.x),\r\n        y: Math.min(cropStart.current.y, cur.y),\r\n        w: Math.abs(cur.x - cropStart.current.x),\r\n        h: Math.abs(cur.y - cropStart.current.y),\r\n      });\r\n      drawOverlay();\r\n    } else if (tool === 'draw' && isDrawing && canvasRef.current) {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n      const x = (e.clientX - rect.left) / zoom;\r\n      const y = (e.clientY - rect.top) / zoom;\r\n\r\n      drawPoints.current.push({ x, y });\r\n\r\n      const ctx = canvasRef.current.getContext('2d')!;\r\n      ctx.save();\r\n      // Set stroke color with opacity & flow\r\n      ctx.globalAlpha = brushOpacity * brushFlow;\r\n\r\n      // For soft brushes, use shadow blur\r\n      if (brushType === 'soft') {\r\n        ctx.shadowColor = drawColor;\r\n        ctx.shadowBlur = drawLineWidth * 0.5;\r\n        ctx.lineWidth = drawLineWidth * 0.5;\r\n      } else {\r\n        ctx.shadowBlur = 0;\r\n        ctx.lineWidth = drawLineWidth;\r\n      }\r\n\r\n      ctx.strokeStyle = drawColor;\r\n      ctx.lineCap = 'round';\r\n      ctx.lineJoin = 'round';\r\n\r\n      ctx.beginPath();\r\n      const points = drawPoints.current;\r\n      ctx.moveTo(points[points.length - 2].x, points[points.length - 2].y);\r\n      ctx.lineTo(points[points.length - 1].x, points[points.length - 1].y);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n      drawOverlay();\r\n    } else {\r\n      drawOverlay();\r\n    }\r\n  };\r\n\r\n  const handleMouseUpViewer = () => {\r\n    if (resizingBrush.current) {\r\n      resizingBrush.current = false;\r\n      resizeStartX.current = null;\r\n      initialLineWidth.current = drawLineWidth;\r\n      return;\r\n    }\r\n\r\n    setIsPanning(false);\r\n    panStart.current = null;\r\n    if (tool === 'crop' && cropRect)\r\n      applyCrop(canvasRef, overlayRef, cropRect, setCropRect, history);\r\n    if (tool === 'draw' && isDrawing) {\r\n      setIsDrawing(false);\r\n      history.push(canvasRef.current!.toDataURL(), 'Draw');\r\n    }\r\n  };\r\n  //#endregion\r\n\r\n  //#region üé® Draw Overlay Layer (Crop / Ruler / Perspective / Hover Preview)\r\n  const drawOverlay = () => {\r\n    if (!overlayRef.current || !canvasRef.current) return;\r\n    const ctx = overlayRef.current.getContext('2d')!;\r\n    ctx.clearRect(0, 0, overlayRef.current.width, overlayRef.current.height);\r\n\r\n    // Crop rectangle\r\n    if (cropRect) {\r\n      ctx.save();\r\n      ctx.strokeStyle = '#00aaff';\r\n      ctx.lineWidth = 2;\r\n      ctx.setLineDash([6, 4]);\r\n      ctx.strokeRect(cropRect.x, cropRect.y, cropRect.w, cropRect.h);\r\n      ctx.restore();\r\n    }\r\n\r\n    // Ruler\r\n    if (rulerPoints.current) {\r\n      ctx.save();\r\n      ctx.strokeStyle = '#ffcc00';\r\n      ctx.lineWidth = 2;\r\n      ctx.beginPath();\r\n      ctx.moveTo(rulerPoints.current.x1, rulerPoints.current.y1);\r\n      ctx.lineTo(rulerPoints.current.x2, rulerPoints.current.y2);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n\r\n    // Perspective points\r\n    if (perspectivePoints.current) {\r\n      ctx.save();\r\n      ctx.fillStyle = 'rgba(0,255,0,0.8)';\r\n      for (let i = 0; i < 8; i += 2) {\r\n        const x = perspectivePoints.current[i];\r\n        const y = perspectivePoints.current[i + 1];\r\n        if (!isNaN(x) && !isNaN(y)) ctx.fillRect(x - 4, y - 4, 8, 8);\r\n      }\r\n      ctx.restore();\r\n    }\r\n\r\n    // Color hover\r\n    if (hoverColor && tool === 'color') {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n\r\n      const canvasX = (hoverColor.x - rect.left) / zoom;\r\n      const canvasY = (hoverColor.y - rect.top) / zoom;\r\n      ctx.save();\r\n      ctx.strokeStyle = hoverColor.color;\r\n      ctx.lineWidth = 2 / zoom;\r\n      ctx.beginPath();\r\n      ctx.arc(canvasX, canvasY, 8 / zoom, 0, Math.PI * 2);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n\r\n    // draw\r\n    if (hoverColor && tool === 'draw') {\r\n      const rect = canvasRef.current.getBoundingClientRect();\r\n\r\n      const canvasX = (hoverColor.x - rect.left) / zoom;\r\n      const canvasY = (hoverColor.y - rect.top) / zoom;\r\n      ctx.save();\r\n      ctx.strokeStyle = drawColor;\r\n      ctx.lineWidth = 2 / zoom;\r\n      ctx.beginPath();\r\n      ctx.arc(canvasX, canvasY, drawLineWidth / 2, 0, Math.PI * 2);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n  };\r\n\r\n  const handleOpacityLabelMouseDown = (e: React.MouseEvent) => {\r\n    if (e.button !== 0) return; // only left button\r\n    e.preventDefault();\r\n    draggingOpacity.current = true;\r\n    opacityDragStartX.current = e.clientX;\r\n    opacityStartValue.current = brushOpacity;\r\n\r\n    // prevent text selection while dragging\r\n    const prevUserSelect = document.body.style.userSelect;\r\n    document.body.style.userSelect = 'none';\r\n\r\n    const onMouseMove = (ev: MouseEvent) => {\r\n      if (!draggingOpacity.current || opacityDragStartX.current === null) return;\r\n      const delta = ev.clientX - opacityDragStartX.current;\r\n      // sensitivity: 0.005 per pixel = 0.05 change per 10px\r\n      const sensitivity = 0.005;\r\n      let newVal = opacityStartValue.current + delta * sensitivity;\r\n      newVal = Math.max(0, Math.min(1, newVal));\r\n      setBrushOpacity(Number(newVal.toFixed(2)));\r\n    };\r\n\r\n    const onMouseUp = () => {\r\n      draggingOpacity.current = false;\r\n      opacityDragStartX.current = null;\r\n      opacityStartValue.current = brushOpacity;\r\n      document.body.style.userSelect = prevUserSelect;\r\n      window.removeEventListener('mousemove', onMouseMove);\r\n      window.removeEventListener('mouseup', onMouseUp);\r\n    };\r\n\r\n    window.addEventListener('mousemove', onMouseMove);\r\n    window.addEventListener('mouseup', onMouseUp);\r\n  };\r\n\r\n  const handleFlowLabelMouseDown = (e: React.MouseEvent) => {\r\n    if (e.button !== 0) return; // only left button\r\n    e.preventDefault();\r\n    draggingFlow.current = true;\r\n    flowDragStartX.current = e.clientX;\r\n    flowStartValue.current = brushFlow;\r\n\r\n    // prevent text selection while dragging\r\n    const prevUserSelect = document.body.style.userSelect;\r\n    document.body.style.userSelect = 'none';\r\n\r\n    const onMouseMove = (ev: MouseEvent) => {\r\n      if (!draggingFlow.current || flowDragStartX.current === null) return;\r\n      const delta = ev.clientX - flowDragStartX.current;\r\n      // sensitivity: 0.005 per pixel = 0.05 change per 10px\r\n      const sensitivity = 0.005;\r\n      let newVal = flowStartValue.current + delta * sensitivity;\r\n      newVal = Math.max(0, Math.min(1, newVal));\r\n      setBrushFlow(Number(newVal.toFixed(2)));\r\n    };\r\n\r\n    const onMouseUp = () => {\r\n      draggingFlow.current = false;\r\n      flowDragStartX.current = null;\r\n      flowStartValue.current = brushFlow;\r\n      document.body.style.userSelect = prevUserSelect;\r\n      window.removeEventListener('mousemove', onMouseMove);\r\n      window.removeEventListener('mouseup', onMouseUp);\r\n    };\r\n\r\n    window.addEventListener('mousemove', onMouseMove);\r\n    window.addEventListener('mouseup', onMouseUp);\r\n  };\r\n\r\n  //#region üéØ Color Picker & Hover Preview\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n\r\n    const handleMove = (e: MouseEvent) => {\r\n      if (tool === 'color') {\r\n        const color = samplePixel(e, canvasRef, zoom);\r\n        setHoverColor(color ? { x: e.clientX, y: e.clientY, color } : null);\r\n        drawOverlay();\r\n      } else if (tool === 'draw') {\r\n        setHoverColor(drawColor ? { x: e.clientX, y: e.clientY, color: drawColor } : null);\r\n        drawOverlay();\r\n      }\r\n    };\r\n\r\n    const handleClick = (e: MouseEvent) => {\r\n      if (tool === 'color') {\r\n        const color = samplePixel(e, canvasRef, zoom);\r\n        if (color) {\r\n          setPickedColor(color);\r\n          setDrawColor(color);\r\n          navigator.clipboard.writeText(color).catch(() => {});\r\n          message.success(`Picked color ${color}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    const handleLeave = () => {\r\n      if (tool === 'color') setHoverColor(null);\r\n    };\r\n\r\n    canvas.addEventListener('mousemove', handleMove);\r\n    canvas.addEventListener('click', handleClick);\r\n    canvas.addEventListener('mouseleave', handleLeave);\r\n\r\n    return () => {\r\n      canvas.removeEventListener('mousemove', handleMove);\r\n      canvas.removeEventListener('click', handleClick);\r\n      canvas.removeEventListener('mouseleave', handleLeave);\r\n    };\r\n  }, [tool, zoom, offset]);\r\n  //#endregion\r\n\r\n  //#region ‚å® Keyboard Shortcuts\r\n  useEffect(() => {\r\n    const handler = (e: KeyboardEvent) => {\r\n      if (e.ctrlKey && e.key === 'z') history.undo();\r\n      if (e.ctrlKey && e.shiftKey && e.key === 'Z') history.redo();\r\n      if (e.key === 'c') setTool('crop');\r\n      if (e.key === 'h') setTool('pan');\r\n      if (e.key === 'r') rotate(90, canvasRef, overlayRef, history.history);\r\n      if (e.key === 'p') setTool('color');\r\n      if (e.key === 'b') setTool('draw');\r\n    };\r\n    window.addEventListener('keydown', handler);\r\n    return () => window.removeEventListener('keydown', handler);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [history.index, history.history]);\r\n  //#endregion\r\n\r\n  // Quick hand tool when holding Spaceb\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.code === 'Space') {\r\n        e.preventDefault(); // stop page scroll\r\n\r\n        setIsSpaceDown((prev) => {\r\n          if (!prev) {\r\n            // first press\r\n            setToolBefore((t) => {\r\n              // store previous tool safely\r\n              if (t === null) return tool;\r\n              return t;\r\n            });\r\n            setTool('pan');\r\n          }\r\n          return true;\r\n        });\r\n      } else if (e.code === 'AltLeft' && tool === 'draw') {\r\n        e.preventDefault();\r\n\r\n        setIsAltDown((prev) => {\r\n          if (!prev) {\r\n            // first press\r\n            setToolBefore((t) => {\r\n              // store previous tool safely\r\n              if (t === null) return tool;\r\n              return t;\r\n            });\r\n            setTool('color');\r\n          }\r\n          return true;\r\n        });\r\n      }\r\n    };\r\n\r\n    const handleKeyUp = (e: KeyboardEvent) => {\r\n      if (e.code === 'Space') {\r\n        setIsSpaceDown(false);\r\n\r\n        setToolBefore((prev) => {\r\n          if (prev) {\r\n            setTool(prev); // restore tool\r\n          }\r\n          return null; // clear buffer\r\n        });\r\n      } else if (e.code === 'AltLeft' && toolBefore === 'draw') {\r\n        setIsAltDown(false);\r\n        setToolBefore((prev) => {\r\n          if (prev) {\r\n            setTool(prev); // restore tool\r\n          }\r\n          return null; // clear buffer\r\n        });\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown, { passive: false });\r\n    window.addEventListener('keyup', handleKeyUp);\r\n\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n      window.removeEventListener('keyup', handleKeyUp);\r\n    };\r\n  }, [tool]);\r\n  //#endregion\r\n\r\n  // #region üìê Perspective Transform Apply\r\n  const perspectiveApply = async () => {\r\n    if (!canvasRef.current || !perspectivePoints.current) return;\r\n    const src = canvasRef.current;\r\n    // dest dims: bounding rect\r\n    const destW = src.width;\r\n    const destH = src.height;\r\n    const dest = perspectiveTransform(src, perspectivePoints.current, destW, destH);\r\n    canvasRef.current.width = dest.width;\r\n    canvasRef.current.height = dest.height;\r\n    overlayRef.current!.width = dest.width;\r\n    overlayRef.current!.height = dest.height;\r\n    canvasRef.current.getContext('2d')!.clearRect(0, 0, dest.width, dest.height);\r\n    canvasRef.current.getContext('2d')!.drawImage(dest, 0, 0);\r\n    history.push(canvasRef.current.toDataURL(), 'Perspective corrected');\r\n    setShowPerspectiveModal(false);\r\n  };\r\n  //#endregion\r\n  //#endregion\r\n\r\n  //#region Cursor Style\r\n  const currentCursor = useMemo(() => {\r\n    if ((tool === 'pan' || tool === 'select') && isPanning) return 'grabbing';\r\n    switch (tool) {\r\n      case 'pan':\r\n        return 'grab';\r\n      case 'crop':\r\n      case 'ruler':\r\n      case 'perspective':\r\n        return 'crosshair';\r\n      case 'color':\r\n        return 'copy';\r\n      case 'draw':\r\n        return 'pointer';\r\n      default:\r\n        return 'default';\r\n    }\r\n  }, [tool, isPanning]);\r\n  //#endregion\r\n\r\n  return (\r\n    <div style={{ display: 'flex', gap: 12 }}>\r\n      <ImageEditorToolbar\r\n        canvasRef={canvasRef}\r\n        overlayRef={overlayRef}\r\n        baseCanvas={baseCanvas}\r\n        history={history}\r\n        drawColor={drawColor}\r\n        setDrawColor={setDrawColor}\r\n        drawLineWidth={drawLineWidth}\r\n        setDrawLineWidth={setDrawLineWidth}\r\n        brushType={brushType}\r\n        setBrushType={setBrushType}\r\n        brushOpacity={brushOpacity}\r\n        setBrushOpacity={setBrushOpacity}\r\n        brushFlow={brushFlow}\r\n        setBrushFlow={setBrushFlow}\r\n        setTool={setTool}\r\n        // Exposure & Color\r\n        brightness={brightness}\r\n        setBrightness={setBrightness}\r\n        contrast={contrast}\r\n        setContrast={setContrast}\r\n        highlights={highlights}\r\n        setHighlights={setHighlights}\r\n        shadows={shadows}\r\n        setShadows={setShadows}\r\n        whites={whites}\r\n        setWhites={setWhites}\r\n        blacks={blacks}\r\n        setBlacks={setBlacks}\r\n        vibrance={vibrance}\r\n        setVibrance={setVibrance}\r\n        saturation={saturation}\r\n        setSaturation={setSaturation}\r\n        dehaze={dehaze}\r\n        setDehaze={setDehaze}\r\n        // Blur / Convolution\r\n        blur={blur}\r\n        setBlur={setBlur}\r\n        gaussian={gaussian}\r\n        setGaussian={setGaussian}\r\n        sharpen={sharpen}\r\n        setSharpen={setSharpen}\r\n        texture={texture}\r\n        setTexture={setTexture}\r\n        clarity={clarity}\r\n        setClarity={setClarity}\r\n        // Background removal\r\n        bgThreshold={bgThreshold}\r\n        setBgThreshold={setBgThreshold}\r\n        bgThresholdBlack={bgThresholdBlack}\r\n        setBgThresholdBlack={setBgThresholdBlack}\r\n        // Color mix (HSL)\r\n        hslAdjustments={hslAdjustments}\r\n        setHslAdjustments={setHslAdjustments}\r\n        setShowPerspectiveModal={setShowPerspectiveModal}\r\n        dpiMeasured={dpiMeasured}\r\n        setDpiMeasured={setDpiMeasured}\r\n        exportImage={exportImage}\r\n        onExport={onExport}\r\n      />\r\n\r\n      <div style={{ flex: 1 }}>\r\n        <div style={{ marginBottom: 8 }}>\r\n          <Space>\r\n            <Select\r\n              style={{ width: 150 }}\r\n              placeholder=\"History\"\r\n              value={history.index}\r\n              onChange={(idx) => history.applyHistory(idx)}\r\n              optionLabelProp=\"label\"\r\n            >\r\n              {history.history.map((item, idx) => (\r\n                <Select.Option key={idx} value={idx} label={item.label || `Step ${idx + 1}`}>\r\n                  <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                    <img\r\n                      src={item.url}\r\n                      alt=\"\"\r\n                      style={{\r\n                        width: 40,\r\n                        height: 30,\r\n                        objectFit: 'contain',\r\n                        border: '1px solid #ddd',\r\n                      }}\r\n                    />\r\n                    <span>{item.label || `Step ${idx + 1}`}</span>\r\n                  </div>\r\n                </Select.Option>\r\n              ))}\r\n            </Select>\r\n\r\n            <Tooltip title=\"Zoom In\">\r\n              <Button\r\n                icon={<ZoomInOutlined />}\r\n                onClick={() => setZoom((z) => Math.min(z * 1.2, 8))}\r\n              />\r\n            </Tooltip>\r\n            <Tooltip title=\"Zoom Out\">\r\n              <Button\r\n                icon={<ZoomOutOutlined />}\r\n                onClick={() => setZoom((z) => Math.max(z / 1.2, 0.1))}\r\n              />\r\n            </Tooltip>\r\n            <Select value={tool} onChange={(v) => setTool(v as Tool)} style={{ width: 140 }}>\r\n              <Option value=\"pan\">Pan</Option>\r\n              <Option value=\"color\">Color Picker</Option>\r\n              <Option value=\"crop\">Crop</Option>\r\n              <Option value=\"ruler\">Ruler</Option>\r\n              <Option value=\"perspective\">Perspective</Option>\r\n              <Option value=\"draw\">Brush</Option>\r\n            </Select>\r\n            <Space style={{ width: '100%' }} wrap>\r\n              {/* Brush Type */}\r\n              <Select\r\n                value={brushType}\r\n                onChange={(v) => setBrushType(v as 'hard' | 'soft')}\r\n                style={{ width: 80 }}\r\n              >\r\n                <Option value=\"hard\">Hard</Option>\r\n                <Option value=\"soft\">Soft</Option>\r\n              </Select>\r\n              {/* Color Picker */}\r\n              <ColorPicker value={drawColor} onChange={(c) => setDrawColor(c.toHexString())} />\r\n\r\n              {/* Brush Size */}\r\n              <InputNumber\r\n                style={{ width: 100 }}\r\n                min={1}\r\n                max={500}\r\n                value={drawLineWidth}\r\n                onChange={(v) => setDrawLineWidth(v || 1)}\r\n                addonAfter=\"px\"\r\n              />\r\n\r\n              {/* Brush Opacity */}\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                <span\r\n                  onMouseDown={handleOpacityLabelMouseDown}\r\n                  style={{ cursor: 'ew-resize', userSelect: 'none' }}\r\n                  title=\"Drag left/right to change opacity\"\r\n                >\r\n                  Opacity:\r\n                </span>\r\n                <InputNumber\r\n                  min={0}\r\n                  max={1}\r\n                  step={0.01}\r\n                  style={{ width: 60 }}\r\n                  value={brushOpacity}\r\n                  onChange={(v) => setBrushOpacity(v || 0)}\r\n                />\r\n              </div>\r\n\r\n              {/* Brush Flow */}\r\n              <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n                <span\r\n                  onMouseDown={handleFlowLabelMouseDown}\r\n                  style={{ cursor: 'ew-resize', userSelect: 'none' }}\r\n                  title=\"Drag left/right to change flow\"\r\n                >\r\n                  Flow:\r\n                </span>\r\n                <InputNumber\r\n                  min={0}\r\n                  max={1}\r\n                  step={0.01}\r\n                  style={{ width: 60 }}\r\n                  value={brushFlow}\r\n                  onChange={(v) => setBrushFlow(v || 0)}\r\n                />\r\n              </div>\r\n            </Space>\r\n          </Space>\r\n        </div>\r\n\r\n        <ImageCanvas\r\n          canvasRef={canvasRef}\r\n          overlayRef={overlayRef}\r\n          containerRef={containerRef}\r\n          offset={offset}\r\n          zoom={zoom}\r\n          tool={tool}\r\n          currentCursor={currentCursor}\r\n          hoverColor={hoverColor}\r\n          onMouseDown={handleMouseDownViewer}\r\n          onMouseMove={handleMouseMoveViewer}\r\n          onMouseUp={handleMouseUpViewer}\r\n        />\r\n      </div>\r\n\r\n      <Modal\r\n        title=\"Perspective correction\"\r\n        open={showPerspectiveModal}\r\n        onOk={() => perspectiveApply()}\r\n        onCancel={() => setShowPerspectiveModal(false)}\r\n        okText=\"Apply\"\r\n      >\r\n        <p>Click four points on the image (clockwise) to define the corners, then Apply.</p>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageEditor;\r\n","import { useEffect, useRef, useState } from 'react';\r\nimport { createCanvas, drawImageToCanvasFromUrl } from '../utils/ImageEditorEngine';\r\nimport { message } from 'antd';\r\n\r\nexport default function useCanvas(imageUrl: string, onLoad?: (dataUrl: string) => void) {\r\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n  const overlayRef = useRef<HTMLCanvasElement | null>(null);\r\n\r\n  const [baseCanvas, setBaseCanvas] = useState<HTMLCanvasElement | null>(null);\r\n\r\n  // Load image once\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const c = await drawImageToCanvasFromUrl(imageUrl);\r\n        setBaseCanvas(c);\r\n\r\n        const working = createCanvas(c.width, c.height);\r\n        working.getContext('2d')!.drawImage(c, 0, 0);\r\n\r\n        if (canvasRef.current) {\r\n          canvasRef.current.width = working.width;\r\n          canvasRef.current.height = working.height;\r\n          const ctx = canvasRef.current.getContext('2d')!;\r\n          ctx.clearRect(0, 0, working.width, working.height);\r\n          ctx.drawImage(working, 0, 0);\r\n        }\r\n\r\n        if (onLoad) onLoad(canvasToDataUrl(working));\r\n      } catch (err) {\r\n        console.error('Failed to load image', err);\r\n        message.error('Failed to load image');\r\n      }\r\n    })();\r\n  }, [imageUrl]);\r\n\r\n  // Resize overlay when baseCanvas is ready\r\n  useEffect(() => {\r\n    syncCanvasSize();\r\n  }, [baseCanvas]);\r\n\r\n  /** Convert canvas ‚Üí dataURL */\r\n  const canvasToDataUrl = (c: HTMLCanvasElement) => c.toDataURL('image/png');\r\n\r\n  /** Sync canvas & overlay sizes */\r\n  const syncCanvasSize = () => {\r\n    if (!canvasRef.current || !baseCanvas) return;\r\n\r\n    canvasRef.current.width = baseCanvas.width;\r\n    canvasRef.current.height = baseCanvas.height;\r\n    overlayRef.current!.width = baseCanvas.width;\r\n    overlayRef.current!.height = baseCanvas.height;\r\n\r\n    const ctx = canvasRef.current.getContext('2d')!;\r\n    ctx.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\r\n    ctx.drawImage(baseCanvas, 0, 0);\r\n  };\r\n\r\n  return { canvasRef, overlayRef, baseCanvas, syncCanvasSize };\r\n}\r\n","import { MutableRefObject, useState } from 'react';\r\n\r\ntype HistoryItem = {\r\n  url: string;\r\n  label?: string;\r\n};\r\n\r\nexport default function useHistory(\r\n  canvasRef: MutableRefObject<HTMLCanvasElement | null>,\r\n  overlayRef: MutableRefObject<HTMLCanvasElement | null>,\r\n) {\r\n  const [history, setHistory] = useState<HistoryItem[]>([]);\r\n  const [index, setIndex] = useState(-1);\r\n\r\n  const current = history[index];\r\n\r\n  //\r\n  /** History management */\r\n  const push = (url: string, label = '') => {\r\n    const next = history.slice(0, index + 1);\r\n    next.push({ url, label });\r\n    setHistory(next);\r\n    setIndex(next.length - 1);\r\n  };\r\n  const undo = () => {\r\n    if (index <= 0) return;\r\n    applyHistory(index - 1);\r\n  };\r\n  const redo = () => {\r\n    if (index >= history.length - 1) return;\r\n    applyHistory(index + 1);\r\n  };\r\n\r\n  const applyHistory = (idx: number) => {\r\n    const item = history[idx];\r\n    if (!item) return;\r\n\r\n    const img = new Image();\r\n    img.onload = () => {\r\n      const ctx = canvasRef.current!.getContext('2d')!;\r\n      canvasRef.current!.width = img.naturalWidth;\r\n      canvasRef.current!.height = img.naturalHeight;\r\n      overlayRef.current!.width = img.naturalWidth;\r\n      overlayRef.current!.height = img.naturalHeight;\r\n\r\n      ctx.clearRect(0, 0, canvasRef.current!.width, canvasRef.current!.height);\r\n      ctx.drawImage(img, 0, 0);\r\n      setIndex(idx);\r\n    };\r\n    img.src = item.url;\r\n  };\r\n\r\n  return { history, index, current, push, undo, redo, applyHistory };\r\n}\r\n","import DragDropWrapper from '@/components/DragDropWrapper';\r\nimport DragOverlay from '@/components/DragOverlay';\r\nimport { handleCopy } from '@/helpers';\r\nimport {\r\n  CopyOutlined,\r\n  DownloadOutlined,\r\n  InfoCircleOutlined,\r\n  LoadingOutlined,\r\n  UploadOutlined,\r\n} from '@ant-design/icons';\r\nimport {\r\n  Button,\r\n  Card,\r\n  InputNumber,\r\n  Space,\r\n  Spin,\r\n  Tabs,\r\n  Tag,\r\n  Tooltip,\r\n  Typography,\r\n  Upload,\r\n  message,\r\n} from 'antd';\r\nimport ImageTracer from 'imagetracerjs';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport ImageEditor from './components/ImageEditor';\r\nimport './styles.less';\r\n\r\nconst { Title } = Typography;\r\nconst { TabPane } = Tabs;\r\n\r\nconst PNGJPEG: React.FC = () => {\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [preview, setPreview] = useState<string | null>(null);\r\n  const [svgContent, setSvgContent] = useState<string | null>(null);\r\n  const [dragging, setDragging] = useState(false);\r\n  const [processing, setProcessing] = useState(false);\r\n\r\n  const dragCounter = useRef(0);\r\n\r\n  // Tracing options\r\n  const [scale, setScale] = useState(1);\r\n  const [ltres, setLtres] = useState(1);\r\n  const [qtres, setQtres] = useState(1);\r\n  const [pathomit, setPathomit] = useState(8);\r\n  const [colorsampling, setColorsampling] = useState(2);\r\n  const [strokewidth, setStrokewidth] = useState(1);\r\n\r\n  // --- Clipboard paste support ---\r\n  useEffect(() => {\r\n    const handlePaste = (e: ClipboardEvent) => {\r\n      const items = e.clipboardData?.items;\r\n      if (!items) return;\r\n\r\n      const imageItem = Array.from(items).find((item) => item.type.includes('image'));\r\n      if (imageItem) {\r\n        const blob = imageItem.getAsFile();\r\n        if (blob) {\r\n          handleUpload(blob);\r\n          message.success('Image pasted from clipboard!');\r\n          e.preventDefault();\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('paste', handlePaste);\r\n    return () => window.removeEventListener('paste', handlePaste);\r\n  }, []);\r\n\r\n  const handleUpload = (file: File) => {\r\n    setFile(file);\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => setPreview(e.target?.result as string);\r\n    reader.readAsDataURL(file);\r\n    setDragging(false);\r\n    dragCounter.current = 0;\r\n    return false;\r\n  };\r\n\r\n  const handleConvert = () => {\r\n    if (!preview) {\r\n      message.error('Please upload an image first.');\r\n      return;\r\n    }\r\n\r\n    setProcessing(true); // üëà start loading animation\r\n    try {\r\n      ImageTracer.imageToSVG(\r\n        preview,\r\n        (svgString) => {\r\n          setSvgContent(svgString);\r\n          setProcessing(false); // üëà stop loading\r\n          message.success('Image converted to SVG successfully!');\r\n        },\r\n        { scale, ltres, qtres, pathomit, colorsampling, strokewidth },\r\n      );\r\n    } catch (err: any) {\r\n      console.error(err);\r\n      setProcessing(false); // üëà stop loading on error\r\n      message.error('Error converting image to SVG.');\r\n    }\r\n  };\r\n\r\n  const handleDownload = (content: string, filename: string) => {\r\n    const blob = new Blob([content], { type: 'image/svg+xml' });\r\n    const link = document.createElement('a');\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = filename;\r\n    link.click();\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setFile(null);\r\n    setPreview(null);\r\n    setSvgContent(null);\r\n    message.info('Image and SVG cleared.');\r\n  };\r\n\r\n  // Generate Base64 and Data URI\r\n  const svgBase64 = svgContent ? btoa(unescape(encodeURIComponent(svgContent))) : '';\r\n  const svgDataURI = svgContent ? `data:image/svg+xml;base64,${svgBase64}` : '';\r\n\r\n  return (\r\n    <DragDropWrapper\r\n      setDragging={setDragging}\r\n      dragCounter={dragCounter}\r\n      handleUpload={handleUpload}\r\n    >\r\n      <Card\r\n        title={\r\n          <>\r\n            üñºÔ∏è PNG / JPEG Viewer <Tag color=\"cyan\">Beta</Tag>\r\n          </>\r\n        }\r\n        variant={'borderless'}\r\n      >\r\n        <Space direction=\"vertical\" style={{ width: '100%' }} size=\"large\">\r\n          {!dragging && (\r\n            <Upload beforeUpload={handleUpload} showUploadList={false} accept=\".png,.jpg,.jpeg\">\r\n              <Button icon={<UploadOutlined />}>Upload Image (PNG/JPG)</Button>\r\n            </Upload>\r\n          )}\r\n\r\n          {dragging && <DragOverlay />}\r\n\r\n          {/* Preview */}\r\n          {preview && (\r\n            <div>\r\n              <Title level={5}>Preview & Editor:</Title>\r\n              <ImageEditor\r\n                imageUrl={preview}\r\n                onExport={(blob) => {\r\n                  // optional: show download link or handle upload\r\n                  console.log('exported blob', blob);\r\n                }}\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* === PROCESSING OVERLAY === */}\r\n          {processing && (\r\n            <div\r\n              style={{\r\n                position: 'fixed',\r\n                top: 0,\r\n                left: 0,\r\n                width: '100%',\r\n                height: '100%',\r\n                background: 'rgba(255, 255, 255, 0.7)',\r\n                zIndex: 10000,\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n                flexDirection: 'column',\r\n              }}\r\n            >\r\n              <Spin\r\n                indicator={<LoadingOutlined style={{ fontSize: 48, color: '#1890ff' }} spin />}\r\n                tip=\"Converting image to SVG...\"\r\n                size=\"large\"\r\n              />\r\n            </div>\r\n          )}\r\n\r\n          {/* Tracing Options */}\r\n          <Card size=\"small\" title=\"Tracing Options (Adjust before converting)\">\r\n            <Space wrap size={'large'}>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Scale factor for the SVG output. Higher = larger SVG.\">\r\n                  <label>\r\n                    Scale <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber\r\n                  min={0.1}\r\n                  step={0.1}\r\n                  value={scale}\r\n                  onChange={(val) => setScale(val || 1)}\r\n                />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Error threshold for line detection. Lower = more precise lines.\">\r\n                  <label>\r\n                    ltres <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber min={0} value={ltres} onChange={(val) => setLtres(val || 1)} />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Error threshold for curve detection. Lower = more precise curves.\">\r\n                  <label>\r\n                    qtres <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber min={0} value={qtres} onChange={(val) => setQtres(val || 1)} />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Minimum path length to keep. Higher = simpler SVG with fewer tiny paths.\">\r\n                  <label>\r\n                    Pathomit <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber min={0} value={pathomit} onChange={(val) => setPathomit(val || 0)} />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Pixel sampling interval for colors. 1 = every pixel, higher = faster but less accurate colors.\">\r\n                  <label>\r\n                    ColorSampling <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber\r\n                  min={1}\r\n                  value={colorsampling}\r\n                  onChange={(val) => setColorsampling(val || 1)}\r\n                />\r\n              </Space>\r\n              <Space size={'small'}>\r\n                <Tooltip title=\"Stroke width in the output SVG.\">\r\n                  <label>\r\n                    StrokeWidth <InfoCircleOutlined style={{ marginLeft: 4 }} />\r\n                  </label>\r\n                </Tooltip>\r\n                <InputNumber\r\n                  min={0}\r\n                  value={strokewidth}\r\n                  onChange={(val) => setStrokewidth(val || 1)}\r\n                />\r\n              </Space>\r\n            </Space>\r\n          </Card>\r\n\r\n          {/* Action Buttons */}\r\n          <Space>\r\n            <Button type=\"primary\" onClick={handleConvert} disabled={!file}>\r\n              Convert to SVG\r\n            </Button>\r\n            <Button onClick={handleClear} danger disabled={!file && !svgContent}>\r\n              Clear Image\r\n            </Button>\r\n          </Space>\r\n\r\n          {/* Tabs for SVG formats */}\r\n          {svgContent && (\r\n            <Tabs defaultActiveKey=\"svg\" type=\"card\" style={{ marginTop: 16 }}>\r\n              <TabPane tab=\"SVG\" key=\"svg\">\r\n                <Space style={{ marginBottom: 8 }}>\r\n                  <Button\r\n                    onClick={() => handleDownload(svgContent, 'image.svg')}\r\n                    icon={<DownloadOutlined />}\r\n                  >\r\n                    Download\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleCopy(svgContent, 'SVG copied!')}\r\n                    icon={<CopyOutlined />}\r\n                  >\r\n                    Copy\r\n                  </Button>\r\n                </Space>\r\n                <div\r\n                  style={{\r\n                    border: '1px solid #eee',\r\n                    borderRadius: 6,\r\n                    padding: 12,\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  <div dangerouslySetInnerHTML={{ __html: svgContent }} />\r\n                </div>\r\n              </TabPane>\r\n\r\n              <TabPane tab=\"Base64\" key=\"base64\">\r\n                <Space style={{ marginBottom: 8 }}>\r\n                  <Button\r\n                    onClick={() => handleCopy(svgBase64, 'Base64 copied!')}\r\n                    icon={<CopyOutlined />}\r\n                  >\r\n                    Copy Base64\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleDownload(svgBase64, 'image-base64.txt')}\r\n                    icon={<DownloadOutlined />}\r\n                  >\r\n                    Download Base64\r\n                  </Button>\r\n                </Space>\r\n                <pre\r\n                  style={{\r\n                    background: '#f7f7f7',\r\n                    padding: 12,\r\n                    borderRadius: 6,\r\n                    whiteSpace: 'pre-wrap',\r\n                    wordBreak: 'break-word',\r\n                    maxHeight: 300,\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  {svgBase64}\r\n                </pre>\r\n              </TabPane>\r\n\r\n              <TabPane tab=\"Data URI\" key=\"datauri\">\r\n                <Space style={{ marginBottom: 8 }}>\r\n                  <Button\r\n                    onClick={() => handleCopy(svgDataURI, 'Data URI copied!')}\r\n                    icon={<CopyOutlined />}\r\n                  >\r\n                    Copy Data URI\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleDownload(svgDataURI, 'image-datauri.txt')}\r\n                    icon={<DownloadOutlined />}\r\n                  >\r\n                    Download Data URI\r\n                  </Button>\r\n                </Space>\r\n                <pre\r\n                  style={{\r\n                    background: '#f7f7f7',\r\n                    padding: 12,\r\n                    borderRadius: 6,\r\n                    whiteSpace: 'pre-wrap',\r\n                    wordBreak: 'break-word',\r\n                    maxHeight: 300,\r\n                    overflow: 'auto',\r\n                  }}\r\n                >\r\n                  {svgDataURI}\r\n                </pre>\r\n              </TabPane>\r\n            </Tabs>\r\n          )}\r\n        </Space>\r\n      </Card>\r\n    </DragDropWrapper>\r\n  );\r\n};\r\n\r\nexport default PNGJPEG;\r\n"],"names":[],"mappings":"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"}