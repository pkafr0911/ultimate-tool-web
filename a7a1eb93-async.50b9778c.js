(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ultimate-tool-web"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ultimate-tool-web"]||[]).push([["a7a1eb93"],{"0fbef1c3":function(e,l,r){"use strict";let t;r.d(l,"__esModule",{value:!0}),r.d(l,"default",{enumerable:!0,get:function(){return k;}});var s=r("777fffbe"),o=r("1a7c85b4"),c=s._(r("b2a1469e")),a=s._(r("e9bcd22d")),n=s._(r("95eb3634")),i=s._(r("6effc0fd")),d=r("d322be42");let{Title:u,Text:h}=i.default,f=e=>e.map(e=>e.map(e=>e?{...e}:null)),p=(e,l)=>e>=0&&e<8&&l>=0&&l<8,m=e=>"w"===e?"b":"w",x=(t=0,()=>`p_${++t}`),j=()=>{let e=Array.from({length:8},()=>Array(8).fill(null)),l=["R","N","B","Q","K","B","N","R"];for(let r=0;r<8;r++)e[0][r]={type:l[r],color:"b",id:x()},e[1][r]={type:"P",color:"b",id:x()},e[6][r]={type:"P",color:"w",id:x()},e[7][r]={type:l[r],color:"w",id:x()};return e;},y=(e,l)=>{var r;for(let t=0;t<8;t++)for(let s=0;s<8;s++)if((null===(r=e[t][s])||void 0===r?void 0:r.type)==="K"&&e[t][s].color===l)return{r:t,c:s};return null;},v=(e,l,r)=>{let t=e[l][r];if(!t)return[];let s=[],o=t.color,c=(l,r)=>{if(!p(l,r))return;let t=e[l][r];t&&t.color===o||s.push({r:l,c:r});};if("P"===t.type){let t="w"===o?-1:1;for(let c of(p(l+t,r)&&!e[l+t][r]&&s.push({r:l+t,c:r}),l!==("w"===o?6:1)||e[l+t][r]||e[l+2*t][r]||s.push({r:l+2*t,c:r}),[-1,1])){let a=l+t,n=r+c;p(a,n)&&e[a][n]&&e[a][n].color!==o&&s.push({r:a,c:n});}}if("N"===t.type)for(let[e,t]of[[2,1],[2,-1],[-2,1],[-2,-1],[1,2],[1,-2],[-1,2],[-1,-2]])c(l+e,r+t);if("B"===t.type||"R"===t.type||"Q"===t.type){let c=[];for(let[a,n]of(("B"===t.type||"Q"===t.type)&&c.push([1,1],[1,-1],[-1,1],[-1,-1]),("R"===t.type||"Q"===t.type)&&c.push([1,0],[-1,0],[0,1],[0,-1]),c)){let t=l+a,c=r+n;for(;p(t,c);){if(e[t][c]){e[t][c].color!==o&&s.push({r:t,c:c});break;}s.push({r:t,c:c}),t+=a,c+=n;}}}if("K"===t.type)for(let e=-1;e<=1;e++)for(let t=-1;t<=1;t++)(0!==e||0!==t)&&c(l+e,r+t);return s;},N=(e,l,r)=>{for(let t=0;t<8;t++)for(let s=0;s<8;s++){let o=e[t][s];if(o&&o.color===r&&v(e,t,s).some(e=>e.r===l.r&&e.c===l.c))return!0;}return!1;},g=(e,l)=>{let r=[];for(let t=0;t<8;t++)for(let s=0;s<8;s++){let o=e[t][s];if(o&&o.color===l)for(let c of v(e,t,s)){let a=f(e),n=a[t][s],i=a[c.r][c.c];a[c.r][c.c]=n,a[t][s]=null;let d=null;"P"===n.type&&(0===c.r||7===c.r)&&(a[c.r][c.c]={type:"Q",color:n.color,id:x()},d="Q");let u=y(a,l);!u||N(a,u,m(l))||r.push({from:{r:t,c:s},to:c,piece:o,captured:i??null,promotion:d});}}return r;},b=(e,l)=>{let r=f(e),t=r[l.from.r][l.from.c];return l.promotion?r[l.to.r][l.to.c]={type:l.promotion,color:t.color,id:x()}:r[l.to.r][l.to.c]={...t},r[l.from.r][l.from.c]=null,r;},w=e=>`${"abcdefgh"[e.c]}${8-e.r}`;function k(){let[e,l]=(0,d.useState)(()=>j()),[r,t]=(0,d.useState)("w"),[s,i]=(0,d.useState)(null),[p,x]=(0,d.useState)([]),[v,k]=(0,d.useState)([]),C=(0,d.useRef)([]),$=(0,d.useRef)([]),[R,_]=(0,d.useState)("white");(0,d.useEffect)(()=>{if(!s)return x([]);let l=e[s.r][s.c];if(!l||l.color!==r)return x([]);x(g(e,r).filter(e=>e.from.r===s.r&&e.from.c===s.c).map(e=>e.to));},[s,e,r]);let z=(o,c)=>{let a=e[o][c];if(a&&a.color===r){i({r:o,c});return;}let n=p.some(e=>e.r===o&&e.c===c);if(s&&n){let a=g(e,r).find(e=>e.from.r===s.r&&e.from.c===s.c&&e.to.r===o&&e.to.c===c);if(!a)return;l(b(e,a)),t(m(r)),i(null),C.current.push(a),k([...C.current]),$.current=[],x([]);}else i(null),x([]);},Q=(0,d.useMemo)(()=>{let l=y(e,r),t=!!l&&N(e,l,m(r)),s=g(e,r);return t&&0===s.length?{status:"checkmate",inCheck:t}:t||0!==s.length?{status:"playing",inCheck:t}:{status:"stalemate",inCheck:t};},[e,r]),S=e=>{let l={K:"\u2654",Q:"\u2655",R:"\u2656",B:"\u2657",N:"\u2658",P:"\u2659"}[e.type];return"w"===e.color?l:l.replace("\u2654","\u265A").replace("\u2655","\u265B").replace("\u2656","\u265C").replace("\u2657","\u265D").replace("\u2658","\u265E").replace("\u2659","\u265F");};return(0,o.jsxs)("div",{className:"chess-page",children:[(0,o.jsxs)("div",{className:"chess-header",children:[(0,o.jsx)(u,{level:4,children:"Chess"}),(0,o.jsxs)("div",{className:"chess-controls",children:[(0,o.jsxs)(h,{className:"chess-turn",children:["Turn: ",(0,o.jsx)("strong",{children:"w"===r?"White":"Black"}),Q.inCheck&&(0,o.jsx)(h,{type:"danger",className:"ml-8",children:"(Check)"})]}),(0,o.jsx)(c.default,{size:"small",onClick:()=>_(e=>"white"===e?"black":"white"),children:"Flip"}),(0,o.jsx)(c.default,{size:"small",onClick:()=>{l(j()),t("w"),i(null),C.current=[],$.current=[],k([]);},children:"Restart"}),(0,o.jsx)(c.default,{size:"small",onClick:()=>{let e=C.current;if(!e.length)return;let r=e.pop(),s=j();for(let l of e){let e=b(s,l);for(let l=0;l<8;l++)for(let r=0;r<8;r++)s[l][r]=e[l][r];}$.current.push(r),l(f(s)),k([...e]),t(e=>m(e)),i(null);},children:"Undo"}),(0,o.jsx)(c.default,{size:"small",onClick:()=>{let r=$.current;if(!r.length)return;let s=r.pop();C.current.push(s),l(b(e,s)),k([...C.current]),t(e=>m(e)),i(null);},children:"Redo"}),(0,o.jsx)(c.default,{size:"small",onClick:()=>{let l=g(e,r);if(!l.length)return alert("No legal moves");let t=l[0];alert(`Try: ${w(t.from)} \u{2192} ${w(t.to)}`);},children:"Hint"})]})]}),(0,o.jsxs)("div",{className:"chess-content",children:[(0,o.jsxs)("div",{className:"chess-board-wrapper",children:[(0,o.jsx)("div",{className:"chess-coordinates top",children:["a","b","c","d","e","f","g","h"].map(e=>(0,o.jsx)("div",{className:"coord",children:e},e))}),(0,o.jsxs)("div",{className:"chess-row-with-coords",children:[(0,o.jsx)("div",{className:"chess-coordinates side",children:[8,7,6,5,4,3,2,1].map(e=>(0,o.jsx)("div",{className:"coord",children:e},e))}),(0,o.jsx)("div",{className:"chess-board",children:Array.from({length:8}).map((l,r)=>{let t="white"===R?r:7-r;return(0,o.jsx)("div",{className:"chess-row",children:Array.from({length:8}).map((l,r)=>{let c="white"===R?r:7-r,a=e[t][c],n=s&&s.r===t&&s.c===c,i=p.some(e=>e.r===t&&e.c===c),d=(t+c)%2==1;return(0,o.jsxs)("div",{className:`chess-square ${d?"dark":"light"} ${n?"selected":""}`,onClick:()=>z(t,c),children:[a&&(0,o.jsx)("span",{className:"chess-piece",children:S(a)}),i&&(0,o.jsx)("div",{className:"move-dot"})]},`${t}-${c}`);})},t);})})]}),(0,o.jsx)("div",{className:"chess-coordinates bottom",children:["a","b","c","d","e","f","g","h"].map(e=>(0,o.jsx)("div",{className:"coord",children:e},e))})]}),(0,o.jsxs)(a.default,{className:"move-history",title:"Move History",size:"small",children:[0===v.length?(0,o.jsx)(h,{type:"secondary",children:"No moves yet"}):(0,o.jsx)(n.default,{size:"small",bordered:!0,dataSource:v,renderItem:e=>(0,o.jsxs)(n.default.Item,{children:[w(e.from)," \u2192 ",w(e.to),e.captured?` \xd7 ${e.captured.type}`:"",e.promotion?` (=${e.promotion})`:""]})}),(0,o.jsx)("div",{className:"move-status",children:(0,o.jsxs)(h,{children:["Status: ",(0,o.jsx)("strong",{children:Q.status})]})})]})]}),(0,o.jsxs)(a.default,{size:"small",className:"chess-notes",children:[(0,o.jsx)(h,{strong:!0,children:"Notes:"}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Local two-player game (alternate turns)."}),(0,o.jsx)("li",{children:"Auto-promotion to Queen when pawn reaches last rank."}),(0,o.jsx)("li",{children:"Castling and en-passant are not supported in this version."}),(0,o.jsx)("li",{children:"If you'd like AI opponent, castling, or en-passant, tell me and I\u2019ll add them."})]})]})]});}}}]);
//# sourceMappingURL=a7a1eb93-async.50b9778c.js.map