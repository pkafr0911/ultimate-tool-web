(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["9b232423"],{"0be78c77":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return ed;}});var r=a("777fffbe"),i=a("852bbaa9"),d=a("1a7c85b4"),o=a("b2a1469e"),n=r._(o),s=a("e9bcd22d"),l=r._(s),c=a("cec50f65"),u=r._(c),h=a("ea21718c"),p=r._(h),f=a("6effc0fd"),y=r._(f),w=a("c9d8dc0b"),m=r._(w),b=a("3c9e49cc"),g=a("8b216428"),v=r._(g),J=a("0c32acfb"),S=r._(J),W=a("c923f942"),T=r._(W),H=async(e,t,a)=>{let r=await (0,T.default)(e,t,"sign");return(0,S.default)(e,r),new Uint8Array(await crypto.subtle.sign((0,v.default)(e,r.algorithm),r,a));},k=a("e7fa9173"),x=r._(k),j=a("7f907bd6"),I=a("e48ac8f7"),P=a("45d10e5b"),A=r._(P),C=a("77e4a257"),_=r._(C),E=a("43adda83"),N=r._(E);class O{#e;#t;#a;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#e=e;}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this;}setUnprotectedHeader(e){if(this.#a)throw TypeError("setUnprotectedHeader can only be called once");return this.#a=e,this;}async sign(e,t){let a;if(!this.#t&&!this.#a)throw new j.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,x.default)(this.#t,this.#a))throw new j.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let r={...this.#t,...this.#a},i=(0,_.default)(j.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this.#t,r),d=!0;if(i.has("b64")&&"boolean"!=typeof(d=this.#t.b64))throw new j.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:o}=r;if("string"!=typeof o||!o)throw new j.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,A.default)(o,e,"sign");let n=this.#e;d&&(n=I.encoder.encode((0,b.encode)(n))),a=this.#t?I.encoder.encode((0,b.encode)(JSON.stringify(this.#t))):I.encoder.encode("");let s=(0,I.concat)(a,I.encoder.encode("."),n),l=await (0,N.default)(e,o),c=await H(o,l,s),u={signature:(0,b.encode)(c),payload:""};return d&&(u.payload=I.decoder.decode(n)),this.#a&&(u.header=this.#a),this.#t&&(u.protected=I.decoder.decode(a)),u;}}class F{#r;constructor(e){this.#r=new O(e);}setProtectedHeader(e){return this.#r.setProtectedHeader(e),this;}async sign(e,t){let a=await this.#r.sign(e,t);if(void 0===a.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${a.protected}.${a.payload}.${a.signature}`;}}var U=e=>Math.floor(e.getTime()/1e3);let M=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;var D=e=>{let t;let a=M.exec(e);if(!a||a[4]&&a[1])throw TypeError("Invalid time period format");let r=parseFloat(a[2]);switch(a[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*r);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*r);break;case"day":case"days":case"d":t=Math.round(86400*r);break;case"week":case"weeks":case"w":t=Math.round(604800*r);break;default:t=Math.round(31557600*r);}return"-"===a[1]||"ago"===a[4]?-t:t;},V=a("108b3a85"),$=r._(V);function B(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t;}let L=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,z=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));class q{#e;constructor(e){if(!(0,$.default)(e))throw TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(e);}data(){return I.encoder.encode(JSON.stringify(this.#e));}get iss(){return this.#e.iss;}set iss(e){this.#e.iss=e;}get sub(){return this.#e.sub;}set sub(e){this.#e.sub=e;}get aud(){return this.#e.aud;}set aud(e){this.#e.aud=e;}set jti(e){this.#e.jti=e;}set nbf(e){"number"==typeof e?this.#e.nbf=B("setNotBefore",e):e instanceof Date?this.#e.nbf=B("setNotBefore",U(e)):this.#e.nbf=U(new Date)+D(e);}set exp(e){"number"==typeof e?this.#e.exp=B("setExpirationTime",e):e instanceof Date?this.#e.exp=B("setExpirationTime",U(e)):this.#e.exp=U(new Date)+D(e);}set iat(e){void 0===e?this.#e.iat=U(new Date):e instanceof Date?this.#e.iat=B("setIssuedAt",U(e)):"string"==typeof e?this.#e.iat=B("setIssuedAt",U(new Date)+D(e)):this.#e.iat=B("setIssuedAt",e);}}class G{#t;#i;constructor(e={}){this.#i=new q(e);}setIssuer(e){return this.#i.iss=e,this;}setSubject(e){return this.#i.sub=e,this;}setAudience(e){return this.#i.aud=e,this;}setJti(e){return this.#i.jti=e,this;}setNotBefore(e){return this.#i.nbf=e,this;}setExpirationTime(e){return this.#i.exp=e,this;}setIssuedAt(e){return this.#i.iat=e,this;}setProtectedHeader(e){return this.#t=e,this;}async sign(e,t){var a;let r=new F(this.#i.data());if(r.setProtectedHeader(this.#t),Array.isArray(null===(a=this.#t)||void 0===a?void 0:a.crit)&&this.#t.crit.includes("b64")&&!1===this.#t.b64)throw new j.JWTInvalid("JWTs MUST NOT use unencoded payload");return r.sign(e,t);}}var K=async(e,t,a,r)=>{let i=await (0,T.default)(e,t,"verify");(0,S.default)(e,i);let d=(0,v.default)(e,i.algorithm);try{return await crypto.subtle.verify(d,i,a,r);}catch{return!1;}},Z=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t);};async function Q(e,t,a){let r,i;if(!(0,$.default)(e))throw new j.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new j.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new j.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new j.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new j.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,$.default)(e.header))throw new j.JWSInvalid("JWS Unprotected Header incorrect type");let d={};if(e.protected)try{let t=(0,b.decode)(e.protected);d=JSON.parse(I.decoder.decode(t));}catch{throw new j.JWSInvalid("JWS Protected Header is invalid");}if(!(0,x.default)(d,e.header))throw new j.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let o={...d,...e.header},n=(0,_.default)(j.JWSInvalid,new Map([["b64",!0]]),null==a?void 0:a.crit,d,o),s=!0;if(n.has("b64")&&"boolean"!=typeof(s=d.b64))throw new j.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:l}=o;if("string"!=typeof l||!l)throw new j.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let c=a&&Z("algorithms",a.algorithms);if(c&&!c.has(l))throw new j.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(s){if("string"!=typeof e.payload)throw new j.JWSInvalid("JWS Payload must be a string");}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new j.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let u=!1;"function"==typeof t&&(t=await t(d,e),u=!0),(0,A.default)(l,t,"verify");let h=(0,I.concat)(I.encoder.encode(e.protected??""),I.encoder.encode("."),"string"==typeof e.payload?I.encoder.encode(e.payload):e.payload);try{r=(0,b.decode)(e.signature);}catch{throw new j.JWSInvalid("Failed to base64url decode the signature");}let p=await (0,N.default)(t,l);if(!await K(l,p,r,h))throw new j.JWSSignatureVerificationFailed;if(s)try{i=(0,b.decode)(e.payload);}catch{throw new j.JWSInvalid("Failed to base64url decode the payload");}else i="string"==typeof e.payload?I.encoder.encode(e.payload):e.payload;let f={payload:i};return(void 0!==e.protected&&(f.protectedHeader=d),void 0!==e.header&&(f.unprotectedHeader=e.header),u)?{...f,key:p}:f;}async function R(e,t,a){if(e instanceof Uint8Array&&(e=I.decoder.decode(e)),"string"!=typeof e)throw new j.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:r,1:i,2:d,length:o}=e.split(".");if(3!==o)throw new j.JWSInvalid("Invalid Compact JWS");let n=await Q({payload:i,protected:r,signature:d},t,a),s={payload:n.payload,protectedHeader:n.protectedHeader};return"function"==typeof t?{...s,key:n.key}:s;}async function X(e,t,a){var r;let i=await R(e,t,a);if((null===(r=i.protectedHeader.crit)||void 0===r?void 0:r.includes("b64"))&&!1===i.protectedHeader.b64)throw new j.JWTInvalid("JWTs MUST NOT use unencoded payload");let d={payload:function(e,t,a={}){let r,i;try{r=JSON.parse(I.decoder.decode(t));}catch{}if(!(0,$.default)(r))throw new j.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{typ:d}=a;if(d&&("string"!=typeof e.typ||L(e.typ)!==L(d)))throw new j.JWTClaimValidationFailed('unexpected "typ" JWT header value',r,"typ","check_failed");let{requiredClaims:o=[],issuer:n,subject:s,audience:l,maxTokenAge:c}=a,u=[...o];for(let e of(void 0!==c&&u.push("iat"),void 0!==l&&u.push("aud"),void 0!==s&&u.push("sub"),void 0!==n&&u.push("iss"),new Set(u.reverse())))if(!(e in r))throw new j.JWTClaimValidationFailed(`missing required "${e}" claim`,r,e,"missing");if(n&&!(Array.isArray(n)?n:[n]).includes(r.iss))throw new j.JWTClaimValidationFailed('unexpected "iss" claim value',r,"iss","check_failed");if(s&&r.sub!==s)throw new j.JWTClaimValidationFailed('unexpected "sub" claim value',r,"sub","check_failed");if(l&&!z(r.aud,"string"==typeof l?[l]:l))throw new j.JWTClaimValidationFailed('unexpected "aud" claim value',r,"aud","check_failed");switch(typeof a.clockTolerance){case"string":i=D(a.clockTolerance);break;case"number":i=a.clockTolerance;break;case"undefined":i=0;break;default:throw TypeError("Invalid clockTolerance option type");}let{currentDate:h}=a,p=U(h||new Date);if((void 0!==r.iat||c)&&"number"!=typeof r.iat)throw new j.JWTClaimValidationFailed('"iat" claim must be a number',r,"iat","invalid");if(void 0!==r.nbf){if("number"!=typeof r.nbf)throw new j.JWTClaimValidationFailed('"nbf" claim must be a number',r,"nbf","invalid");if(r.nbf>p+i)throw new j.JWTClaimValidationFailed('"nbf" claim timestamp check failed',r,"nbf","check_failed");}if(void 0!==r.exp){if("number"!=typeof r.exp)throw new j.JWTClaimValidationFailed('"exp" claim must be a number',r,"exp","invalid");if(r.exp<=p-i)throw new j.JWTExpired('"exp" claim timestamp check failed',r,"exp","check_failed");}if(c){let e=p-r.iat;if(e-i>("number"==typeof c?c:D(c)))throw new j.JWTExpired('"iat" claim timestamp check failed (too far in the past)',r,"iat","check_failed");if(e<0-i)throw new j.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',r,"iat","check_failed");}return r;}(i.protectedHeader,i.payload,a),protectedHeader:i.protectedHeader};return"function"==typeof t?{...d,key:i.key}:d;}var Y=a("d322be42"),ee=i._(Y);let{TextArea:et}=u.default,{Title:ea,Paragraph:er,Text:ei}=y.default,ed=()=>{let[e,t]=(0,ee.useState)(""),[a,r]=(0,ee.useState)(""),[i,o]=(0,ee.useState)(""),[s,c]=(0,ee.useState)(""),h=new TextEncoder,f=e=>{let t=e.trim();try{return JSON.parse(t);}catch{try{let e=t.replace(/'/g,'"').replace(/([a-zA-Z0-9_]+):/g,'"$1":');return JSON.parse(e);}catch{throw Error("Invalid JSON payload format.");}}},y=async()=>{try{let t=f(a),r=h.encode(e),i=await new G(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("2h").sign(r);o(i),m.default.success("JWT token created successfully!");}catch(e){m.default.error(e.message||"Error creating JWT.");}},w=async()=>{try{let t=h.encode(e),{payload:a}=await X(i,t);c(JSON.stringify(a,null,2)),m.default.success("Token verified successfully!");}catch(e){m.default.error(`Invalid token: ${e.message}`);}};return(0,d.jsxs)(l.default,{title:"\u{1F510} JWT Encrypt / Decrypt Tool",className:"jwt-card",variant:"borderless",children:[(0,d.jsxs)(p.default,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,d.jsx)(u.default.Password,{placeholder:"Enter Secret Key",value:e,onChange:e=>t(e.target.value)}),(0,d.jsx)(et,{rows:4,placeholder:"Enter Payload JSON (e.g. { 'user': 'admin' })",value:a,onChange:e=>r(e.target.value)}),(0,d.jsxs)(p.default,{wrap:!0,children:[(0,d.jsx)(n.default,{type:"primary",onClick:y,children:"Encrypt (Sign JWT)"}),(0,d.jsx)(n.default,{onClick:()=>{try{let e=f(a);r(JSON.stringify(e,null,2)),m.default.success("Payload formatted successfully!");}catch{m.default.error("Cannot format: invalid JSON.");}},children:"Prettify JSON"})]}),(0,d.jsx)(et,{rows:4,placeholder:"Generated or Existing JWT Token",value:i,onChange:e=>o(e.target.value)}),(0,d.jsx)(n.default,{onClick:w,children:"Decrypt (Verify JWT)"}),s&&(0,d.jsxs)("div",{className:"jwt-output",children:[(0,d.jsx)(ea,{level:5,children:"Decoded Payload:"}),(0,d.jsx)("pre",{className:"jwt-pre",children:s})]})]}),(0,d.jsxs)("div",{className:"jwt-guide",children:[(0,d.jsx)(ea,{level:4,children:"\u{1F4D8} How to Use This Tool"}),(0,d.jsxs)(er,{children:["This page helps you ",(0,d.jsx)(ei,{strong:!0,children:"create"})," and ",(0,d.jsx)(ei,{strong:!0,children:"verify"})," JSON Web Tokens (JWTs) using a secret key."]}),(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:"Enter a secret key for signing and verifying tokens."}),(0,d.jsxs)("li",{children:["Provide your payload data in JSON format (e.g. ",(0,d.jsx)("code",{children:'{ "user": "admin" }'}),")."]}),(0,d.jsxs)("li",{children:["Click ",(0,d.jsx)(ei,{strong:!0,children:"Encrypt"})," to generate a JWT."]}),(0,d.jsxs)("li",{children:["Paste any JWT token and click ",(0,d.jsx)(ei,{strong:!0,children:"Decrypt"})," to verify and decode it."]})]}),(0,d.jsx)(er,{type:"secondary",children:"\u26A0\uFE0F Always keep your secret key private \u2014 anyone with it can generate valid tokens."})]})]});};}}]);
//# sourceMappingURL=9b232423-async.aefc9dc2.js.map