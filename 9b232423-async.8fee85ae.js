(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["9b232423"],{"0be78c77":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return ei;}});var r=a("777fffbe"),i=a("852bbaa9"),d=a("1a7c85b4"),o=a("28c7d19c"),n=a("b2a1469e"),s=r._(n),l=a("e9bcd22d"),c=r._(l),u=a("cec50f65"),p=r._(u),h=a("ea21718c"),f=r._(h),y=a("6effc0fd"),w=r._(y),m=a("c9d8dc0b"),b=r._(m),g=a("3c9e49cc"),v=a("8b216428"),J=r._(v),S=a("0c32acfb"),W=r._(S),T=a("c923f942"),H=r._(T),k=async(e,t,a)=>{let r=await (0,H.default)(e,t,"sign");return(0,W.default)(e,r),new Uint8Array(await crypto.subtle.sign((0,J.default)(e,r.algorithm),r,a));},x=a("e7fa9173"),I=r._(x),j=a("7f907bd6"),C=a("e48ac8f7"),P=a("45d10e5b"),_=r._(P),A=a("77e4a257"),E=r._(A),N=a("43adda83"),F=r._(N);class O{#e;#t;#a;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#e=e;}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this;}setUnprotectedHeader(e){if(this.#a)throw TypeError("setUnprotectedHeader can only be called once");return this.#a=e,this;}async sign(e,t){let a;if(!this.#t&&!this.#a)throw new j.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,I.default)(this.#t,this.#a))throw new j.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let r={...this.#t,...this.#a},i=(0,E.default)(j.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this.#t,r),d=!0;if(i.has("b64")&&"boolean"!=typeof(d=this.#t.b64))throw new j.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:o}=r;if("string"!=typeof o||!o)throw new j.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,_.default)(o,e,"sign");let n=this.#e;d&&(n=C.encoder.encode((0,g.encode)(n))),a=this.#t?C.encoder.encode((0,g.encode)(JSON.stringify(this.#t))):C.encoder.encode("");let s=(0,C.concat)(a,C.encoder.encode("."),n),l=await (0,F.default)(e,o),c=await k(o,l,s),u={signature:(0,g.encode)(c),payload:""};return d&&(u.payload=C.decoder.decode(n)),this.#a&&(u.header=this.#a),this.#t&&(u.protected=C.decoder.decode(a)),u;}}class U{#r;constructor(e){this.#r=new O(e);}setProtectedHeader(e){return this.#r.setProtectedHeader(e),this;}async sign(e,t){let a=await this.#r.sign(e,t);if(void 0===a.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${a.protected}.${a.payload}.${a.signature}`;}}var M=e=>Math.floor(e.getTime()/1e3);let V=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;var D=e=>{let t;let a=V.exec(e);if(!a||a[4]&&a[1])throw TypeError("Invalid time period format");let r=parseFloat(a[2]);switch(a[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*r);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*r);break;case"day":case"days":case"d":t=Math.round(86400*r);break;case"week":case"weeks":case"w":t=Math.round(604800*r);break;default:t=Math.round(31557600*r);}return"-"===a[1]||"ago"===a[4]?-t:t;},$=a("108b3a85"),B=r._($);function L(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t;}let z=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,q=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));class G{#e;constructor(e){if(!(0,B.default)(e))throw TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(e);}data(){return C.encoder.encode(JSON.stringify(this.#e));}get iss(){return this.#e.iss;}set iss(e){this.#e.iss=e;}get sub(){return this.#e.sub;}set sub(e){this.#e.sub=e;}get aud(){return this.#e.aud;}set aud(e){this.#e.aud=e;}set jti(e){this.#e.jti=e;}set nbf(e){"number"==typeof e?this.#e.nbf=L("setNotBefore",e):e instanceof Date?this.#e.nbf=L("setNotBefore",M(e)):this.#e.nbf=M(new Date)+D(e);}set exp(e){"number"==typeof e?this.#e.exp=L("setExpirationTime",e):e instanceof Date?this.#e.exp=L("setExpirationTime",M(e)):this.#e.exp=M(new Date)+D(e);}set iat(e){void 0===e?this.#e.iat=M(new Date):e instanceof Date?this.#e.iat=L("setIssuedAt",M(e)):"string"==typeof e?this.#e.iat=L("setIssuedAt",M(new Date)+D(e)):this.#e.iat=L("setIssuedAt",e);}}class K{#t;#i;constructor(e={}){this.#i=new G(e);}setIssuer(e){return this.#i.iss=e,this;}setSubject(e){return this.#i.sub=e,this;}setAudience(e){return this.#i.aud=e,this;}setJti(e){return this.#i.jti=e,this;}setNotBefore(e){return this.#i.nbf=e,this;}setExpirationTime(e){return this.#i.exp=e,this;}setIssuedAt(e){return this.#i.iat=e,this;}setProtectedHeader(e){return this.#t=e,this;}async sign(e,t){var a;let r=new U(this.#i.data());if(r.setProtectedHeader(this.#t),Array.isArray(null===(a=this.#t)||void 0===a?void 0:a.crit)&&this.#t.crit.includes("b64")&&!1===this.#t.b64)throw new j.JWTInvalid("JWTs MUST NOT use unencoded payload");return r.sign(e,t);}}var R=async(e,t,a,r)=>{let i=await (0,H.default)(e,t,"verify");(0,W.default)(e,i);let d=(0,J.default)(e,i.algorithm);try{return await crypto.subtle.verify(d,i,a,r);}catch{return!1;}},Z=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t);};async function Q(e,t,a){let r,i;if(!(0,B.default)(e))throw new j.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new j.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new j.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new j.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new j.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,B.default)(e.header))throw new j.JWSInvalid("JWS Unprotected Header incorrect type");let d={};if(e.protected)try{let t=(0,g.decode)(e.protected);d=JSON.parse(C.decoder.decode(t));}catch{throw new j.JWSInvalid("JWS Protected Header is invalid");}if(!(0,I.default)(d,e.header))throw new j.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let o={...d,...e.header},n=(0,E.default)(j.JWSInvalid,new Map([["b64",!0]]),null==a?void 0:a.crit,d,o),s=!0;if(n.has("b64")&&"boolean"!=typeof(s=d.b64))throw new j.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:l}=o;if("string"!=typeof l||!l)throw new j.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let c=a&&Z("algorithms",a.algorithms);if(c&&!c.has(l))throw new j.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(s){if("string"!=typeof e.payload)throw new j.JWSInvalid("JWS Payload must be a string");}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new j.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let u=!1;"function"==typeof t&&(t=await t(d,e),u=!0),(0,_.default)(l,t,"verify");let p=(0,C.concat)(C.encoder.encode(e.protected??""),C.encoder.encode("."),"string"==typeof e.payload?C.encoder.encode(e.payload):e.payload);try{r=(0,g.decode)(e.signature);}catch{throw new j.JWSInvalid("Failed to base64url decode the signature");}let h=await (0,F.default)(t,l);if(!await R(l,h,r,p))throw new j.JWSSignatureVerificationFailed;if(s)try{i=(0,g.decode)(e.payload);}catch{throw new j.JWSInvalid("Failed to base64url decode the payload");}else i="string"==typeof e.payload?C.encoder.encode(e.payload):e.payload;let f={payload:i};return(void 0!==e.protected&&(f.protectedHeader=d),void 0!==e.header&&(f.unprotectedHeader=e.header),u)?{...f,key:h}:f;}async function X(e,t,a){if(e instanceof Uint8Array&&(e=C.decoder.decode(e)),"string"!=typeof e)throw new j.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:r,1:i,2:d,length:o}=e.split(".");if(3!==o)throw new j.JWSInvalid("Invalid Compact JWS");let n=await Q({payload:i,protected:r,signature:d},t,a),s={payload:n.payload,protectedHeader:n.protectedHeader};return"function"==typeof t?{...s,key:n.key}:s;}async function Y(e,t,a){var r;let i=await X(e,t,a);if((null===(r=i.protectedHeader.crit)||void 0===r?void 0:r.includes("b64"))&&!1===i.protectedHeader.b64)throw new j.JWTInvalid("JWTs MUST NOT use unencoded payload");let d={payload:function(e,t,a={}){let r,i;try{r=JSON.parse(C.decoder.decode(t));}catch{}if(!(0,B.default)(r))throw new j.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{typ:d}=a;if(d&&("string"!=typeof e.typ||z(e.typ)!==z(d)))throw new j.JWTClaimValidationFailed('unexpected "typ" JWT header value',r,"typ","check_failed");let{requiredClaims:o=[],issuer:n,subject:s,audience:l,maxTokenAge:c}=a,u=[...o];for(let e of(void 0!==c&&u.push("iat"),void 0!==l&&u.push("aud"),void 0!==s&&u.push("sub"),void 0!==n&&u.push("iss"),new Set(u.reverse())))if(!(e in r))throw new j.JWTClaimValidationFailed(`missing required "${e}" claim`,r,e,"missing");if(n&&!(Array.isArray(n)?n:[n]).includes(r.iss))throw new j.JWTClaimValidationFailed('unexpected "iss" claim value',r,"iss","check_failed");if(s&&r.sub!==s)throw new j.JWTClaimValidationFailed('unexpected "sub" claim value',r,"sub","check_failed");if(l&&!q(r.aud,"string"==typeof l?[l]:l))throw new j.JWTClaimValidationFailed('unexpected "aud" claim value',r,"aud","check_failed");switch(typeof a.clockTolerance){case"string":i=D(a.clockTolerance);break;case"number":i=a.clockTolerance;break;case"undefined":i=0;break;default:throw TypeError("Invalid clockTolerance option type");}let{currentDate:p}=a,h=M(p||new Date);if((void 0!==r.iat||c)&&"number"!=typeof r.iat)throw new j.JWTClaimValidationFailed('"iat" claim must be a number',r,"iat","invalid");if(void 0!==r.nbf){if("number"!=typeof r.nbf)throw new j.JWTClaimValidationFailed('"nbf" claim must be a number',r,"nbf","invalid");if(r.nbf>h+i)throw new j.JWTClaimValidationFailed('"nbf" claim timestamp check failed',r,"nbf","check_failed");}if(void 0!==r.exp){if("number"!=typeof r.exp)throw new j.JWTClaimValidationFailed('"exp" claim must be a number',r,"exp","invalid");if(r.exp<=h-i)throw new j.JWTExpired('"exp" claim timestamp check failed',r,"exp","check_failed");}if(c){let e=h-r.iat;if(e-i>("number"==typeof c?c:D(c)))throw new j.JWTExpired('"iat" claim timestamp check failed (too far in the past)',r,"iat","check_failed");if(e<0-i)throw new j.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',r,"iat","check_failed");}return r;}(i.protectedHeader,i.payload,a),protectedHeader:i.protectedHeader};return"function"==typeof t?{...d,key:i.key}:d;}var ee=a("d322be42"),et=i._(ee);let{TextArea:ea}=p.default,{Title:er}=w.default,ei=()=>{let[e,t]=(0,et.useState)(""),[a,r]=(0,et.useState)(""),[i,n]=(0,et.useState)(""),[l,u]=(0,et.useState)(""),h=new TextEncoder,y=e=>{let t=e.trim();try{return JSON.parse(t);}catch{try{let e=t.replace(/'/g,'"').replace(/([a-zA-Z0-9_]+):/g,'"$1":');return JSON.parse(e);}catch{throw Error("Invalid JSON payload format.");}}},w=async()=>{try{let t=y(a),r=h.encode(e),i=await new K(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("2h").sign(r);n(i),b.default.success("JWT token created successfully!");}catch(e){console.error(e),b.default.error(e.message||"Error creating JWT.");}},m=async()=>{try{let t=h.encode(e),{payload:a}=await Y(i,t);u(JSON.stringify(a,null,2)),b.default.success("Token verified successfully!");}catch(e){b.default.error(`Invalid token: ${e.message}`);}};return(0,d.jsx)(o.PageContainer,{children:(0,d.jsx)(c.default,{title:"\u{1F510} JWT Encrypt / Decrypt Tool",variant:"borderless",children:(0,d.jsxs)(f.default,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,d.jsx)(p.default.Password,{placeholder:"Enter Secret Key",value:e,onChange:e=>t(e.target.value)}),(0,d.jsx)(ea,{rows:4,placeholder:"Enter Payload JSON (e.g. { 'user': 'admin' })",value:a,onChange:e=>r(e.target.value)}),(0,d.jsxs)(f.default,{children:[(0,d.jsx)(s.default,{type:"primary",onClick:w,children:"Encrypt (Sign JWT)"}),(0,d.jsx)(s.default,{onClick:()=>{try{let e=y(a);r(JSON.stringify(e,null,2)),b.default.success("Payload formatted successfully!");}catch{b.default.error("Cannot format: invalid JSON.");}},children:"Prettify JSON"})]}),(0,d.jsx)(ea,{rows:4,placeholder:"Generated or Existing JWT Token",value:i,onChange:e=>n(e.target.value)}),(0,d.jsx)(s.default,{onClick:m,children:"Decrypt (Verify JWT)"}),l&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(er,{level:5,children:"Decoded Payload:"}),(0,d.jsx)("pre",{style:{background:"#f7f7f7",padding:12,borderRadius:6,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:l})]})]})})});};}}]);
//# sourceMappingURL=9b232423-async.8fee85ae.js.map