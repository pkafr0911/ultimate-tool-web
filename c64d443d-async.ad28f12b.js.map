{"version":3,"sources":["node_modules/@ant-design/icons-svg/es/asn/StopOutlined.js","node_modules/@ant-design/icons/es/icons/StopOutlined.js","src/pages/VectorEditor/components/SettingsModal.tsx","src/pages/VectorEditor/components/Toolbar.tsx","src/pages/VectorEditor/hooks/useShortcuts.ts","src/pages/VectorEditor/hooks/usePenTool.ts","src/pages/VectorEditor/components/CanvasArea.tsx","src/pages/VectorEditor/components/PropertiesPanel.tsx","src/pages/VectorEditor/components/LayersPanel.tsx","node_modules/@ant-design/icons-svg/es/asn/VerticalAlignTopOutlined.js","node_modules/@ant-design/icons/es/icons/VerticalAlignTopOutlined.js","node_modules/@ant-design/icons-svg/es/asn/VerticalAlignBottomOutlined.js","node_modules/@ant-design/icons/es/icons/VerticalAlignBottomOutlined.js","node_modules/@ant-design/icons-svg/es/asn/GroupOutlined.js","node_modules/@ant-design/icons/es/icons/GroupOutlined.js","node_modules/@ant-design/icons-svg/es/asn/UngroupOutlined.js","node_modules/@ant-design/icons/es/icons/UngroupOutlined.js","src/pages/VectorEditor/components/AlignmentPanel.tsx","src/pages/VectorEditor/index.tsx","E:/code\\ultimate-tool-web\\src\\pages\\VectorEditor\\styles.less?asmodule","src/pages/VectorEditor/hooks/useHistory.ts","src/pages/VectorEditor/context.tsx"],"sourcesContent":["// This icon file is generated automatically.\nvar StopOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z\" } }] }, \"name\": \"stop\", \"theme\": \"outlined\" };\nexport default StopOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport StopOutlinedSvg from \"@ant-design/icons-svg/es/asn/StopOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar StopOutlined = function StopOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: StopOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(StopOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'StopOutlined';\n}\nexport default RefIcon;","import React from 'react';\r\nimport { Modal, Form, ColorPicker, Switch, InputNumber } from 'antd';\r\nimport { useVectorEditor } from '../context';\r\n\r\ninterface SettingsModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nconst SettingsModal: React.FC<SettingsModalProps> = ({ open, onClose }) => {\r\n  const { canvas, history } = useVectorEditor();\r\n  const [form] = Form.useForm();\r\n\r\n  const handleValuesChange = (changedValues: any, allValues: any) => {\r\n    if (!canvas) return;\r\n\r\n    if (changedValues.backgroundColor) {\r\n      const color =\r\n        typeof changedValues.backgroundColor === 'string'\r\n          ? changedValues.backgroundColor\r\n          : changedValues.backgroundColor.toHexString();\r\n      canvas.backgroundColor = color;\r\n      canvas.requestRenderAll();\r\n      // We might not want to save history on every color drag, but for now it's okay or we can debounce\r\n    }\r\n\r\n    if (changedValues.width || changedValues.height) {\r\n      canvas.setDimensions({\r\n        width: allValues.width || canvas.width,\r\n        height: allValues.height || canvas.height,\r\n      });\r\n      canvas.requestRenderAll();\r\n    }\r\n  };\r\n\r\n  const initialValues = {\r\n    backgroundColor: canvas?.backgroundColor || '#ffffff',\r\n    width: canvas?.width,\r\n    height: canvas?.height,\r\n  };\r\n\r\n  return (\r\n    <Modal title=\"Canvas Settings\" open={open} onCancel={onClose} footer={null} destroyOnHidden>\r\n      <Form\r\n        form={form}\r\n        layout=\"vertical\"\r\n        initialValues={initialValues}\r\n        onValuesChange={handleValuesChange}\r\n      >\r\n        <Form.Item label=\"Background Color\" name=\"backgroundColor\">\r\n          <ColorPicker showText />\r\n        </Form.Item>\r\n        <Form.Item label=\"Canvas Width\" name=\"width\">\r\n          <InputNumber />\r\n        </Form.Item>\r\n        <Form.Item label=\"Canvas Height\" name=\"height\">\r\n          <InputNumber />\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default SettingsModal;\r\n","import React from 'react';\r\nimport { Button, Tooltip, Space, Divider } from 'antd';\r\nimport {\r\n  DragOutlined,\r\n  BorderOutlined,\r\n  StopOutlined,\r\n  FontSizeOutlined,\r\n  DeleteOutlined,\r\n  DownloadOutlined,\r\n  HighlightOutlined,\r\n  UndoOutlined,\r\n  RedoOutlined,\r\n  ZoomInOutlined,\r\n  ZoomOutOutlined,\r\n  ExpandOutlined,\r\n  EditOutlined,\r\n  SettingOutlined,\r\n} from '@ant-design/icons';\r\nimport { Rect, Circle, IText } from 'fabric';\r\nimport { useVectorEditor } from '../context';\r\nimport SettingsModal from './SettingsModal';\r\n\r\nconst Toolbar: React.FC = () => {\r\n  const { canvas, activeTool, setActiveTool, history } = useVectorEditor();\r\n  const [settingsOpen, setSettingsOpen] = React.useState(false);\r\n\r\n  const addRectangle = () => {\r\n    if (!canvas) return;\r\n    const rect = new Rect({\r\n      left: 100,\r\n      top: 100,\r\n      fill: '#ff0000',\r\n      width: 100,\r\n      height: 100,\r\n    });\r\n    canvas.add(rect);\r\n    canvas.setActiveObject(rect);\r\n    setActiveTool('select');\r\n  };\r\n\r\n  const addCircle = () => {\r\n    if (!canvas) return;\r\n    const circle = new Circle({\r\n      left: 100,\r\n      top: 100,\r\n      fill: '#00ff00',\r\n      radius: 50,\r\n    });\r\n    canvas.add(circle);\r\n    canvas.setActiveObject(circle);\r\n    setActiveTool('select');\r\n  };\r\n\r\n  const addText = () => {\r\n    if (!canvas) return;\r\n    const text = new IText('Type here', {\r\n      left: 100,\r\n      top: 100,\r\n      fontFamily: 'arial',\r\n      fill: '#333',\r\n      fontSize: 20,\r\n    });\r\n    canvas.add(text);\r\n    canvas.setActiveObject(text);\r\n    setActiveTool('select');\r\n  };\r\n\r\n  const clearCanvas = () => {\r\n    if (!canvas) return;\r\n    canvas.clear();\r\n    canvas.backgroundColor = '#ffffff';\r\n    canvas.renderAll();\r\n    history.saveState();\r\n  };\r\n\r\n  const exportSVG = () => {\r\n    if (!canvas) return;\r\n\r\n    // Save current background color\r\n    const originalBg = canvas.backgroundColor;\r\n\r\n    // Set background to transparent for export\r\n    canvas.backgroundColor = 'transparent';\r\n\r\n    // Calculate bounding box of all objects\r\n    const objects = canvas.getObjects();\r\n    let svg;\r\n\r\n    if (objects.length > 0) {\r\n      let minX = Infinity,\r\n        minY = Infinity,\r\n        maxX = -Infinity,\r\n        maxY = -Infinity;\r\n\r\n      objects.forEach((obj) => {\r\n        const br = obj.getBoundingRect();\r\n        if (br.left < minX) minX = br.left;\r\n        if (br.top < minY) minY = br.top;\r\n        if (br.left + br.width > maxX) maxX = br.left + br.width;\r\n        if (br.top + br.height > maxY) maxY = br.top + br.height;\r\n      });\r\n\r\n      // Add some padding\r\n      const padding = 10;\r\n      minX -= padding;\r\n      minY -= padding;\r\n      maxX += padding;\r\n      maxY += padding;\r\n\r\n      const width = maxX - minX;\r\n      const height = maxY - minY;\r\n\r\n      svg = canvas.toSVG({\r\n        viewBox: {\r\n          x: minX,\r\n          y: minY,\r\n          width: width,\r\n          height: height,\r\n        },\r\n        width: width.toString(),\r\n        height: height.toString(),\r\n      });\r\n    } else {\r\n      svg = canvas.toSVG();\r\n    }\r\n\r\n    // Restore background\r\n    canvas.backgroundColor = originalBg;\r\n    canvas.requestRenderAll();\r\n\r\n    const blob = new Blob([svg], { type: 'image/svg+xml' });\r\n    const url = URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = 'design.svg';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n\r\n  return (\r\n    <Space direction=\"vertical\" size=\"small\">\r\n      <Tooltip title=\"Select (V)\">\r\n        <Button\r\n          type={activeTool === 'select' ? 'primary' : 'default'}\r\n          icon={<DragOutlined />}\r\n          onClick={() => setActiveTool('select')}\r\n        />\r\n      </Tooltip>\r\n\r\n      <Tooltip title=\"Pan (H / Space)\">\r\n        <Button\r\n          type={activeTool === 'pan' ? 'primary' : 'default'}\r\n          icon={<DragOutlined />}\r\n          onClick={() => setActiveTool('pan')}\r\n        />\r\n      </Tooltip>\r\n\r\n      <Divider style={{ margin: '4px 0' }} />\r\n\r\n      <Tooltip title=\"Rectangle (R)\">\r\n        <Button icon={<BorderOutlined />} onClick={addRectangle} />\r\n      </Tooltip>\r\n\r\n      <Tooltip title=\"Circle (C)\">\r\n        <Button icon={<StopOutlined rotate={45} />} onClick={addCircle} />\r\n      </Tooltip>\r\n\r\n      <Tooltip title=\"Text (T)\">\r\n        <Button icon={<FontSizeOutlined />} onClick={addText} />\r\n      </Tooltip>\r\n\r\n      <Tooltip title=\"Pen (P)\">\r\n        <Button\r\n          type={activeTool === 'pen' ? 'primary' : 'default'}\r\n          icon={<EditOutlined />}\r\n          onClick={() => setActiveTool('pen')}\r\n        />\r\n      </Tooltip>\r\n\r\n      <Divider style={{ margin: '4px 0' }} />\r\n\r\n      <Tooltip title=\"Undo (Ctrl+Z)\">\r\n        <Button icon={<UndoOutlined />} onClick={history.undo} disabled={!history.canUndo} />\r\n      </Tooltip>\r\n\r\n      <Tooltip title=\"Redo (Ctrl+Shift+Z)\">\r\n        <Button icon={<RedoOutlined />} onClick={history.redo} disabled={!history.canRedo} />\r\n      </Tooltip>\r\n\r\n      <Divider style={{ margin: '4px 0' }} />\r\n\r\n      <Tooltip title=\"Clear Canvas\">\r\n        <Button icon={<DeleteOutlined />} danger onClick={clearCanvas} />\r\n      </Tooltip>\r\n\r\n      <Tooltip title=\"Export SVG\">\r\n        <Button icon={<DownloadOutlined />} onClick={exportSVG} />\r\n      </Tooltip>\r\n\r\n      <Tooltip title=\"Settings\">\r\n        <Button icon={<SettingOutlined />} onClick={() => setSettingsOpen(true)} />\r\n      </Tooltip>\r\n\r\n      <SettingsModal open={settingsOpen} onClose={() => setSettingsOpen(false)} />\r\n    </Space>\r\n  );\r\n};\r\n\r\nexport default Toolbar;\r\n","import { useEffect } from 'react';\r\n\r\ninterface ShortcutMap {\r\n  [key: string]: (e: KeyboardEvent) => void;\r\n}\r\n\r\nexport const useShortcuts = (shortcuts: ShortcutMap) => {\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      // Ignore if typing in an input or textarea\r\n      if (\r\n        document.activeElement instanceof HTMLInputElement ||\r\n        document.activeElement instanceof HTMLTextAreaElement\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      const key = e.key.toLowerCase();\r\n      const ctrl = e.ctrlKey || e.metaKey;\r\n      const shift = e.shiftKey;\r\n\r\n      // Construct key string like 'ctrl+z', 'ctrl+shift+z', 'v', 'delete'\r\n      let keyString = '';\r\n      if (ctrl) keyString += 'ctrl+';\r\n      if (shift) keyString += 'shift+';\r\n      keyString += key;\r\n\r\n      if (shortcuts[keyString]) {\r\n        e.preventDefault();\r\n        shortcuts[keyString](e);\r\n      } else if (shortcuts[key]) {\r\n        // Fallback for single keys without modifiers if not explicitly defined with modifiers\r\n        // But be careful not to trigger 'v' when 'ctrl+v' is pressed if 'ctrl+v' is not defined but 'v' is.\r\n        // The logic above handles exact matches first.\r\n        if (!ctrl && !shift) {\r\n          shortcuts[key](e);\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [shortcuts]);\r\n};\r\n","import { useState, useRef, useCallback } from 'react'; // Import React hooks for state and refs\r\nimport { Canvas, Path, Circle, Line, Object as FabricObject } from 'fabric'; // Import Fabric.js classes\r\n\r\ninterface Point {\r\n  x: number; // X coordinate\r\n  y: number; // Y coordinate\r\n  cp1?: { x: number; y: number }; // Incoming control point (Bezier handle)\r\n  cp2?: { x: number; y: number }; // Outgoing control point (Bezier handle)\r\n}\r\n\r\n// Extend Fabric Object type to include isTemp\r\ndeclare module 'fabric' {\r\n  interface Object {\r\n    isTemp?: boolean; // Flag to identify temporary objects (markers, helpers)\r\n  }\r\n}\r\n\r\nexport const usePenTool = (canvas: Canvas | null, saveHistory?: () => void) => {\r\n  const [isDrawing, setIsDrawing] = useState(false); // State to track if drawing is active\r\n  const activePath = useRef<Path | null>(null); // Ref to store the current path being drawn\r\n  const points = useRef<Point[]>([]); // Ref to store points of the path\r\n  const markers = useRef<Circle[]>([]); // Ref to store visual markers (circles) at points\r\n  const isDragging = useRef(false); // Ref to track if mouse is being dragged (for curves)\r\n  const dragStartPoint = useRef<{ x: number; y: number } | null>(null); // Ref to store start point of drag\r\n  const rubberBand = useRef<Path | null>(null); // Ref for the preview line (rubber band)\r\n  const handleLines = useRef<Line[]>([]); // Ref for visual lines connecting control points\r\n\r\n  const generatePathString = (pts: Point[], closed: boolean = false) => {\r\n    if (pts.length === 0) return ''; // Return empty if no points\r\n\r\n    let d = `M ${pts[0].x} ${pts[0].y}`; // Start path command (Move to)\r\n\r\n    for (let i = 1; i < pts.length; i++) {\r\n      const curr = pts[i]; // Current point\r\n      const prev = pts[i - 1]; // Previous point\r\n\r\n      if (prev.cp2 || curr.cp1) {\r\n        // If control points exist, draw Bezier curve\r\n        const cp1x = prev.cp2 ? prev.cp2.x : prev.x; // Control point 1 X\r\n        const cp1y = prev.cp2 ? prev.cp2.y : prev.y; // Control point 1 Y\r\n        const cp2x = curr.cp1 ? curr.cp1.x : curr.x; // Control point 2 X\r\n        const cp2y = curr.cp1 ? curr.cp1.y : curr.y; // Control point 2 Y\r\n\r\n        d += ` C ${cp1x} ${cp1y} ${cp2x} ${cp2y} ${curr.x} ${curr.y}`; // Cubic Bezier command\r\n      } else {\r\n        d += ` L ${curr.x} ${curr.y}`; // Line command\r\n      }\r\n    }\r\n\r\n    if (closed) {\r\n      d += ' Z'; // Close path command\r\n    }\r\n\r\n    return d; // Return SVG path data string\r\n  };\r\n\r\n  const updatePath = useCallback(() => {\r\n    if (!canvas || points.current.length === 0) return; // Exit if no canvas or points\r\n\r\n    const d = generatePathString(points.current); // Generate path string\r\n\r\n    if (activePath.current) {\r\n      canvas.remove(activePath.current); // Remove old path instance\r\n    }\r\n\r\n    const newPath = new Path(d, {\r\n      fill: '', // No fill\r\n      stroke: 'black', // Black stroke\r\n      strokeWidth: 2, // Stroke width\r\n      selectable: false, // Not selectable while drawing\r\n      evented: false, // No events\r\n      objectCaching: false, // Disable caching for performance during draw\r\n    });\r\n    newPath.isTemp = true; // Mark as temporary\r\n\r\n    canvas.add(newPath); // Add to canvas\r\n    canvas.sendObjectToBack(newPath); // Send to back so markers are on top\r\n    activePath.current = newPath; // Update ref\r\n    canvas.requestRenderAll(); // Render canvas\r\n  }, [canvas]);\r\n\r\n  const addMarker = useCallback(\r\n    (x: number, y: number, isStart: boolean = false) => {\r\n      if (!canvas) return; // Exit if no canvas\r\n\r\n      const marker = new Circle({\r\n        left: x, // X position\r\n        top: y, // Y position\r\n        radius: 4, // Radius\r\n        fill: isStart ? '#00ff00' : '#ffffff', // Green for start, white for others\r\n        stroke: '#333', // Dark stroke\r\n        strokeWidth: 1, // Stroke width\r\n        originX: 'center', // Center origin\r\n        originY: 'center', // Center origin\r\n        selectable: false, // Not selectable\r\n        evented: true, // Enable events (for clicking start point to close)\r\n        hasControls: false, // No controls\r\n        hasBorders: false, // No borders\r\n      });\r\n      marker.isTemp = true; // Mark as temporary\r\n\r\n      canvas.add(marker); // Add to canvas\r\n      markers.current.push(marker); // Add to markers array\r\n      canvas.requestRenderAll(); // Render canvas\r\n      return marker; // Return marker instance\r\n    },\r\n    [canvas],\r\n  );\r\n\r\n  const finishPath = useCallback(\r\n    (closed: boolean = false) => {\r\n      if (!canvas || !activePath.current) return; // Exit if no active path\r\n\r\n      const d = generatePathString(points.current, closed); // Generate final path string\r\n\r\n      if (activePath.current) canvas.remove(activePath.current); // Remove temporary path\r\n      markers.current.forEach((m) => canvas.remove(m)); // Remove all markers\r\n      markers.current = []; // Clear markers array\r\n\r\n      if (rubberBand.current) {\r\n        canvas.remove(rubberBand.current); // Remove rubber band\r\n        rubberBand.current = null; // Clear ref\r\n      }\r\n\r\n      handleLines.current.forEach((l) => canvas.remove(l)); // Remove handle lines\r\n      handleLines.current = []; // Clear handle lines array\r\n\r\n      const finalPath = new Path(d, {\r\n        fill: closed ? '#cccccc' : '', // Fill if closed\r\n        stroke: 'black', // Stroke color\r\n        strokeWidth: 2, // Stroke width\r\n        selectable: true, // Make selectable\r\n        evented: true, // Enable events\r\n        objectCaching: true, // Enable caching\r\n      });\r\n\r\n      canvas.add(finalPath); // Add final path to canvas\r\n      canvas.setActiveObject(finalPath); // Select the new path\r\n\r\n      setIsDrawing(false); // Stop drawing mode\r\n      activePath.current = null; // Clear active path ref\r\n      points.current = []; // Clear points\r\n      isDragging.current = false; // Reset dragging state\r\n      dragStartPoint.current = null; // Reset drag start point\r\n\r\n      if (saveHistory) saveHistory(); // Save to history\r\n      canvas.requestRenderAll(); // Render canvas\r\n    },\r\n    [canvas, saveHistory],\r\n  );\r\n\r\n  const onMouseDown = useCallback(\r\n    (e: any) => {\r\n      if (!canvas) return; // Exit if no canvas\r\n      const pointer = canvas.getPointer(e.e); // Get mouse pointer coordinates\r\n\r\n      if (isDrawing && markers.current.length > 0) {\r\n        const startMarker = markers.current[0]; // Get start marker\r\n        if (e.target === startMarker) {\r\n          finishPath(true); // Close path if start marker clicked\r\n          return;\r\n        }\r\n        if (markers.current.includes(e.target)) {\r\n          return; // Ignore clicks on other markers\r\n        }\r\n      }\r\n\r\n      if (!isDrawing) {\r\n        setIsDrawing(true); // Start drawing\r\n        points.current = [{ x: pointer.x, y: pointer.y }]; // Initialize points\r\n        addMarker(pointer.x, pointer.y, true); // Add start marker\r\n        updatePath(); // Draw initial path\r\n      } else {\r\n        points.current.push({ x: pointer.x, y: pointer.y }); // Add new point\r\n        addMarker(pointer.x, pointer.y); // Add marker\r\n        updatePath(); // Update path\r\n      }\r\n\r\n      isDragging.current = true; // Start dragging (potential curve)\r\n      dragStartPoint.current = { x: pointer.x, y: pointer.y }; // Record drag start\r\n    },\r\n    [canvas, isDrawing, updatePath, addMarker, finishPath],\r\n  );\r\n\r\n  const onMouseMove = useCallback(\r\n    (e: any) => {\r\n      if (!canvas || !isDrawing) return; // Exit if not drawing\r\n\r\n      const pointer = canvas.getPointer(e.e); // Get pointer coordinates\r\n\r\n      if (isDragging.current && points.current.length > 0) {\r\n        // Dragging to create handles (Bezier curves)\r\n        const currentPointIndex = points.current.length - 1; // Get last point index\r\n        const currentPoint = points.current[currentPointIndex]; // Get last point\r\n\r\n        const dx = pointer.x - currentPoint.x; // Calculate delta X\r\n        const dy = pointer.y - currentPoint.y; // Calculate delta Y\r\n\r\n        currentPoint.cp2 = { x: currentPoint.x + dx, y: currentPoint.y + dy }; // Set outgoing control point\r\n        currentPoint.cp1 = { x: currentPoint.x - dx, y: currentPoint.y - dy }; // Set incoming control point (mirrored)\r\n\r\n        updatePath(); // Update path with curves\r\n\r\n        // Visualize handles\r\n        handleLines.current.forEach((l) => canvas.remove(l)); // Remove old handle lines\r\n        handleLines.current = []; // Clear array\r\n\r\n        if (currentPoint.cp1) {\r\n          const l1 = new Line(\r\n            [currentPoint.x, currentPoint.y, currentPoint.cp1.x, currentPoint.cp1.y],\r\n            {\r\n              stroke: '#666', // Gray color\r\n              strokeWidth: 1, // Thin line\r\n              selectable: false, // Not selectable\r\n              evented: false, // No events\r\n            },\r\n          );\r\n          l1.isTemp = true; // Mark as temp\r\n          canvas.add(l1); // Add to canvas\r\n          handleLines.current.push(l1); // Store ref\r\n        }\r\n        if (currentPoint.cp2) {\r\n          const l2 = new Line(\r\n            [currentPoint.x, currentPoint.y, currentPoint.cp2.x, currentPoint.cp2.y],\r\n            {\r\n              stroke: '#666', // Gray color\r\n              strokeWidth: 1, // Thin line\r\n              selectable: false, // Not selectable\r\n              evented: false, // No events\r\n            },\r\n          );\r\n          l2.isTemp = true; // Mark as temp\r\n          canvas.add(l2); // Add to canvas\r\n          handleLines.current.push(l2); // Store ref\r\n        }\r\n\r\n        // Hide rubber band while dragging handles\r\n        if (rubberBand.current) {\r\n          canvas.remove(rubberBand.current);\r\n          rubberBand.current = null;\r\n        }\r\n      } else if (points.current.length > 0) {\r\n        // Rubber band preview (line to mouse cursor)\r\n        const lastPoint = points.current[points.current.length - 1]; // Last placed point\r\n        let d = `M ${lastPoint.x} ${lastPoint.y}`; // Start from last point\r\n\r\n        if (lastPoint.cp2) {\r\n          // Curve to mouse if last point has control point\r\n          d += ` C ${lastPoint.cp2.x} ${lastPoint.cp2.y} ${pointer.x} ${pointer.y} ${pointer.x} ${pointer.y}`;\r\n        } else {\r\n          // Line to mouse otherwise\r\n          d += ` L ${pointer.x} ${pointer.y}`;\r\n        }\r\n\r\n        if (rubberBand.current) {\r\n          canvas.remove(rubberBand.current); // Remove old rubber band\r\n        }\r\n\r\n        const rb = new Path(d, {\r\n          fill: '', // No fill\r\n          stroke: '#999', // Light gray\r\n          strokeWidth: 1, // Thin line\r\n          strokeDashArray: [5, 5], // Dashed line\r\n          selectable: false, // Not selectable\r\n          evented: false, // No events\r\n        });\r\n        rb.isTemp = true; // Mark as temp\r\n        canvas.add(rb); // Add to canvas\r\n        rubberBand.current = rb; // Store ref\r\n        canvas.requestRenderAll(); // Render canvas\r\n      }\r\n    },\r\n    [canvas, isDrawing, updatePath],\r\n  );\r\n\r\n  const onMouseUp = useCallback(\r\n    (e: any) => {\r\n      isDragging.current = false; // Stop dragging\r\n      dragStartPoint.current = null; // Clear drag start\r\n      // Clear handle lines on mouse up\r\n      if (canvas) {\r\n        handleLines.current.forEach((l) => canvas.remove(l)); // Remove handle lines\r\n        handleLines.current = []; // Clear array\r\n        canvas.requestRenderAll(); // Render canvas\r\n      }\r\n    },\r\n    [canvas],\r\n  );\r\n\r\n  const onDoubleClick = useCallback(\r\n    (e: any) => {\r\n      finishPath(false); // Finish path (open) on double click\r\n    },\r\n    [finishPath],\r\n  );\r\n\r\n  return {\r\n    isDrawing, // Export drawing state\r\n    onMouseDown, // Export mouse down handler\r\n    onMouseMove, // Export mouse move handler\r\n    onMouseUp, // Export mouse up handler\r\n    onDoubleClick, // Export double click handler\r\n    finishPath, // Export finish path function\r\n  };\r\n};\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { Canvas, TEvent, Rect, Circle, IText, Point } from 'fabric';\r\nimport { useVectorEditor } from '../context';\r\nimport { useShortcuts } from '../hooks/useShortcuts';\r\nimport { usePenTool } from '../hooks/usePenTool';\r\n\r\nconst CanvasArea: React.FC = () => {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const { setCanvas, setSelectedObject, activeTool, setActiveTool, history, canvas } =\r\n    useVectorEditor();\r\n\r\n  const penTool = usePenTool(canvas, history.saveState);\r\n\r\n  // Initialize Canvas\r\n  useEffect(() => {\r\n    if (!canvasRef.current || !containerRef.current) return;\r\n\r\n    const fabricCanvas = new Canvas(canvasRef.current, {\r\n      width: containerRef.current.clientWidth,\r\n      height: containerRef.current.clientHeight,\r\n      backgroundColor: '#ffffff',\r\n      selection: true,\r\n    });\r\n\r\n    setCanvas(fabricCanvas);\r\n\r\n    // Event listeners\r\n    const updateSelection = () => {\r\n      const activeObjects = fabricCanvas.getActiveObjects();\r\n      if (activeObjects.length === 1) {\r\n        setSelectedObject(activeObjects[0]);\r\n      } else {\r\n        setSelectedObject(null);\r\n      }\r\n    };\r\n\r\n    fabricCanvas.on('selection:created', updateSelection);\r\n    fabricCanvas.on('selection:updated', updateSelection);\r\n    fabricCanvas.on('selection:cleared', () => setSelectedObject(null));\r\n\r\n    // Save state on modification\r\n    const saveHistory = (e: any) => {\r\n      // specific check for temp objects from pen tool\r\n      if (e.target && e.target.isTemp) return;\r\n      history.saveState();\r\n    };\r\n\r\n    fabricCanvas.on('object:modified', saveHistory);\r\n    fabricCanvas.on('object:added', saveHistory);\r\n    fabricCanvas.on('object:removed', saveHistory);\r\n\r\n    // Zoom\r\n    fabricCanvas.on('mouse:wheel', (opt) => {\r\n      const delta = opt.e.deltaY;\r\n      let zoom = fabricCanvas.getZoom();\r\n      zoom *= 0.999 ** delta;\r\n      if (zoom > 20) zoom = 20;\r\n      if (zoom < 0.01) zoom = 0.01;\r\n      fabricCanvas.zoomToPoint(new Point(opt.e.offsetX, opt.e.offsetY), zoom);\r\n      opt.e.preventDefault();\r\n      opt.e.stopPropagation();\r\n    });\r\n\r\n    const handleResize = () => {\r\n      if (containerRef.current) {\r\n        fabricCanvas.setDimensions({\r\n          width: containerRef.current.clientWidth,\r\n          height: containerRef.current.clientHeight,\r\n        });\r\n      }\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n\r\n    return () => {\r\n      fabricCanvas.dispose();\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  // Handle Tool Changes\r\n  useEffect(() => {\r\n    if (!canvas) return;\r\n\r\n    canvas.isDrawingMode = false;\r\n\r\n    if (activeTool === 'pan') {\r\n      canvas.defaultCursor = 'grab';\r\n      canvas.selection = false;\r\n      canvas.forEachObject((obj) => {\r\n        obj.selectable = false;\r\n        obj.evented = false;\r\n      });\r\n    } else if (activeTool === 'pen') {\r\n      canvas.defaultCursor = 'crosshair';\r\n      canvas.selection = false;\r\n      canvas.forEachObject((obj) => {\r\n        obj.selectable = false;\r\n        obj.evented = false;\r\n      });\r\n    } else {\r\n      canvas.defaultCursor = 'default';\r\n      canvas.selection = true;\r\n      canvas.forEachObject((obj) => {\r\n        obj.selectable = true;\r\n        obj.evented = true;\r\n      });\r\n    }\r\n\r\n    canvas.requestRenderAll();\r\n  }, [activeTool, canvas]);\r\n\r\n  // Bind Pen Events\r\n  useEffect(() => {\r\n    if (!canvas || activeTool !== 'pen') return;\r\n\r\n    const onMouseDown = (opt: any) => penTool.onMouseDown(opt);\r\n    const onMouseMove = (opt: any) => penTool.onMouseMove(opt);\r\n    const onMouseUp = (opt: any) => penTool.onMouseUp(opt);\r\n    const onDoubleClick = (opt: any) => penTool.onDoubleClick(opt);\r\n\r\n    canvas.on('mouse:down', onMouseDown);\r\n    canvas.on('mouse:move', onMouseMove);\r\n    canvas.on('mouse:up', onMouseUp);\r\n    canvas.on('mouse:dblclick', onDoubleClick);\r\n\r\n    return () => {\r\n      canvas.off('mouse:down', onMouseDown);\r\n      canvas.off('mouse:move', onMouseMove);\r\n      canvas.off('mouse:up', onMouseUp);\r\n      canvas.off('mouse:dblclick', onDoubleClick);\r\n    };\r\n  }, [canvas, activeTool, penTool]);\r\n\r\n  // Shortcuts\r\n  useShortcuts({\r\n    v: () => setActiveTool('select'),\r\n    h: () => setActiveTool('pan'),\r\n    ' ': () => setActiveTool('pan'), // Space for pan\r\n    r: () => {\r\n      if (!canvas) return;\r\n      const rect = new Rect({\r\n        left: 100,\r\n        top: 100,\r\n        fill: '#ff0000',\r\n        width: 100,\r\n        height: 100,\r\n      });\r\n      canvas.add(rect);\r\n      canvas.setActiveObject(rect);\r\n      setActiveTool('select');\r\n    },\r\n    c: () => {\r\n      if (!canvas) return;\r\n      const circle = new Circle({\r\n        left: 100,\r\n        top: 100,\r\n        fill: '#00ff00',\r\n        radius: 50,\r\n      });\r\n      canvas.add(circle);\r\n      canvas.setActiveObject(circle);\r\n      setActiveTool('select');\r\n    },\r\n    t: () => {\r\n      if (!canvas) return;\r\n      const text = new IText('Type here', {\r\n        left: 100,\r\n        top: 100,\r\n        fontFamily: 'arial',\r\n        fill: '#333',\r\n        fontSize: 20,\r\n      });\r\n      canvas.add(text);\r\n      canvas.setActiveObject(text);\r\n      setActiveTool('select');\r\n    },\r\n    p: () => setActiveTool('pen'),\r\n    delete: () => {\r\n      if (!canvas) return;\r\n      const activeObjects = canvas.getActiveObjects();\r\n      if (activeObjects.length) {\r\n        canvas.discardActiveObject();\r\n        activeObjects.forEach((obj) => {\r\n          canvas.remove(obj);\r\n        });\r\n        canvas.requestRenderAll();\r\n      }\r\n    },\r\n    backspace: () => {\r\n      if (!canvas) return;\r\n      const activeObjects = canvas.getActiveObjects();\r\n      if (activeObjects.length) {\r\n        canvas.discardActiveObject();\r\n        activeObjects.forEach((obj) => {\r\n          canvas.remove(obj);\r\n        });\r\n        canvas.requestRenderAll();\r\n      }\r\n    },\r\n    'ctrl+z': () => history.undo(),\r\n    'ctrl+shift+z': () => history.redo(),\r\n    'ctrl+=': () => {\r\n      // Zoom In\r\n      if (!canvas) return;\r\n      canvas.setZoom(canvas.getZoom() * 1.1);\r\n    },\r\n    'ctrl+-': () => {\r\n      // Zoom Out\r\n      if (!canvas) return;\r\n      canvas.setZoom(canvas.getZoom() * 0.9);\r\n    },\r\n    'ctrl+0': () => {\r\n      // Reset Zoom\r\n      if (!canvas) return;\r\n      canvas.setZoom(1);\r\n      canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n    },\r\n  });\r\n\r\n  return (\r\n    <div ref={containerRef} style={{ width: '100%', height: '100%' }}>\r\n      <canvas ref={canvasRef} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CanvasArea;\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Form, InputNumber, ColorPicker, Slider, Typography, Empty } from 'antd';\r\nimport { useVectorEditor } from '../context';\r\n\r\nconst { Title } = Typography;\r\n\r\nconst PropertiesPanel: React.FC = () => {\r\n  const { canvas, selectedObject } = useVectorEditor();\r\n  const [form] = Form.useForm();\r\n\r\n  // Local state to force re-render when object properties change externally (e.g. dragging)\r\n  const [, forceUpdate] = useState({});\r\n\r\n  useEffect(() => {\r\n    if (selectedObject) {\r\n      const updateForm = () => {\r\n        // Helper to safely get color string\r\n        const getColor = (val: any) => {\r\n          if (typeof val === 'string') return val;\r\n          if (val && typeof val === 'object' && 'colorStops' in val) return '#000000'; // Fallback for gradients\r\n          return val ? val.toString() : 'transparent';\r\n        };\r\n\r\n        form.setFieldsValue({\r\n          fill: getColor(selectedObject.fill),\r\n          stroke: getColor(selectedObject.stroke),\r\n          strokeWidth: selectedObject.strokeWidth,\r\n          opacity: selectedObject.opacity,\r\n          left: Math.round(selectedObject.left || 0),\r\n          top: Math.round(selectedObject.top || 0),\r\n          width: Math.round((selectedObject.width || 0) * (selectedObject.scaleX || 1)),\r\n          height: Math.round((selectedObject.height || 0) * (selectedObject.scaleY || 1)),\r\n          angle: Math.round(selectedObject.angle || 0),\r\n        });\r\n        forceUpdate({});\r\n      };\r\n\r\n      updateForm();\r\n\r\n      // Listen for object modification events on canvas to update form\r\n      if (canvas) {\r\n        const handleModified = () => updateForm();\r\n        canvas.on('object:modified', handleModified);\r\n        return () => {\r\n          canvas.off('object:modified', handleModified);\r\n        };\r\n      }\r\n    }\r\n  }, [selectedObject, canvas, form]);\r\n\r\n  if (!selectedObject) {\r\n    return <Empty description=\"No object selected\" image={Empty.PRESENTED_IMAGE_SIMPLE} />;\r\n  }\r\n\r\n  const handleValuesChange = (changedValues: any, allValues: any) => {\r\n    if (!selectedObject || !canvas) return;\r\n\r\n    if ('fill' in changedValues) {\r\n      // Antd ColorPicker returns an object, we need hex string or rgba\r\n      const color =\r\n        typeof changedValues.fill === 'string'\r\n          ? changedValues.fill\r\n          : changedValues.fill?.toHexString?.() || '#000000';\r\n      selectedObject.set('fill', color);\r\n    }\r\n    if ('stroke' in changedValues) {\r\n      const color =\r\n        typeof changedValues.stroke === 'string'\r\n          ? changedValues.stroke\r\n          : changedValues.stroke?.toHexString?.() || '#000000';\r\n      selectedObject.set('stroke', color);\r\n    }\r\n    if ('strokeWidth' in changedValues) {\r\n      selectedObject.set('strokeWidth', changedValues.strokeWidth);\r\n    }\r\n    if ('opacity' in changedValues) {\r\n      selectedObject.set('opacity', changedValues.opacity);\r\n    }\r\n    if ('left' in changedValues) {\r\n      selectedObject.set('left', changedValues.left);\r\n    }\r\n    if ('top' in changedValues) {\r\n      selectedObject.set('top', changedValues.top);\r\n    }\r\n    if ('angle' in changedValues) {\r\n      selectedObject.set('angle', changedValues.angle);\r\n    }\r\n\r\n    // Handling width/height changes usually requires adjusting scale for fabric objects\r\n    if ('width' in changedValues) {\r\n      const newWidth = changedValues.width;\r\n      if (selectedObject.width) {\r\n        selectedObject.scaleToWidth(newWidth);\r\n      }\r\n    }\r\n    if ('height' in changedValues) {\r\n      const newHeight = changedValues.height;\r\n      if (selectedObject.height) {\r\n        selectedObject.scaleToHeight(newHeight);\r\n      }\r\n    }\r\n\r\n    selectedObject.setCoords();\r\n    canvas.requestRenderAll();\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Title level={5}>Properties</Title>\r\n      <Form form={form} layout=\"vertical\" onValuesChange={handleValuesChange} size=\"small\">\r\n        <Form.Item name=\"fill\" label=\"Fill Color\">\r\n          <ColorPicker showText />\r\n        </Form.Item>\r\n\r\n        <Form.Item name=\"stroke\" label=\"Stroke Color\">\r\n          <ColorPicker showText />\r\n        </Form.Item>\r\n\r\n        <Form.Item name=\"strokeWidth\" label=\"Stroke Width\">\r\n          <InputNumber min={0} />\r\n        </Form.Item>\r\n\r\n        <Form.Item name=\"opacity\" label=\"Opacity\">\r\n          <Slider min={0} max={1} step={0.1} />\r\n        </Form.Item>\r\n\r\n        <div style={{ display: 'flex', gap: 8 }}>\r\n          <Form.Item name=\"left\" label=\"X\">\r\n            <InputNumber />\r\n          </Form.Item>\r\n          <Form.Item name=\"top\" label=\"Y\">\r\n            <InputNumber />\r\n          </Form.Item>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: 8 }}>\r\n          <Form.Item name=\"width\" label=\"Width\">\r\n            <InputNumber min={1} />\r\n          </Form.Item>\r\n          <Form.Item name=\"height\" label=\"Height\">\r\n            <InputNumber min={1} />\r\n          </Form.Item>\r\n        </div>\r\n\r\n        <Form.Item name=\"angle\" label=\"Rotation\">\r\n          <Slider min={0} max={360} />\r\n        </Form.Item>\r\n      </Form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PropertiesPanel;\r\n","import React, { useEffect, useState } from 'react'; // Import React hooks\r\nimport { List, Button, Typography, Space } from 'antd'; // Import Ant Design components\r\nimport {\r\n  EyeOutlined, // Icon for visible layer\r\n  EyeInvisibleOutlined, // Icon for hidden layer\r\n  LockOutlined, // Icon for locked layer\r\n  UnlockOutlined, // Icon for unlocked layer\r\n  DeleteOutlined, // Icon for delete action\r\n  HolderOutlined, // Icon for drag handle\r\n} from '@ant-design/icons'; // Import icons from Ant Design\r\nimport { useVectorEditor } from '../context'; // Import custom hook for editor context\r\nimport { FabricObject } from 'fabric'; // Import Fabric.js object type\r\nimport {\r\n  DndContext, // Context provider for drag and drop\r\n  closestCenter, // Collision detection algorithm\r\n  KeyboardSensor, // Sensor for keyboard interactions\r\n  PointerSensor, // Sensor for pointer (mouse/touch) interactions\r\n  useSensor, // Hook to use a specific sensor\r\n  useSensors, // Hook to combine multiple sensors\r\n  DragEndEvent, // Type for drag end event\r\n} from '@dnd-kit/core'; // Import core DnD Kit functionalities\r\nimport {\r\n  arrayMove, // Utility to move items in an array\r\n  SortableContext, // Context for sortable items\r\n  sortableKeyboardCoordinates, // Keyboard coordinates for sorting\r\n  verticalListSortingStrategy, // Sorting strategy for vertical lists\r\n  useSortable, // Hook to make an item sortable\r\n} from '@dnd-kit/sortable'; // Import sortable functionalities\r\nimport { CSS } from '@dnd-kit/utilities'; // Import CSS utilities for transforms\r\n\r\nconst { Title } = Typography; // Destructure Title from Typography\r\n\r\ninterface SortableItemProps {\r\n  id: string; // Unique identifier for the sortable item\r\n  children: React.ReactNode; // Content of the item\r\n  isSelected: boolean; // Whether the item is currently selected\r\n  onClick: () => void; // Click handler for the item\r\n}\r\n\r\nconst SortableItem: React.FC<SortableItemProps> = ({ id, children, isSelected, onClick }) => {\r\n  const { attributes, listeners, setNodeRef, setActivatorNodeRef, transform, transition } =\r\n    useSortable({ id }); // Initialize sortable hook\r\n\r\n  const style = {\r\n    transform: CSS.Transform.toString(transform), // Apply transform for dragging\r\n    transition, // Apply transition for smooth movement\r\n    backgroundColor: isSelected ? '#e6f7ff' : 'transparent', // Highlight if selected\r\n    marginBottom: 4, // Spacing between items\r\n    border: '1px solid #f0f0f0', // Border for the item\r\n    borderRadius: 4, // Rounded corners\r\n    padding: '4px 8px', // Padding inside the item\r\n    display: 'flex', // Flexbox layout\r\n    alignItems: 'center', // Center items vertically\r\n  };\r\n\r\n  return (\r\n    <div ref={setNodeRef} style={style}>\r\n      {' '}\r\n      {/* Main container for the sortable item */}\r\n      <div\r\n        ref={setActivatorNodeRef} // Set this element as the drag handle\r\n        {...attributes} // Spread accessibility attributes\r\n        {...listeners} // Spread event listeners\r\n        style={{\r\n          cursor: 'grab', // Cursor style for grabbing\r\n          marginRight: 8, // Spacing to the right\r\n          display: 'flex', // Flexbox layout\r\n          alignItems: 'center', // Center items vertically\r\n          color: '#999', // Color for the handle icon\r\n        }}\r\n      >\r\n        <HolderOutlined /> {/* Drag handle icon */}\r\n      </div>\r\n      <div onClick={onClick} style={{ flex: 1, cursor: 'pointer' }}>\r\n        {' '}\r\n        {/* Clickable area for selection */}\r\n        {children} {/* Render children content */}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst LayersPanel: React.FC = () => {\r\n  const { canvas, selectedObject, setSelectedObject, history } = useVectorEditor(); // Access editor context\r\n  const [objects, setObjects] = useState<FabricObject[]>([]); // State to store canvas objects\r\n\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor), // Use pointer sensor for mouse/touch\r\n    useSensor(KeyboardSensor, {\r\n      coordinateGetter: sortableKeyboardCoordinates, // Use keyboard coordinates for accessibility\r\n    }),\r\n  );\r\n\r\n  const updateObjects = () => {\r\n    if (!canvas) return; // Exit if canvas is not available\r\n    const objs = canvas.getObjects(); // Get all objects from canvas\r\n    objs.forEach((obj: any) => {\r\n      if (!obj.uid) obj.uid = Math.random().toString(36).substr(2, 9); // Assign unique ID if missing\r\n    });\r\n    // Reverse to show top layers first (Fabric stores bottom-up)\r\n    setObjects([...objs].reverse()); // Update state with reversed objects\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!canvas) return; // Exit if canvas is not available\r\n\r\n    let timeout: NodeJS.Timeout; // Variable for debounce timeout\r\n    const debouncedUpdate = () => {\r\n      clearTimeout(timeout); // Clear previous timeout\r\n      timeout = setTimeout(updateObjects, 100); // Set new timeout for update\r\n    };\r\n\r\n    canvas.on('object:added', debouncedUpdate); // Listen for object addition\r\n    canvas.on('object:removed', debouncedUpdate); // Listen for object removal\r\n    canvas.on('object:modified', debouncedUpdate); // Listen for object modification\r\n\r\n    updateObjects(); // Initial update\r\n\r\n    return () => {\r\n      canvas.off('object:added', debouncedUpdate); // Cleanup listener\r\n      canvas.off('object:removed', debouncedUpdate); // Cleanup listener\r\n      canvas.off('object:modified', debouncedUpdate); // Cleanup listener\r\n      clearTimeout(timeout); // Clear timeout\r\n    };\r\n  }, [canvas]); // Re-run effect when canvas changes\r\n\r\n  const handleDragEnd = (event: DragEndEvent) => {\r\n    const { active, over } = event; // Destructure active and over items\r\n\r\n    if (over && active.id !== over.id) {\r\n      // Check if dropped on a different item\r\n      const oldIndex = objects.findIndex((obj: any) => obj.uid === active.id); // Find index of dragged item\r\n      const newIndex = objects.findIndex((obj: any) => obj.uid === over.id); // Find index of target item\r\n\r\n      if (oldIndex !== -1 && newIndex !== -1) {\r\n        // Ensure both indices are valid\r\n        // Calculate fabric indices (reversed)\r\n        // objects[0] is Top (Fabric index N-1)\r\n        // objects[N-1] is Bottom (Fabric index 0)\r\n\r\n        // We want to move the object at oldIndex to newIndex in the UI list.\r\n        // In Fabric, we need to calculate the target index.\r\n\r\n        // Example: [A, B, C] (UI) -> [C, B, A] (Fabric)\r\n        // Move A (0) to 1. Result: [B, A, C] (UI) -> [C, A, B] (Fabric)\r\n\r\n        // The target index in Fabric corresponds to the new position in the UI list.\r\n        // If we move to UI index `newIndex`, it means it should be at `objects.length - 1 - newIndex` in Fabric?\r\n        // Let's verify.\r\n        // If newIndex is 0 (Top), fabric index should be length-1.\r\n        // If newIndex is length-1 (Bottom), fabric index should be 0.\r\n        // So yes, fabricNewIndex = objects.length - 1 - newIndex.\r\n\r\n        const fabricNewIndex = objects.length - 1 - newIndex; // Calculate new index for Fabric\r\n        const obj = objects[oldIndex]; // Get the object being moved\r\n\r\n        canvas?.moveObjectTo(obj, fabricNewIndex); // Move object in Fabric canvas\r\n        canvas?.requestRenderAll(); // Request re-render\r\n        history.saveState(); // Save state to history\r\n        updateObjects(); // Update local state\r\n      }\r\n    }\r\n  };\r\n\r\n  const toggleVisibility = (obj: FabricObject, e: React.MouseEvent) => {\r\n    e.stopPropagation(); // Prevent event bubbling\r\n    obj.visible = !obj.visible; // Toggle visibility property\r\n    if (!obj.visible) {\r\n      canvas?.discardActiveObject(); // Deselect if hidden\r\n    }\r\n    canvas?.requestRenderAll(); // Request re-render\r\n    history.saveState(); // Save state to history\r\n    // Force update\r\n    setObjects([...(canvas?.getObjects() || [])].reverse()); // Update local state\r\n  };\r\n\r\n  const toggleLock = (obj: FabricObject, e: React.MouseEvent) => {\r\n    e.stopPropagation(); // Prevent event bubbling\r\n    obj.lockMovementX = !obj.lockMovementX; // Toggle X movement lock\r\n    obj.lockMovementY = !obj.lockMovementY; // Toggle Y movement lock\r\n    obj.lockRotation = !obj.lockRotation; // Toggle rotation lock\r\n    obj.lockScalingX = !obj.lockScalingX; // Toggle X scaling lock\r\n    obj.lockScalingY = !obj.lockScalingY; // Toggle Y scaling lock\r\n    obj.selectable = !obj.lockMovementX; // If locked, not selectable\r\n\r\n    if (!obj.selectable) {\r\n      canvas?.discardActiveObject(); // Deselect if not selectable\r\n    }\r\n\r\n    canvas?.requestRenderAll(); // Request re-render\r\n    history.saveState(); // Save state to history\r\n    setObjects([...(canvas?.getObjects() || [])].reverse()); // Update local state\r\n  };\r\n\r\n  const selectObject = (obj: FabricObject) => {\r\n    if (!canvas || !obj.visible || !obj.selectable) return; // Exit if not selectable\r\n    canvas.setActiveObject(obj); // Set active object in canvas\r\n    canvas.requestRenderAll(); // Request re-render\r\n  };\r\n\r\n  const deleteObject = (obj: FabricObject, e: React.MouseEvent) => {\r\n    e.stopPropagation(); // Prevent event bubbling\r\n    canvas?.remove(obj); // Remove object from canvas\r\n    canvas?.requestRenderAll(); // Request re-render\r\n    history.saveState(); // Save state to history\r\n  };\r\n\r\n  return (\r\n    <div style={{ marginTop: 16 }}>\r\n      {' '}\r\n      {/* Container with top margin */}\r\n      <Title level={5}>Layers</Title> {/* Panel title */}\r\n      <DndContext sensors={sensors} collisionDetection={closestCenter} onDragEnd={handleDragEnd}>\r\n        {' '}\r\n        {/* DnD Context */}\r\n        <SortableContext\r\n          items={objects.map((obj: any) => obj.uid)} // Items to be sorted\r\n          strategy={verticalListSortingStrategy} // Sorting strategy\r\n        >\r\n          <div\r\n            style={{\r\n              maxHeight: 300, // Maximum height\r\n              overflowY: 'auto', // Vertical scroll if needed\r\n              border: '1px solid #d9d9d9', // Border style\r\n              borderRadius: 4, // Rounded corners\r\n              padding: 4, // Padding\r\n            }}\r\n          >\r\n            {objects.map((item: any, index) => {\r\n              // Iterate over objects\r\n              const isSelected = selectedObject === item; // Check if selected\r\n              const type = item.type || 'Object'; // Get object type\r\n              const name = item.name || `${type} ${objects.length - index}`; // Generate name\r\n\r\n              return (\r\n                <SortableItem\r\n                  key={item.uid} // Unique key\r\n                  id={item.uid} // Sortable ID\r\n                  isSelected={isSelected} // Selection state\r\n                  onClick={() => selectObject(item)} // Click handler\r\n                >\r\n                  <div\r\n                    style={{\r\n                      display: 'flex', // Flexbox layout\r\n                      alignItems: 'center', // Center items vertically\r\n                      width: '100%', // Full width\r\n                      justifyContent: 'space-between', // Space between content\r\n                    }}\r\n                  >\r\n                    <span\r\n                      style={{\r\n                        overflow: 'hidden', // Hide overflow\r\n                        textOverflow: 'ellipsis', // Show ellipsis\r\n                        whiteSpace: 'nowrap', // No wrap\r\n                        maxWidth: 120, // Max width for text\r\n                      }}\r\n                    >\r\n                      {name} {/* Display name */}\r\n                    </span>\r\n                    <Space size={4}>\r\n                      {' '}\r\n                      {/* Space between buttons */}\r\n                      <Button\r\n                        type=\"text\" // Text button style\r\n                        size=\"small\" // Small size\r\n                        icon={item.visible ? <EyeOutlined /> : <EyeInvisibleOutlined />} // Visibility icon\r\n                        onClick={(e) => toggleVisibility(item, e)} // Toggle visibility handler\r\n                        onMouseDown={(e) => e.stopPropagation()} // Prevent drag start\r\n                      />\r\n                      <Button\r\n                        type=\"text\" // Text button style\r\n                        size=\"small\" // Small size\r\n                        icon={item.lockMovementX ? <LockOutlined /> : <UnlockOutlined />} // Lock icon\r\n                        onClick={(e) => toggleLock(item, e)} // Toggle lock handler\r\n                        onMouseDown={(e) => e.stopPropagation()} // Prevent drag start\r\n                      />\r\n                      <Button\r\n                        type=\"text\" // Text button style\r\n                        size=\"small\" // Small size\r\n                        danger // Danger style (red)\r\n                        icon={<DeleteOutlined />} // Delete icon\r\n                        onClick={(e) => deleteObject(item, e)} // Delete handler\r\n                        onMouseDown={(e) => e.stopPropagation()} // Prevent drag start\r\n                      />\r\n                    </Space>\r\n                  </div>\r\n                </SortableItem>\r\n              );\r\n            })}\r\n          </div>\r\n        </SortableContext>\r\n      </DndContext>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LayersPanel; // Export component\r\n","// This icon file is generated automatically.\nvar VerticalAlignTopOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z\" } }] }, \"name\": \"vertical-align-top\", \"theme\": \"outlined\" };\nexport default VerticalAlignTopOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport VerticalAlignTopOutlinedSvg from \"@ant-design/icons-svg/es/asn/VerticalAlignTopOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar VerticalAlignTopOutlined = function VerticalAlignTopOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: VerticalAlignTopOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(VerticalAlignTopOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'VerticalAlignTopOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar VerticalAlignBottomOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z\" } }] }, \"name\": \"vertical-align-bottom\", \"theme\": \"outlined\" };\nexport default VerticalAlignBottomOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport VerticalAlignBottomOutlinedSvg from \"@ant-design/icons-svg/es/asn/VerticalAlignBottomOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar VerticalAlignBottomOutlined = function VerticalAlignBottomOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: VerticalAlignBottomOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(VerticalAlignBottomOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'VerticalAlignBottomOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar GroupOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"defs\", \"attrs\": {}, \"children\": [{ \"tag\": \"style\", \"attrs\": {} }] }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M912 820.1V203.9c28-9.9 48-36.6 48-67.9 0-39.8-32.2-72-72-72-31.3 0-58 20-67.9 48H203.9C194 84 167.3 64 136 64c-39.8 0-72 32.2-72 72 0 31.3 20 58 48 67.9v616.2C84 830 64 856.7 64 888c0 39.8 32.2 72 72 72 31.3 0 58-20 67.9-48h616.2c9.9 28 36.6 48 67.9 48 39.8 0 72-32.2 72-72 0-31.3-20-58-48-67.9zM888 112c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zM136 912c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-752c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm704 680H184V184h656v656zm48 72c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M288 474h448c8.8 0 16-7.2 16-16V282c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64zm-56 420h448c8.8 0 16-7.2 16-16V566c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64z\" } }] }, \"name\": \"group\", \"theme\": \"outlined\" };\nexport default GroupOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport GroupOutlinedSvg from \"@ant-design/icons-svg/es/asn/GroupOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar GroupOutlined = function GroupOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: GroupOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(GroupOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'GroupOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar UngroupOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"defs\", \"attrs\": {}, \"children\": [{ \"tag\": \"style\", \"attrs\": {} }] }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M736 550H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16h448c8.8 0 16-7.2 16-16V566c0-8.8-7.2-16-16-16zm-56 136H344v-64h336v64zm208 130c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm0 96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zM736 266H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16h448c8.8 0 16-7.2 16-16V282c0-8.8-7.2-16-16-16zm-56 136H344v-64h336v64zm208-194c39.8 0 72-32.2 72-72s-32.2-72-72-72-72 32.2-72 72 32.2 72 72 72zm0-96c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zM136 64c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm0 96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0 656c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm0 96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z\" } }] }, \"name\": \"ungroup\", \"theme\": \"outlined\" };\nexport default UngroupOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport UngroupOutlinedSvg from \"@ant-design/icons-svg/es/asn/UngroupOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar UngroupOutlined = function UngroupOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: UngroupOutlinedSvg\n  }));\n};\nvar RefIcon = /*#__PURE__*/React.forwardRef(UngroupOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'UngroupOutlined';\n}\nexport default RefIcon;","import React from 'react';\r\nimport { Button, Space, Tooltip, Typography } from 'antd';\r\nimport {\r\n  AlignLeftOutlined,\r\n  AlignCenterOutlined,\r\n  AlignRightOutlined,\r\n  VerticalAlignTopOutlined,\r\n  VerticalAlignMiddleOutlined,\r\n  VerticalAlignBottomOutlined,\r\n  GroupOutlined,\r\n  UngroupOutlined,\r\n} from '@ant-design/icons';\r\nimport { useVectorEditor } from '../context';\r\nimport { ActiveSelection, Group } from 'fabric';\r\n\r\nconst { Title } = Typography;\r\n\r\nconst AlignmentPanel: React.FC = () => {\r\n  const { canvas, selectedObject, history } = useVectorEditor();\r\n\r\n  const align = (position: string) => {\r\n    if (!canvas || !selectedObject) return;\r\n\r\n    const activeObj = selectedObject;\r\n    const canvasWidth = canvas.width || 0;\r\n    const canvasHeight = canvas.height || 0;\r\n\r\n    switch (position) {\r\n      case 'left':\r\n        activeObj.set({ left: 0 });\r\n        break;\r\n      case 'center':\r\n        canvas.centerObjectH(activeObj);\r\n        break;\r\n      case 'right':\r\n        activeObj.set({ left: canvasWidth - (activeObj.width || 0) * (activeObj.scaleX || 1) });\r\n        break;\r\n      case 'top':\r\n        activeObj.set({ top: 0 });\r\n        break;\r\n      case 'middle':\r\n        canvas.centerObjectV(activeObj);\r\n        break;\r\n      case 'bottom':\r\n        activeObj.set({ top: canvasHeight - (activeObj.height || 0) * (activeObj.scaleY || 1) });\r\n        break;\r\n    }\r\n\r\n    activeObj.setCoords();\r\n    canvas.requestRenderAll();\r\n    history.saveState();\r\n  };\r\n\r\n  const groupObjects = () => {\r\n    if (!canvas) return;\r\n    const activeObj = canvas.getActiveObject();\r\n    if (!activeObj || activeObj.type !== 'activeSelection') return;\r\n\r\n    (activeObj as any).toGroup();\r\n    canvas.requestRenderAll();\r\n    history.saveState();\r\n  };\r\n\r\n  const ungroupObjects = () => {\r\n    if (!canvas) return;\r\n    const activeObj = canvas.getActiveObject();\r\n    if (!activeObj || activeObj.type !== 'group') return;\r\n\r\n    (activeObj as any).toActiveSelection();\r\n    canvas.requestRenderAll();\r\n    history.saveState();\r\n  };\r\n\r\n  if (!selectedObject) return null;\r\n\r\n  return (\r\n    <div style={{ marginBottom: 16 }}>\r\n      <Title level={5}>Alignment & Grouping</Title>\r\n      <Space wrap>\r\n        <Tooltip title=\"Align Left\">\r\n          <Button size=\"small\" icon={<AlignLeftOutlined />} onClick={() => align('left')} />\r\n        </Tooltip>\r\n        <Tooltip title=\"Align Center\">\r\n          <Button size=\"small\" icon={<AlignCenterOutlined />} onClick={() => align('center')} />\r\n        </Tooltip>\r\n        <Tooltip title=\"Align Right\">\r\n          <Button size=\"small\" icon={<AlignRightOutlined />} onClick={() => align('right')} />\r\n        </Tooltip>\r\n        <Tooltip title=\"Align Top\">\r\n          <Button size=\"small\" icon={<VerticalAlignTopOutlined />} onClick={() => align('top')} />\r\n        </Tooltip>\r\n        <Tooltip title=\"Align Middle\">\r\n          <Button\r\n            size=\"small\"\r\n            icon={<VerticalAlignMiddleOutlined />}\r\n            onClick={() => align('middle')}\r\n          />\r\n        </Tooltip>\r\n        <Tooltip title=\"Align Bottom\">\r\n          <Button\r\n            size=\"small\"\r\n            icon={<VerticalAlignBottomOutlined />}\r\n            onClick={() => align('bottom')}\r\n          />\r\n        </Tooltip>\r\n      </Space>\r\n      <div style={{ marginTop: 8 }}>\r\n        <Space>\r\n          <Tooltip title=\"Group\">\r\n            <Button size=\"small\" icon={<GroupOutlined />} onClick={groupObjects} />\r\n          </Tooltip>\r\n          <Tooltip title=\"Ungroup\">\r\n            <Button size=\"small\" icon={<UngroupOutlined />} onClick={ungroupObjects} />\r\n          </Tooltip>\r\n        </Space>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AlignmentPanel;\r\n","import React from 'react';\r\nimport { PageContainer } from '@ant-design/pro-components';\r\nimport { Card, Layout } from 'antd';\r\nimport { VectorEditorProvider } from './context';\r\nimport Toolbar from './components/Toolbar';\r\nimport CanvasArea from './components/CanvasArea';\r\nimport PropertiesPanel from './components/PropertiesPanel';\r\nimport LayersPanel from './components/LayersPanel';\r\nimport AlignmentPanel from './components/AlignmentPanel';\r\nimport styles from './styles.less';\r\n\r\nconst { Sider, Content } = Layout;\r\n\r\nconst VectorEditor: React.FC = () => {\r\n  return (\r\n    <PageContainer title=\"Vector Editor\">\r\n      <VectorEditorProvider>\r\n        <Card className={styles.editorContainer} bodyStyle={{ padding: 0, height: '100%' }}>\r\n          <Layout style={{ height: '80vh' }}>\r\n            <Sider theme=\"light\" width={60} className={styles.toolbarSider}>\r\n              <Toolbar />\r\n            </Sider>\r\n            <Content className={styles.canvasContent}>\r\n              <CanvasArea />\r\n            </Content>\r\n            <Sider theme=\"light\" width={300} className={styles.propertiesSider}>\r\n              <AlignmentPanel />\r\n              <PropertiesPanel />\r\n              <LayersPanel />\r\n            </Sider>\r\n          </Layout>\r\n        </Card>\r\n      </VectorEditorProvider>\r\n    </PageContainer>\r\n  );\r\n};\r\n\r\nexport default VectorEditor;\r\n","\nimport \"E:/code/ultimate-tool-web/src/pages/VectorEditor/styles.less?modules\";\nexport default {\"toolbarSider\": `toolbarSider-BKEaDzGP`,\"propertiesSider\": `propertiesSider-yOFoKBXl`,\"editorContainer\": `editorContainer-wzVvIv-F`,\"canvasContent\": `canvasContent-oiFhzarp`}\n","import { useState, useCallback } from 'react';\r\nimport { Canvas } from 'fabric';\r\n\r\nexport const useHistory = (canvas: Canvas | null) => {\r\n  const [history, setHistory] = useState<string[]>([]);\r\n  const [historyIndex, setHistoryIndex] = useState<number>(-1);\r\n  const [isHistoryProcessing, setIsHistoryProcessing] = useState<boolean>(false);\r\n\r\n  const saveState = useCallback(() => {\r\n    if (!canvas || isHistoryProcessing) return;\r\n\r\n    const json = JSON.stringify(canvas.toJSON());\r\n\r\n    // If we are in the middle of the history, discard the future\r\n    const newHistory = history.slice(0, historyIndex + 1);\r\n    newHistory.push(json);\r\n\r\n    // Limit history size if needed (e.g., 50)\r\n    if (newHistory.length > 50) {\r\n      newHistory.shift();\r\n    }\r\n\r\n    setHistory(newHistory);\r\n    setHistoryIndex(newHistory.length - 1);\r\n  }, [canvas, history, historyIndex, isHistoryProcessing]);\r\n\r\n  const undo = useCallback(() => {\r\n    if (!canvas || historyIndex <= 0 || isHistoryProcessing) return;\r\n\r\n    setIsHistoryProcessing(true);\r\n    const newIndex = historyIndex - 1;\r\n    const json = history[newIndex];\r\n\r\n    canvas.loadFromJSON(JSON.parse(json), () => {\r\n      canvas.renderAll();\r\n      setHistoryIndex(newIndex);\r\n      setIsHistoryProcessing(false);\r\n    });\r\n  }, [canvas, history, historyIndex, isHistoryProcessing]);\r\n\r\n  const redo = useCallback(() => {\r\n    if (!canvas || historyIndex >= history.length - 1 || isHistoryProcessing) return;\r\n\r\n    setIsHistoryProcessing(true);\r\n    const newIndex = historyIndex + 1;\r\n    const json = history[newIndex];\r\n\r\n    canvas.loadFromJSON(JSON.parse(json), () => {\r\n      canvas.renderAll();\r\n      setHistoryIndex(newIndex);\r\n      setIsHistoryProcessing(false);\r\n    });\r\n  }, [canvas, history, historyIndex, isHistoryProcessing]);\r\n\r\n  return {\r\n    saveState,\r\n    undo,\r\n    redo,\r\n    canUndo: historyIndex > 0,\r\n    canRedo: historyIndex < history.length - 1,\r\n  };\r\n};\r\n","import React, { createContext, useContext, useState } from 'react';\r\nimport { Canvas, FabricObject } from 'fabric';\r\nimport { useHistory } from './hooks/useHistory';\r\n\r\ninterface VectorEditorContextType {\r\n  canvas: Canvas | null;\r\n  setCanvas: (canvas: Canvas) => void;\r\n  selectedObject: FabricObject | null;\r\n  setSelectedObject: (object: FabricObject | null) => void;\r\n  activeTool: string;\r\n  setActiveTool: (tool: string) => void;\r\n  history: {\r\n    saveState: () => void;\r\n    undo: () => void;\r\n    redo: () => void;\r\n    canUndo: boolean;\r\n    canRedo: boolean;\r\n  };\r\n}\r\n\r\nconst VectorEditorContext = createContext<VectorEditorContextType | undefined>(undefined);\r\n\r\nexport const VectorEditorProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const [canvas, setCanvas] = useState<Canvas | null>(null);\r\n  const [selectedObject, setSelectedObject] = useState<FabricObject | null>(null);\r\n  const [activeTool, setActiveTool] = useState<string>('select');\r\n\r\n  const history = useHistory(canvas);\r\n\r\n  return (\r\n    <VectorEditorContext.Provider\r\n      value={{\r\n        canvas,\r\n        setCanvas,\r\n        selectedObject,\r\n        setSelectedObject,\r\n        activeTool,\r\n        setActiveTool,\r\n        history,\r\n      }}\r\n    >\r\n      {children}\r\n    </VectorEditorContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useVectorEditor = () => {\r\n  const context = useContext(VectorEditorContext);\r\n  if (!context) {\r\n    throw new Error('useVectorEditor must be used within a VectorEditorProvider');\r\n  }\r\n  return context;\r\n};\r\n"],"names":[],"mappings":"0mBACI,EAAe,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,OAAQ,EAAG,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,sSAAuS,CAAE,EAAE,AAAC,EAAG,KAAQ,OAAQ,MAAS,UAAW,2BCWze,EAAuB,EAAM,UAAU,CANxB,SAAsB,CAAK,CAAE,CAAG,EACjD,OAAoB,EAAM,aAAa,CAAC,SAAQ,CAAE,GAAA,SAAa,EAAC,GAAA,SAAa,EAAC,CAAC,EAAG,GAAQ,CAAC,EAAG,CAC5F,IAAK,EACL,KAAM,CACR,IACF,uSCFA,IAAM,GAA8C,CAAC,CAAE,KAAA,CAAI,CAAE,QAAA,CAAO,CAAE,IACpE,GAAM,CAAE,OAAA,CAAM,CAAE,QAAA,CAAO,CAAE,CAAG,GAAA,iBAAe,IACrC,CAAC,EAAK,CAAG,SAAI,CAAC,OAAO,GAwBrB,EAAgB,CACpB,gBAAiB,OAAA,SAAA,EAAQ,eAAe,GAAI,UAC5C,KAAK,OAAE,SAAA,EAAQ,KAAK,CACpB,MAAM,OAAE,SAAA,EAAQ,MAAM,AACxB,EAEA,MACE,UAAC,SAAK,EAAC,MAAM,kBAAkB,KAAM,EAAM,SAAU,EAAS,OAAQ,KAAM,eAAe,aACzF,WAAC,SAAI,EACH,KAAM,EACN,OAAO,WACP,cAAe,EACf,eAlCqB,CAAC,EAAoB,KAC9C,GAAK,GAEL,GAAI,EAAc,eAAe,CAAE,CACjC,IAAM,EACJ,AAAyC,UAAzC,OAAO,EAAc,eAAe,CAChC,EAAc,eAAe,CAC7B,EAAc,eAAe,CAAC,WAAW,GAC/C,EAAO,eAAe,CAAG,EACzB,EAAO,gBAAgB,GAEzB,CAEI,CAAA,EAAc,KAAK,EAAI,EAAc,MAAM,AAAD,IAC5C,EAAO,aAAa,CAAC,CACnB,MAAO,EAAU,KAAK,EAAI,EAAO,KAAK,CACtC,OAAQ,EAAU,MAAM,EAAI,EAAO,MAAM,AAC3C,GACA,EAAO,gBAAgB,KAE3B,YAgBM,UAAC,SAAI,CAAC,IAAI,EAAC,MAAM,mBAAmB,KAAK,2BACvC,UAAC,SAAW,EAAC,QAAQ,QAEvB,UAAC,SAAI,CAAC,IAAI,EAAC,MAAM,eAAe,KAAK,iBACnC,UAAC,UAAW,OAEd,UAAC,SAAI,CAAC,IAAI,EAAC,MAAM,gBAAgB,KAAK,kBACpC,UAAC,UAAW,YAKtB,ECvCM,GAAoB,KACxB,GAAM,CAAE,OAAA,CAAM,CAAE,WAAA,CAAU,CAAE,cAAA,CAAa,CAAE,QAAA,CAAO,CAAE,CAAG,GAAA,iBAAe,IAChE,CAAC,EAAc,EAAgB,CAAG,SAAK,CAAC,QAAQ,CAAC,CAAA,GAoHvD,MACE,WAAC,SAAK,EAAC,UAAU,WAAW,KAAK,kBAC/B,UAAC,SAAO,EAAC,MAAM,sBACb,UAAC,SAAM,EACL,KAAM,AAAe,WAAf,EAA0B,UAAY,UAC5C,KAAM,UAAC,SAAY,KACnB,QAAS,IAAM,EAAc,cAIjC,UAAC,SAAO,EAAC,MAAM,2BACb,UAAC,SAAM,EACL,KAAM,AAAe,QAAf,EAAuB,UAAY,UACzC,KAAM,UAAC,SAAY,KACnB,QAAS,IAAM,EAAc,WAIjC,UAAC,SAAO,EAAC,MAAO,CAAE,OAAQ,OAAQ,IAElC,UAAC,SAAO,EAAC,MAAM,yBACb,UAAC,SAAM,EAAC,KAAM,UAAC,SAAc,KAAK,QAvInB,KACnB,GAAI,CAAC,EAAQ,OACb,IAAM,EAAO,IAAI,MAAI,CAAC,CACpB,KAAM,IACN,IAAK,IACL,KAAM,UACN,MAAO,IACP,OAAQ,GACV,GACA,EAAO,GAAG,CAAC,GACX,EAAO,eAAe,CAAC,GACvB,EAAc,UAChB,MA8HI,UAAC,SAAO,EAAC,MAAM,sBACb,UAAC,SAAM,EAAC,KAAM,UAAC,GAAa,OAAQ,KAAQ,QA7HhC,KAChB,GAAI,CAAC,EAAQ,OACb,IAAM,EAAS,IAAI,QAAM,CAAC,CACxB,KAAM,IACN,IAAK,IACL,KAAM,UACN,OAAQ,EACV,GACA,EAAO,GAAG,CAAC,GACX,EAAO,eAAe,CAAC,GACvB,EAAc,UAChB,MAqHI,UAAC,SAAO,EAAC,MAAM,oBACb,UAAC,SAAM,EAAC,KAAM,UAAC,SAAgB,KAAK,QApH1B,KACd,GAAI,CAAC,EAAQ,OACb,IAAM,EAAO,IAAI,OAAK,CAAC,YAAa,CAClC,KAAM,IACN,IAAK,IACL,WAAY,QACZ,KAAM,OACN,SAAU,EACZ,GACA,EAAO,GAAG,CAAC,GACX,EAAO,eAAe,CAAC,GACvB,EAAc,UAChB,MA2GI,UAAC,SAAO,EAAC,MAAM,mBACb,UAAC,SAAM,EACL,KAAM,AAAe,QAAf,EAAuB,UAAY,UACzC,KAAM,UAAC,SAAY,KACnB,QAAS,IAAM,EAAc,WAIjC,UAAC,SAAO,EAAC,MAAO,CAAE,OAAQ,OAAQ,IAElC,UAAC,SAAO,EAAC,MAAM,yBACb,UAAC,SAAM,EAAC,KAAM,UAAC,SAAY,KAAK,QAAS,EAAQ,IAAI,CAAE,SAAU,CAAC,EAAQ,OAAO,KAGnF,UAAC,SAAO,EAAC,MAAM,+BACb,UAAC,SAAM,EAAC,KAAM,UAAC,SAAY,KAAK,QAAS,EAAQ,IAAI,CAAE,SAAU,CAAC,EAAQ,OAAO,KAGnF,UAAC,SAAO,EAAC,MAAO,CAAE,OAAQ,OAAQ,IAElC,UAAC,SAAO,EAAC,MAAM,wBACb,UAAC,SAAM,EAAC,KAAM,UAAC,SAAc,KAAK,MAAM,IAAC,QA9H3B,KACb,IACL,EAAO,KAAK,GACZ,EAAO,eAAe,CAAG,UACzB,EAAO,SAAS,GAChB,EAAQ,SAAS,IACnB,MA2HI,UAAC,SAAO,EAAC,MAAM,sBACb,UAAC,SAAM,EAAC,KAAM,UAAC,SAAgB,KAAK,QA1HxB,SAWZ,EAVJ,GAAI,CAAC,EAAQ,OAGb,IAAM,EAAa,EAAO,eAAe,CAGzC,EAAO,eAAe,CAAG,cAGzB,IAAM,EAAU,EAAO,UAAU,GAGjC,GAAI,EAAQ,MAAM,CAAG,EAAG,CACtB,IAAI,EAAO,IACT,EAAO,IACP,EAAO,CAAC,IACR,EAAO,CAAC,IAEV,EAAQ,OAAO,CAAC,AAAC,IACf,IAAM,EAAK,EAAI,eAAe,GAC1B,EAAG,IAAI,CAAG,GAAM,CAAA,EAAO,EAAG,IAAI,AAAD,EAC7B,EAAG,GAAG,CAAG,GAAM,CAAA,EAAO,EAAG,GAAG,AAAD,EAC3B,EAAG,IAAI,CAAG,EAAG,KAAK,CAAG,GAAM,CAAA,EAAO,EAAG,IAAI,CAAG,EAAG,KAAK,AAAD,EACnD,EAAG,GAAG,CAAG,EAAG,MAAM,CAAG,GAAM,CAAA,EAAO,EAAG,GAAG,CAAG,EAAG,MAAM,AAAD,EACzD,GAIA,GADgB,GAEhB,GAFgB,GAGhB,GAHgB,GAIhB,GAJgB,GAMhB,IAAM,EAAQ,EAAO,EACf,EAAS,EAAO,EAEtB,EAAM,EAAO,KAAK,CAAC,CACjB,QAAS,CACP,EAAG,EACH,EAAG,EACH,MAAO,EACP,OAAQ,CACV,EACA,MAAO,EAAM,QAAQ,GACrB,OAAQ,EAAO,QAAQ,EACzB,GACF,MACE,EAAM,EAAO,KAAK,GAIpB,EAAO,eAAe,CAAG,EACzB,EAAO,gBAAgB,GAEvB,IAAM,EAAO,IAAI,KAAK,CAAC,EAAI,CAAE,CAAE,KAAM,eAAgB,GAC/C,EAAM,IAAI,eAAe,CAAC,GAC1B,EAAO,SAAS,aAAa,CAAC,KACpC,EAAK,IAAI,CAAG,EACZ,EAAK,QAAQ,CAAG,aAChB,SAAS,IAAI,CAAC,WAAW,CAAC,GAC1B,EAAK,KAAK,GACV,SAAS,IAAI,CAAC,WAAW,CAAC,GAC5B,MA8DI,UAAC,SAAO,EAAC,MAAM,oBACb,UAAC,SAAM,EAAC,KAAM,UAAC,SAAe,KAAK,QAAS,IAAM,EAAgB,CAAA,OAGpE,UAAC,IAAc,KAAM,EAAc,QAAS,IAAM,EAAgB,CAAA,QAGxE,ECzMa,GAAe,AAAC,IAC3B,GAAA,WAAS,EAAC,KACR,IAAM,EAAgB,AAAC,IAErB,GACE,SAAS,aAAa,YAAY,kBAClC,SAAS,aAAa,YAAY,oBAElC,OAGF,IAAM,EAAM,EAAE,GAAG,CAAC,WAAW,GACvB,EAAO,EAAE,OAAO,EAAI,EAAE,OAAO,CAC7B,EAAQ,EAAE,QAAQ,CAGpB,EAAY,GACZ,GAAM,CAAA,GAAa,OAAM,EACzB,GAAO,CAAA,GAAa,QAAO,EAG3B,CAAS,CAFb,GAAa,EAEW,EACtB,EAAE,cAAc,GAChB,CAAS,CAAC,EAAU,CAAC,KACZ,CAAS,CAAC,EAAI,EAIlB,GAAS,GACZ,CAAS,CAAC,EAAI,CAAC,GAGrB,EAGA,OADA,OAAO,gBAAgB,CAAC,UAAW,GAC5B,IAAM,OAAO,mBAAmB,CAAC,UAAW,GACrD,EAAG,CAAC,EAAU,EAChB,EC1Ba,GAAa,CAAC,EAAuB,KAChD,GAAM,CAAC,EAAW,EAAa,CAAG,GAAA,UAAQ,EAAC,CAAA,GACrC,EAAa,GAAA,QAAM,EAAc,MACjC,EAAS,GAAA,QAAM,EAAU,EAAE,EAC3B,EAAU,GAAA,QAAM,EAAW,EAAE,EAC7B,EAAa,GAAA,QAAM,EAAC,CAAA,GACpB,EAAiB,GAAA,QAAM,EAAkC,MACzD,EAAa,GAAA,QAAM,EAAc,MACjC,EAAc,GAAA,QAAM,EAAS,EAAE,EAE/B,EAAqB,CAAC,EAAc,EAAkB,CAAA,CAAK,IAC/D,GAAI,AAAe,IAAf,EAAI,MAAM,CAAQ,MAAO,GAE7B,IAAI,EAAI,CAAC,EAAE,EAAE,CAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAEnC,IAAK,IAAI,EAAI,EAAG,EAAI,EAAI,MAAM,CAAE,IAAK,CACnC,IAAM,EAAO,CAAG,CAAC,EAAE,CACb,EAAO,CAAG,CAAC,EAAI,EAAE,CAEvB,GAAI,EAAK,GAAG,EAAI,EAAK,GAAG,CAAE,CAExB,IAAM,EAAO,EAAK,GAAG,CAAG,EAAK,GAAG,CAAC,CAAC,CAAG,EAAK,CAAC,CACrC,EAAO,EAAK,GAAG,CAAG,EAAK,GAAG,CAAC,CAAC,CAAG,EAAK,CAAC,CACrC,EAAO,EAAK,GAAG,CAAG,EAAK,GAAG,CAAC,CAAC,CAAG,EAAK,CAAC,CACrC,EAAO,EAAK,GAAG,CAAG,EAAK,GAAG,CAAC,CAAC,CAAG,EAAK,CAAC,CAE3C,GAAK,CAAC,GAAG,EAAE,EAAK,CAAC,EAAE,EAAK,CAAC,EAAE,EAAK,CAAC,EAAE,EAAK,CAAC,EAAE,EAAK,CAAC,CAAC,CAAC,EAAE,EAAK,CAAC,CAAC,CAAC,CAC/D,MACE,GAAK,CAAC,GAAG,EAAE,EAAK,CAAC,CAAC,CAAC,EAAE,EAAK,CAAC,CAAC,CAAC,CAEjC,CAMA,OAJI,GACF,CAAA,GAAK,IAAG,EAGH,EACT,EAEM,EAAa,GAAA,aAAW,EAAC,KAC7B,GAAI,CAAC,GAAU,AAA0B,IAA1B,EAAO,OAAO,CAAC,MAAM,CAAQ,OAE5C,IAAM,EAAI,EAAmB,EAAO,OAAO,EAEvC,EAAW,OAAO,EACpB,EAAO,MAAM,CAAC,EAAW,OAAO,EAGlC,IAAM,EAAU,IAAI,MAAI,CAAC,EAAG,CAC1B,KAAM,GACN,OAAQ,QACR,YAAa,EACb,WAAY,CAAA,EACZ,QAAS,CAAA,EACT,cAAe,CAAA,CACjB,GACA,EAAQ,MAAM,CAAG,CAAA,EAEjB,EAAO,GAAG,CAAC,GACX,EAAO,gBAAgB,CAAC,GACxB,EAAW,OAAO,CAAG,EACrB,EAAO,gBAAgB,GACzB,EAAG,CAAC,EAAO,EAEL,EAAY,GAAA,aAAW,EAC3B,CAAC,EAAW,EAAW,EAAmB,CAAA,CAAK,IAC7C,GAAI,CAAC,EAAQ,OAEb,IAAM,EAAS,IAAI,QAAM,CAAC,CACxB,KAAM,EACN,IAAK,EACL,OAAQ,EACR,KAAM,EAAU,UAAY,UAC5B,OAAQ,OACR,YAAa,EACb,QAAS,SACT,QAAS,SACT,WAAY,CAAA,EACZ,QAAS,CAAA,EACT,YAAa,CAAA,EACb,WAAY,CAAA,CACd,GAMA,OALA,EAAO,MAAM,CAAG,CAAA,EAEhB,EAAO,GAAG,CAAC,GACX,EAAQ,OAAO,CAAC,IAAI,CAAC,GACrB,EAAO,gBAAgB,GAChB,EACT,EACA,CAAC,EAAO,EAGJ,EAAa,GAAA,aAAW,EAC5B,CAAC,EAAkB,CAAA,CAAK,IACtB,GAAI,CAAC,GAAU,CAAC,EAAW,OAAO,CAAE,OAEpC,IAAM,EAAI,EAAmB,EAAO,OAAO,CAAE,GAEzC,EAAW,OAAO,EAAE,EAAO,MAAM,CAAC,EAAW,OAAO,EACxD,EAAQ,OAAO,CAAC,OAAO,CAAC,AAAC,GAAM,EAAO,MAAM,CAAC,IAC7C,EAAQ,OAAO,CAAG,EAAE,CAEhB,EAAW,OAAO,GACpB,EAAO,MAAM,CAAC,EAAW,OAAO,EAChC,EAAW,OAAO,CAAG,MAGvB,EAAY,OAAO,CAAC,OAAO,CAAC,AAAC,GAAM,EAAO,MAAM,CAAC,IACjD,EAAY,OAAO,CAAG,EAAE,CAExB,IAAM,EAAY,IAAI,MAAI,CAAC,EAAG,CAC5B,KAAM,EAAS,UAAY,GAC3B,OAAQ,QACR,YAAa,EACb,WAAY,CAAA,EACZ,QAAS,CAAA,EACT,cAAe,CAAA,CACjB,GAEA,EAAO,GAAG,CAAC,GACX,EAAO,eAAe,CAAC,GAEvB,EAAa,CAAA,GACb,EAAW,OAAO,CAAG,KACrB,EAAO,OAAO,CAAG,EAAE,CACnB,EAAW,OAAO,CAAG,CAAA,EACrB,EAAe,OAAO,CAAG,KAErB,GAAa,IACjB,EAAO,gBAAgB,GACzB,EACA,CAAC,EAAQ,EAAY,EAGjB,EAAc,GAAA,aAAW,EAC7B,AAAC,IACC,GAAI,CAAC,EAAQ,OACb,IAAM,EAAU,EAAO,UAAU,CAAC,EAAE,CAAC,EAErC,GAAI,GAAa,EAAQ,OAAO,CAAC,MAAM,CAAG,EAAG,CAC3C,IAAM,EAAc,EAAQ,OAAO,CAAC,EAAE,CACtC,GAAI,EAAE,MAAM,GAAK,EAAa,CAC5B,EAAW,CAAA,GACX,OACF,CACA,GAAI,EAAQ,OAAO,CAAC,QAAQ,CAAC,EAAE,MAAM,EACnC,OAEJ,CAEK,GAMH,EAAO,OAAO,CAAC,IAAI,CAAC,CAAE,EAAG,EAAQ,CAAC,CAAE,EAAG,EAAQ,CAAC,AAAC,GACjD,EAAU,EAAQ,CAAC,CAAE,EAAQ,CAAC,IAN9B,EAAa,CAAA,GACb,EAAO,OAAO,CAAG,CAAC,CAAE,EAAG,EAAQ,CAAC,CAAE,EAAG,EAAQ,CAAC,AAAC,EAAE,CACjD,EAAU,EAAQ,CAAC,CAAE,EAAQ,CAAC,CAAE,CAAA,IAChC,IAOF,EAAW,OAAO,CAAG,CAAA,EACrB,EAAe,OAAO,CAAG,CAAE,EAAG,EAAQ,CAAC,CAAE,EAAG,EAAQ,CAAC,AAAC,EACxD,EACA,CAAC,EAAQ,EAAW,EAAY,EAAW,EAAW,EAGlD,EAAc,GAAA,aAAW,EAC7B,AAAC,IACC,GAAI,CAAC,GAAU,CAAC,EAAW,OAE3B,IAAM,EAAU,EAAO,UAAU,CAAC,EAAE,CAAC,EAErC,GAAI,EAAW,OAAO,EAAI,EAAO,OAAO,CAAC,MAAM,CAAG,EAAG,CAEnD,IAAM,EAAoB,EAAO,OAAO,CAAC,MAAM,CAAG,EAC5C,EAAe,EAAO,OAAO,CAAC,EAAkB,CAEhD,EAAK,EAAQ,CAAC,CAAG,EAAa,CAAC,CAC/B,EAAK,EAAQ,CAAC,CAAG,EAAa,CAAC,CAWrC,GATA,EAAa,GAAG,CAAG,CAAE,EAAG,EAAa,CAAC,CAAG,EAAI,EAAG,EAAa,CAAC,CAAG,CAAG,EACpE,EAAa,GAAG,CAAG,CAAE,EAAG,EAAa,CAAC,CAAG,EAAI,EAAG,EAAa,CAAC,CAAG,CAAG,EAEpE,IAGA,EAAY,OAAO,CAAC,OAAO,CAAC,AAAC,GAAM,EAAO,MAAM,CAAC,IACjD,EAAY,OAAO,CAAG,EAAE,CAEpB,EAAa,GAAG,CAAE,CACpB,IAAM,EAAK,IAAI,MAAI,CACjB,CAAC,EAAa,CAAC,CAAE,EAAa,CAAC,CAAE,EAAa,GAAG,CAAC,CAAC,CAAE,EAAa,GAAG,CAAC,CAAC,CAAC,CACxE,CACE,OAAQ,OACR,YAAa,EACb,WAAY,CAAA,EACZ,QAAS,CAAA,CACX,GAEF,EAAG,MAAM,CAAG,CAAA,EACZ,EAAO,GAAG,CAAC,GACX,EAAY,OAAO,CAAC,IAAI,CAAC,GAC3B,CACA,GAAI,EAAa,GAAG,CAAE,CACpB,IAAM,EAAK,IAAI,MAAI,CACjB,CAAC,EAAa,CAAC,CAAE,EAAa,CAAC,CAAE,EAAa,GAAG,CAAC,CAAC,CAAE,EAAa,GAAG,CAAC,CAAC,CAAC,CACxE,CACE,OAAQ,OACR,YAAa,EACb,WAAY,CAAA,EACZ,QAAS,CAAA,CACX,GAEF,EAAG,MAAM,CAAG,CAAA,EACZ,EAAO,GAAG,CAAC,GACX,EAAY,OAAO,CAAC,IAAI,CAAC,GAC3B,CAGI,EAAW,OAAO,GACpB,EAAO,MAAM,CAAC,EAAW,OAAO,EAChC,EAAW,OAAO,CAAG,MAEzB,MAAO,GAAI,EAAO,OAAO,CAAC,MAAM,CAAG,EAAG,CAEpC,IAAM,EAAY,EAAO,OAAO,CAAC,EAAO,OAAO,CAAC,MAAM,CAAG,EAAE,CACvD,EAAI,CAAC,EAAE,EAAE,EAAU,CAAC,CAAC,CAAC,EAAE,EAAU,CAAC,CAAC,CAAC,CAErC,EAAU,GAAG,CAEf,GAAK,CAAC,GAAG,EAAE,EAAU,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAU,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,EAAQ,CAAC,CAAC,CAAC,EAAE,EAAQ,CAAC,CAAC,CAAC,EAAE,EAAQ,CAAC,CAAC,CAAC,EAAE,EAAQ,CAAC,CAAC,CAAC,CAGnG,GAAK,CAAC,GAAG,EAAE,EAAQ,CAAC,CAAC,CAAC,EAAE,EAAQ,CAAC,CAAC,CAAC,CAGjC,EAAW,OAAO,EACpB,EAAO,MAAM,CAAC,EAAW,OAAO,EAGlC,IAAM,EAAK,IAAI,MAAI,CAAC,EAAG,CACrB,KAAM,GACN,OAAQ,OACR,YAAa,EACb,gBAAiB,CAAC,EAAG,EAAE,CACvB,WAAY,CAAA,EACZ,QAAS,CAAA,CACX,GACA,EAAG,MAAM,CAAG,CAAA,EACZ,EAAO,GAAG,CAAC,GACX,EAAW,OAAO,CAAG,EACrB,EAAO,gBAAgB,GACzB,CACF,EACA,CAAC,EAAQ,EAAW,EAAW,EAwBjC,MAAO,CACL,UAAA,EACA,YAAA,EACA,YAAA,EACA,UAzBgB,GAAA,aAAW,EAC3B,AAAC,IACC,EAAW,OAAO,CAAG,CAAA,EACrB,EAAe,OAAO,CAAG,KAErB,IACF,EAAY,OAAO,CAAC,OAAO,CAAC,AAAC,GAAM,EAAO,MAAM,CAAC,IACjD,EAAY,OAAO,CAAG,EAAE,CACxB,EAAO,gBAAgB,IAE3B,EACA,CAAC,EAAO,EAeR,cAZoB,GAAA,aAAW,EAC/B,AAAC,IACC,EAAW,CAAA,GACb,EACA,CAAC,EAAW,EASZ,WAAA,CACF,EACF,EC1SM,GAAuB,KAC3B,IAAM,EAAY,GAAA,QAAM,EAAoB,MACtC,EAAe,GAAA,QAAM,EAAiB,MACtC,CAAE,UAAA,CAAS,CAAE,kBAAA,CAAiB,CAAE,WAAA,CAAU,CAAE,cAAA,CAAa,CAAE,QAAA,CAAO,CAAE,OAAA,CAAM,CAAE,CAChF,GAAA,iBAAe,IAEX,EAAU,GAAW,EAAQ,EAAQ,SAAS,EAiNpD,MA9MA,GAAA,WAAS,EAAC,KACR,GAAI,CAAC,EAAU,OAAO,EAAI,CAAC,EAAa,OAAO,CAAE,OAEjD,IAAM,EAAe,IAAI,QAAM,CAAC,EAAU,OAAO,CAAE,CACjD,MAAO,EAAa,OAAO,CAAC,WAAW,CACvC,OAAQ,EAAa,OAAO,CAAC,YAAY,CACzC,gBAAiB,UACjB,UAAW,CAAA,CACb,GAEA,EAAU,GAGV,IAAM,EAAkB,KACtB,IAAM,EAAgB,EAAa,gBAAgB,GAC/C,AAAyB,IAAzB,EAAc,MAAM,CACtB,EAAkB,CAAa,CAAC,EAAE,EAElC,EAAkB,MAEtB,EAEA,EAAa,EAAE,CAAC,oBAAqB,GACrC,EAAa,EAAE,CAAC,oBAAqB,GACrC,EAAa,EAAE,CAAC,oBAAqB,IAAM,EAAkB,OAG7D,IAAM,EAAc,AAAC,IAEf,EAAE,MAAM,EAAI,EAAE,MAAM,CAAC,MAAM,EAC/B,EAAQ,SAAS,GACnB,EAEA,EAAa,EAAE,CAAC,kBAAmB,GACnC,EAAa,EAAE,CAAC,eAAgB,GAChC,EAAa,EAAE,CAAC,iBAAkB,GAGlC,EAAa,EAAE,CAAC,cAAe,AAAC,IAC9B,IAAM,EAAQ,EAAI,CAAC,CAAC,MAAM,CACtB,EAAO,EAAa,OAAO,GAC/B,CAAA,GAAQ,MAAS,CAAI,EACV,IAAI,CAAA,EAAO,EAAC,EACnB,EAAO,KAAM,CAAA,EAAO,GAAG,EAC3B,EAAa,WAAW,CAAC,IAAI,OAAK,CAAC,EAAI,CAAC,CAAC,OAAO,CAAE,EAAI,CAAC,CAAC,OAAO,EAAG,GAClE,EAAI,CAAC,CAAC,cAAc,GACpB,EAAI,CAAC,CAAC,eAAe,GACvB,GAEA,IAAM,EAAe,KACf,EAAa,OAAO,EACtB,EAAa,aAAa,CAAC,CACzB,MAAO,EAAa,OAAO,CAAC,WAAW,CACvC,OAAQ,EAAa,OAAO,CAAC,YAAY,AAC3C,GAEJ,EAIA,OAFA,OAAO,gBAAgB,CAAC,SAAU,GAE3B,KACL,EAAa,OAAO,GACpB,OAAO,mBAAmB,CAAC,SAAU,GACvC,EACF,EAAG,EAAE,EAGL,GAAA,WAAS,EAAC,KACH,IAEL,EAAO,aAAa,CAAG,CAAA,EAEnB,AAAe,QAAf,GACF,EAAO,aAAa,CAAG,OACvB,EAAO,SAAS,CAAG,CAAA,EACnB,EAAO,aAAa,CAAC,AAAC,IACpB,EAAI,UAAU,CAAG,CAAA,EACjB,EAAI,OAAO,CAAG,CAAA,EAChB,IACS,AAAe,QAAf,GACT,EAAO,aAAa,CAAG,YACvB,EAAO,SAAS,CAAG,CAAA,EACnB,EAAO,aAAa,CAAC,AAAC,IACpB,EAAI,UAAU,CAAG,CAAA,EACjB,EAAI,OAAO,CAAG,CAAA,EAChB,KAEA,EAAO,aAAa,CAAG,UACvB,EAAO,SAAS,CAAG,CAAA,EACnB,EAAO,aAAa,CAAC,AAAC,IACpB,EAAI,UAAU,CAAG,CAAA,EACjB,EAAI,OAAO,CAAG,CAAA,EAChB,IAGF,EAAO,gBAAgB,IACzB,EAAG,CAAC,EAAY,EAAO,EAGvB,GAAA,WAAS,EAAC,KACR,GAAI,CAAC,GAAU,AAAe,QAAf,EAAsB,OAErC,IAAM,EAAc,AAAC,GAAa,EAAQ,WAAW,CAAC,GAChD,EAAc,AAAC,GAAa,EAAQ,WAAW,CAAC,GAChD,EAAY,AAAC,GAAa,EAAQ,SAAS,CAAC,GAC5C,EAAgB,AAAC,GAAa,EAAQ,aAAa,CAAC,GAO1D,OALA,EAAO,EAAE,CAAC,aAAc,GACxB,EAAO,EAAE,CAAC,aAAc,GACxB,EAAO,EAAE,CAAC,WAAY,GACtB,EAAO,EAAE,CAAC,iBAAkB,GAErB,KACL,EAAO,GAAG,CAAC,aAAc,GACzB,EAAO,GAAG,CAAC,aAAc,GACzB,EAAO,GAAG,CAAC,WAAY,GACvB,EAAO,GAAG,CAAC,iBAAkB,GAC/B,EACF,EAAG,CAAC,EAAQ,EAAY,EAAQ,EAGhC,GAAa,CACX,EAAG,IAAM,EAAc,UACvB,EAAG,IAAM,EAAc,OACvB,IAAK,IAAM,EAAc,OACzB,EAAG,KACD,GAAI,CAAC,EAAQ,OACb,IAAM,EAAO,IAAI,MAAI,CAAC,CACpB,KAAM,IACN,IAAK,IACL,KAAM,UACN,MAAO,IACP,OAAQ,GACV,GACA,EAAO,GAAG,CAAC,GACX,EAAO,eAAe,CAAC,GACvB,EAAc,UAChB,EACA,EAAG,KACD,GAAI,CAAC,EAAQ,OACb,IAAM,EAAS,IAAI,QAAM,CAAC,CACxB,KAAM,IACN,IAAK,IACL,KAAM,UACN,OAAQ,EACV,GACA,EAAO,GAAG,CAAC,GACX,EAAO,eAAe,CAAC,GACvB,EAAc,UAChB,EACA,EAAG,KACD,GAAI,CAAC,EAAQ,OACb,IAAM,EAAO,IAAI,OAAK,CAAC,YAAa,CAClC,KAAM,IACN,IAAK,IACL,WAAY,QACZ,KAAM,OACN,SAAU,EACZ,GACA,EAAO,GAAG,CAAC,GACX,EAAO,eAAe,CAAC,GACvB,EAAc,UAChB,EACA,EAAG,IAAM,EAAc,OACvB,OAAQ,KACN,GAAI,CAAC,EAAQ,OACb,IAAM,EAAgB,EAAO,gBAAgB,GACzC,EAAc,MAAM,GACtB,EAAO,mBAAmB,GAC1B,EAAc,OAAO,CAAC,AAAC,IACrB,EAAO,MAAM,CAAC,GAChB,GACA,EAAO,gBAAgB,IAE3B,EACA,UAAW,KACT,GAAI,CAAC,EAAQ,OACb,IAAM,EAAgB,EAAO,gBAAgB,GACzC,EAAc,MAAM,GACtB,EAAO,mBAAmB,GAC1B,EAAc,OAAO,CAAC,AAAC,IACrB,EAAO,MAAM,CAAC,GAChB,GACA,EAAO,gBAAgB,IAE3B,EACA,SAAU,IAAM,EAAQ,IAAI,GAC5B,eAAgB,IAAM,EAAQ,IAAI,GAClC,SAAU,KAEH,GACL,EAAO,OAAO,CAAC,AAAmB,IAAnB,EAAO,OAAO,IAC/B,EACA,SAAU,KAEH,GACL,EAAO,OAAO,CAAC,AAAmB,GAAnB,EAAO,OAAO,IAC/B,EACA,SAAU,KAEH,IACL,EAAO,OAAO,CAAC,GACf,EAAO,oBAAoB,CAAC,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAE,GAChD,CACF,GAGE,UAAC,OAAI,IAAK,EAAc,MAAO,CAAE,MAAO,OAAQ,OAAQ,MAAO,WAC7D,UAAC,UAAO,IAAK,MAGnB,0FC9NA,GAAM,CAAE,MAAA,EAAK,CAAE,CAAG,UAAU,CAEtB,GAA4B,KAChC,GAAM,CAAE,OAAA,CAAM,CAAE,eAAA,CAAc,CAAE,CAAG,GAAA,iBAAe,IAC5C,CAAC,EAAK,CAAG,SAAI,CAAC,OAAO,GAGrB,EAAG,EAAY,CAAG,GAAA,UAAQ,EAAC,CAAC,SAuClC,CArCA,GAAA,WAAS,EAAC,KACR,GAAI,EAAgB,CAClB,IAAM,EAAa,KAEjB,IAAM,EAAW,AAAC,GAChB,AAAI,AAAe,UAAf,OAAO,EAAyB,EAChC,GAAO,AAAe,UAAf,OAAO,GAAoB,eAAgB,EAAY,UAC3D,EAAM,EAAI,QAAQ,GAAK,cAGhC,EAAK,cAAc,CAAC,CAClB,KAAM,EAAS,EAAe,IAAI,EAClC,OAAQ,EAAS,EAAe,MAAM,EACtC,YAAa,EAAe,WAAW,CACvC,QAAS,EAAe,OAAO,CAC/B,KAAM,KAAK,KAAK,CAAC,EAAe,IAAI,EAAI,GACxC,IAAK,KAAK,KAAK,CAAC,EAAe,GAAG,EAAI,GACtC,MAAO,KAAK,KAAK,CAAC,AAAC,CAAA,EAAe,KAAK,EAAI,CAAA,EAAM,CAAA,EAAe,MAAM,EAAI,CAAA,GAC1E,OAAQ,KAAK,KAAK,CAAC,AAAC,CAAA,EAAe,MAAM,EAAI,CAAA,EAAM,CAAA,EAAe,MAAM,EAAI,CAAA,GAC5E,MAAO,KAAK,KAAK,CAAC,EAAe,KAAK,EAAI,EAC5C,GACA,EAAY,CAAC,GACf,EAKA,GAHA,IAGI,EAAQ,CACV,IAAM,EAAiB,IAAM,IAE7B,OADA,EAAO,EAAE,CAAC,kBAAmB,GACtB,KACL,EAAO,GAAG,CAAC,kBAAmB,GAChC,EACF,CACF,CACF,EAAG,CAAC,EAAgB,EAAQ,EAAK,EAE5B,GAyDH,WAAC,iBACC,UAAC,IAAM,MAAO,WAAG,eACjB,WAAC,SAAI,EAAC,KAAM,EAAM,OAAO,WAAW,eAvDb,CAAC,EAAoB,SAQtC,EAAA,EAOA,EAAA,EAdR,GAAI,AAAC,GAAmB,GAExB,GAAI,SAAU,EAAe,CAE3B,IAAM,EACJ,AAA8B,UAA9B,OAAO,EAAc,IAAI,CACrB,EAAc,IAAI,CAClB,SAAA,EAAA,EAAc,IAAI,YAAlB,iBAAA,EAAA,EAAoB,WAAW,YAA/B,SAAA,OAAA,KAAuC,UAC7C,EAAe,GAAG,CAAC,OAAQ,GAC7B,CACA,GAAI,WAAY,EAAe,CAC7B,IAAM,EACJ,AAAgC,UAAhC,OAAO,EAAc,MAAM,CACvB,EAAc,MAAM,CACpB,SAAA,EAAA,EAAc,MAAM,YAApB,iBAAA,EAAA,EAAsB,WAAW,YAAjC,SAAA,OAAA,KAAyC,UAC/C,EAAe,GAAG,CAAC,SAAU,GAC/B,CAkBA,GAjBI,gBAAiB,GACnB,EAAe,GAAG,CAAC,cAAe,EAAc,WAAW,EAEzD,YAAa,GACf,EAAe,GAAG,CAAC,UAAW,EAAc,OAAO,EAEjD,SAAU,GACZ,EAAe,GAAG,CAAC,OAAQ,EAAc,IAAI,EAE3C,QAAS,GACX,EAAe,GAAG,CAAC,MAAO,EAAc,GAAG,EAEzC,UAAW,GACb,EAAe,GAAG,CAAC,QAAS,EAAc,KAAK,EAI7C,UAAW,EAAe,CAC5B,IAAM,EAAW,EAAc,KAAK,CAChC,EAAe,KAAK,EACtB,EAAe,YAAY,CAAC,GAEhC,CACA,GAAI,WAAY,EAAe,CAC7B,IAAM,EAAY,EAAc,MAAM,CAClC,EAAe,MAAM,EACvB,EAAe,aAAa,CAAC,GAEjC,CAEA,EAAe,SAAS,GACxB,EAAO,gBAAgB,IACzB,EAK4E,KAAK,kBAC3E,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,OAAO,MAAM,sBAC3B,UAAC,SAAW,EAAC,QAAQ,QAGvB,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,SAAS,MAAM,wBAC7B,UAAC,SAAW,EAAC,QAAQ,QAGvB,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,cAAc,MAAM,wBAClC,UAAC,UAAW,EAAC,IAAK,MAGpB,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,UAAU,MAAM,mBAC9B,UAAC,UAAM,EAAC,IAAK,EAAG,IAAK,EAAG,KAAM,OAGhC,WAAC,OAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,CAAE,YACpC,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,OAAO,MAAM,aAC3B,UAAC,UAAW,OAEd,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,MAAM,MAAM,aAC1B,UAAC,UAAW,UAIhB,WAAC,OAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,CAAE,YACpC,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,QAAQ,MAAM,iBAC5B,UAAC,UAAW,EAAC,IAAK,MAEpB,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,SAAS,MAAM,kBAC7B,UAAC,UAAW,EAAC,IAAK,SAItB,UAAC,SAAI,CAAC,IAAI,EAAC,KAAK,QAAQ,MAAM,oBAC5B,UAAC,UAAM,EAAC,IAAK,EAAG,IAAK,cA9FpB,UAAC,UAAK,EAAC,YAAY,qBAAqB,MAAO,UAAK,CAAC,sBAAsB,GAmGtF,qMCxHA,GAAM,CAAE,MAAA,EAAK,CAAE,CAAG,UAAU,CAStB,GAA4C,CAAC,CAAE,GAAA,CAAE,CAAE,SAAA,CAAQ,CAAE,WAAA,CAAU,CAAE,QAAA,CAAO,CAAE,IACtF,GAAM,CAAE,WAAA,CAAU,CAAE,UAAA,CAAS,CAAE,WAAA,CAAU,CAAE,oBAAA,CAAmB,CAAE,UAAA,CAAS,CAAE,WAAA,CAAU,CAAE,CACrF,GAAA,cAAW,EAAC,CAAE,GAAA,CAAG,GAEb,EAAQ,CACZ,UAAW,MAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,GAClC,WAAA,EACA,gBAAiB,EAAa,UAAY,cAC1C,aAAc,EACd,OAAQ,oBACR,aAAc,EACd,QAAS,UACT,QAAS,OACT,WAAY,QACd,EAEA,MACE,WAAC,OAAI,IAAK,EAAY,MAAO,YAC1B,IAED,WAAC,OACC,IAAK,EACJ,GAAG,CAAU,CACb,GAAG,CAAS,CACb,MAAO,CACL,OAAQ,OACR,YAAa,EACb,QAAS,OACT,WAAY,SACZ,MAAO,MACT,YAEA,UAAC,UAAc,KAAG,OAEpB,WAAC,OAAI,QAAS,EAAS,MAAO,CAAE,KAAM,EAAG,OAAQ,SAAU,YACxD,IAEA,EAAS,UAIlB,EAEM,GAAwB,KAC5B,GAAM,CAAE,OAAA,CAAM,CAAE,eAAA,CAAc,CAAE,kBAAA,CAAiB,CAAE,QAAA,CAAO,CAAE,CAAG,GAAA,iBAAe,IACxE,CAAC,EAAS,EAAW,CAAG,GAAA,UAAQ,EAAiB,EAAE,EAEnD,EAAU,GAAA,aAAU,EACxB,GAAA,YAAS,EAAC,gBAAa,EACvB,GAAA,YAAS,EAAC,iBAAc,CAAE,CACxB,iBAAkB,8BAA2B,AAC/C,IAGI,EAAgB,KACpB,GAAI,CAAC,EAAQ,OACb,IAAM,EAAO,EAAO,UAAU,GAC9B,EAAK,OAAO,CAAC,AAAC,IACP,EAAI,GAAG,EAAE,CAAA,EAAI,GAAG,CAAG,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,MAAM,CAAC,EAAG,EAAC,EAChE,GAEA,EAAW,IAAI,EAAK,CAAC,OAAO,IAC9B,EAEA,GAAA,WAAS,EAAC,SAGJ,EAFJ,GAAI,CAAC,EAAQ,OAGb,IAAM,EAAkB,KACtB,aAAa,GACb,EAAU,WAAW,EAAe,KACtC,EAQA,OANA,EAAO,EAAE,CAAC,eAAgB,GAC1B,EAAO,EAAE,CAAC,iBAAkB,GAC5B,EAAO,EAAE,CAAC,kBAAmB,GAE7B,IAEO,KACL,EAAO,GAAG,CAAC,eAAgB,GAC3B,EAAO,GAAG,CAAC,iBAAkB,GAC7B,EAAO,GAAG,CAAC,kBAAmB,GAC9B,aAAa,GACf,EACF,EAAG,CAAC,EAAO,EAwCX,IAAM,EAAmB,CAAC,EAAmB,KAC3C,EAAE,eAAe,GACjB,EAAI,OAAO,CAAG,CAAC,EAAI,OAAO,CACrB,EAAI,OAAO,QACd,GAAA,EAAQ,mBAAmB,SAE7B,GAAA,EAAQ,gBAAgB,GACxB,EAAQ,SAAS,GAEjB,EAAW,IAAK,OAAA,SAAA,EAAQ,UAAU,KAAM,EAAE,CAAE,CAAC,OAAO,IACtD,EAEM,EAAa,CAAC,EAAmB,KACrC,EAAE,eAAe,GACjB,EAAI,aAAa,CAAG,CAAC,EAAI,aAAa,CACtC,EAAI,aAAa,CAAG,CAAC,EAAI,aAAa,CACtC,EAAI,YAAY,CAAG,CAAC,EAAI,YAAY,CACpC,EAAI,YAAY,CAAG,CAAC,EAAI,YAAY,CACpC,EAAI,YAAY,CAAG,CAAC,EAAI,YAAY,CACpC,EAAI,UAAU,CAAG,CAAC,EAAI,aAAa,CAE9B,EAAI,UAAU,QACjB,GAAA,EAAQ,mBAAmB,SAG7B,GAAA,EAAQ,gBAAgB,GACxB,EAAQ,SAAS,GACjB,EAAW,IAAK,OAAA,SAAA,EAAQ,UAAU,KAAM,EAAE,CAAE,CAAC,OAAO,IACtD,EAEM,EAAe,AAAC,IACf,GAAW,EAAI,OAAO,EAAK,EAAI,UAAU,GAC9C,EAAO,eAAe,CAAC,GACvB,EAAO,gBAAgB,IACzB,EAEM,EAAe,CAAC,EAAmB,KACvC,EAAE,eAAe,SACjB,GAAA,EAAQ,MAAM,CAAC,SACf,GAAA,EAAQ,gBAAgB,GACxB,EAAQ,SAAS,GACnB,EAEA,MACE,WAAC,OAAI,MAAO,CAAE,UAAW,EAAG,YACzB,IAED,UAAC,IAAM,MAAO,WAAG,WAAc,IAC/B,WAAC,aAAU,EAAC,QAAS,EAAS,mBAAoB,gBAAa,CAAE,UAtF/C,AAAC,IACrB,GAAM,CAAE,OAAA,CAAM,CAAE,KAAA,CAAI,CAAE,CAAG,EAEzB,GAAI,GAAQ,EAAO,EAAE,GAAK,EAAK,EAAE,CAAE,CAEjC,IAAM,EAAW,EAAQ,SAAS,CAAC,AAAC,GAAa,EAAI,GAAG,GAAK,EAAO,EAAE,EAChE,EAAW,EAAQ,SAAS,CAAC,AAAC,GAAa,EAAI,GAAG,GAAK,EAAK,EAAE,EAEpE,GAAI,AAAa,KAAb,GAAmB,AAAa,KAAb,EAAiB,CAmBtC,IAAM,EAAiB,EAAQ,MAAM,CAAG,EAAI,EACtC,EAAM,CAAO,CAAC,EAAS,OAE7B,GAAA,EAAQ,YAAY,CAAC,EAAK,SAC1B,GAAA,EAAQ,gBAAgB,GACxB,EAAQ,SAAS,GACjB,IACF,CACF,CACF,YAmDO,IAED,UAAC,kBAAe,EACd,MAAO,EAAQ,GAAG,CAAC,AAAC,GAAa,EAAI,GAAG,EACxC,SAAU,8BAA2B,UAErC,UAAC,OACC,MAAO,CACL,UAAW,IACX,UAAW,OACX,OAAQ,oBACR,aAAc,EACd,QAAS,CACX,WAEC,EAAQ,GAAG,CAAC,CAAC,EAAW,KAEvB,IAAM,EAAa,IAAmB,EAChC,EAAO,EAAK,IAAI,EAAI,SACpB,EAAO,EAAK,IAAI,EAAI,CAAC,EAAE,EAAK,CAAC,EAAE,EAAQ,MAAM,CAAG,EAAM,CAAC,CAE7D,MACE,UAAC,IAEC,GAAI,EAAK,GAAG,CACZ,WAAY,EACZ,QAAS,IAAM,EAAa,YAE5B,WAAC,OACC,MAAO,CACL,QAAS,OACT,WAAY,SACZ,MAAO,OACP,eAAgB,eAClB,YAEA,WAAC,QACC,MAAO,CACL,SAAU,SACV,aAAc,WACd,WAAY,SACZ,SAAU,GACZ,YAEC,EAAK,OAER,WAAC,SAAK,EAAC,KAAM,YACV,IAED,UAAC,SAAM,EACL,KAAK,OACL,KAAK,QACL,KAAM,EAAK,OAAO,CAAG,UAAC,UAAW,KAAM,UAAC,UAAoB,KAC5D,QAAS,AAAC,GAAM,EAAiB,EAAM,GACvC,YAAa,AAAC,GAAM,EAAE,eAAe,KAEvC,UAAC,SAAM,EACL,KAAK,OACL,KAAK,QACL,KAAM,EAAK,aAAa,CAAG,UAAC,UAAY,KAAM,UAAC,UAAc,KAC7D,QAAS,AAAC,GAAM,EAAW,EAAM,GACjC,YAAa,AAAC,GAAM,EAAE,eAAe,KAEvC,UAAC,SAAM,EACL,KAAK,OACL,KAAK,QACL,MAAM,IACN,KAAM,UAAC,SAAc,KACrB,QAAS,AAAC,GAAM,EAAa,EAAM,GACnC,YAAa,AAAC,GAAM,EAAE,eAAe,YA9CtC,EAAK,GAAG,EAoDnB,aAMZ,0FCrSI,GAA2B,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,OAAQ,EAAG,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,kQAAmQ,CAAE,EAAE,AAAC,EAAG,KAAQ,qBAAsB,MAAS,UAAW,ECW/d,GAAuB,EAAM,UAAU,CANZ,SAAkC,CAAK,CAAE,CAAG,EACzE,OAAoB,EAAM,aAAa,CAAC,SAAQ,CAAE,GAAA,SAAa,EAAC,GAAA,SAAa,EAAC,CAAC,EAAG,GAAQ,CAAC,EAAG,CAC5F,IAAK,EACL,KAAM,EACR,IACF,+BCVI,GAA8B,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,OAAQ,EAAG,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,qQAAsQ,CAAE,EAAE,AAAC,EAAG,KAAQ,wBAAyB,MAAS,UAAW,ECWxe,GAAuB,EAAM,UAAU,CANT,SAAqC,CAAK,CAAE,CAAG,EAC/E,OAAoB,EAAM,aAAa,CAAC,SAAQ,CAAE,GAAA,SAAa,EAAC,GAAA,SAAa,EAAC,CAAC,EAAG,GAAQ,CAAC,EAAG,CAC5F,IAAK,EACL,KAAM,EACR,IACF,GCVI,GAAgB,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,OAAQ,EAAG,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAC,EAAG,SAAY,CAAC,CAAE,IAAO,QAAS,MAAS,CAAC,CAAE,EAAE,AAAC,EAAG,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,mmBAAomB,CAAE,EAAG,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,4PAA6P,CAAE,EAAE,AAAC,EAAG,KAAQ,QAAS,MAAS,UAAW,ECW1pC,GAAuB,EAAM,UAAU,CANvB,SAAuB,CAAK,CAAE,CAAG,EACnD,OAAoB,EAAM,aAAa,CAAC,SAAQ,CAAE,GAAA,SAAa,EAAC,GAAA,SAAa,EAAC,CAAC,EAAG,GAAQ,CAAC,EAAG,CAC5F,IAAK,EACL,KAAM,EACR,IACF,GCVI,GAAkB,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,OAAQ,EAAG,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAC,EAAG,SAAY,CAAC,CAAE,IAAO,QAAS,MAAS,CAAC,CAAE,EAAE,AAAC,EAAG,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,uzBAAwzB,CAAE,EAAE,AAAC,EAAG,KAAQ,UAAW,MAAS,UAAW,ECW/kC,GAAuB,EAAM,UAAU,CANrB,SAAyB,CAAK,CAAE,CAAG,EACvD,OAAoB,EAAM,aAAa,CAAC,SAAQ,CAAE,GAAA,SAAa,EAAC,GAAA,SAAa,EAAC,CAAC,EAAG,GAAQ,CAAC,EAAG,CAC5F,IAAK,EACL,KAAM,EACR,IACF,GCIA,GAAM,CAAE,MAAA,EAAK,CAAE,CAAG,UAAU,CAEtB,GAA2B,KAC/B,GAAM,CAAE,OAAA,CAAM,CAAE,eAAA,CAAc,CAAE,QAAA,CAAO,CAAE,CAAG,GAAA,iBAAe,IAErD,EAAQ,AAAC,IACb,GAAI,CAAC,GAAU,CAAC,EAAgB,OAGhC,IAAM,EAAc,EAAO,KAAK,EAAI,EAC9B,EAAe,EAAO,MAAM,EAAI,EAEtC,OAAQ,GACN,IAAK,OACH,AANc,EAMJ,GAAG,CAAC,CAAE,KAAM,CAAE,GACxB,MACF,IAAK,SACH,EAAO,aAAa,CATN,GAUd,MACF,IAAK,QACH,AAZc,EAYJ,GAAG,CAAC,CAAE,KAAM,EAAc,AAAC,CAAA,AAZvB,EAYiC,KAAK,EAAI,CAAA,EAAM,CAAA,AAZhD,EAY0D,MAAM,EAAI,CAAA,CAAG,GACrF,MACF,IAAK,MACH,AAfc,EAeJ,GAAG,CAAC,CAAE,IAAK,CAAE,GACvB,MACF,IAAK,SACH,EAAO,aAAa,CAlBN,GAmBd,MACF,IAAK,SACH,AArBc,EAqBJ,GAAG,CAAC,CAAE,IAAK,EAAe,AAAC,CAAA,AArBvB,EAqBiC,MAAM,EAAI,CAAA,EAAM,CAAA,AArBjD,EAqB2D,MAAM,EAAI,CAAA,CAAG,GAE1F,CAEA,AAzBkB,EAyBR,SAAS,GACnB,EAAO,gBAAgB,GACvB,EAAQ,SAAS,GACnB,SAsBA,AAAK,EAGH,WAAC,OAAI,MAAO,CAAE,aAAc,EAAG,YAC7B,UAAC,IAAM,MAAO,WAAG,yBACjB,WAAC,SAAK,EAAC,IAAI,cACT,UAAC,SAAO,EAAC,MAAM,sBACb,UAAC,SAAM,EAAC,KAAK,QAAQ,KAAM,UAAC,UAAiB,KAAK,QAAS,IAAM,EAAM,YAEzE,UAAC,SAAO,EAAC,MAAM,wBACb,UAAC,SAAM,EAAC,KAAK,QAAQ,KAAM,UAAC,UAAmB,KAAK,QAAS,IAAM,EAAM,cAE3E,UAAC,SAAO,EAAC,MAAM,uBACb,UAAC,SAAM,EAAC,KAAK,QAAQ,KAAM,UAAC,UAAkB,KAAK,QAAS,IAAM,EAAM,aAE1E,UAAC,SAAO,EAAC,MAAM,qBACb,UAAC,SAAM,EAAC,KAAK,QAAQ,KAAM,UAAC,OAA6B,QAAS,IAAM,EAAM,WAEhF,UAAC,SAAO,EAAC,MAAM,wBACb,UAAC,SAAM,EACL,KAAK,QACL,KAAM,UAAC,UAA2B,KAClC,QAAS,IAAM,EAAM,cAGzB,UAAC,SAAO,EAAC,MAAM,wBACb,UAAC,SAAM,EACL,KAAK,QACL,KAAM,UAAC,OACP,QAAS,IAAM,EAAM,iBAI3B,UAAC,OAAI,MAAO,CAAE,UAAW,CAAE,WACzB,WAAC,SAAK,YACJ,UAAC,SAAO,EAAC,MAAM,iBACb,UAAC,SAAM,EAAC,KAAK,QAAQ,KAAM,UAAC,OAAkB,QAxDnC,KACnB,GAAI,CAAC,EAAQ,OACb,IAAM,EAAY,EAAO,eAAe,GACnC,GAAa,AAAmB,oBAAnB,EAAU,IAAI,GAEhC,AAAC,EAAkB,OAAO,GAC1B,EAAO,gBAAgB,GACvB,EAAQ,SAAS,IACnB,MAkDQ,UAAC,SAAO,EAAC,MAAM,mBACb,UAAC,SAAM,EAAC,KAAK,QAAQ,KAAM,UAAC,OAAoB,QAjDnC,KACrB,GAAI,CAAC,EAAQ,OACb,IAAM,EAAY,EAAO,eAAe,GACnC,GAAa,AAAmB,UAAnB,EAAU,IAAI,GAEhC,AAAC,EAAkB,iBAAiB,GACpC,EAAO,gBAAgB,GACvB,EAAQ,SAAS,IACnB,cAE4B,KA6C9B,EC3GM,CAAE,MAAA,EAAK,CAAE,QAAA,EAAO,CAAE,CAAG,SAAM,CAE3B,GAAyB,IAE3B,UAAC,eAAa,EAAC,MAAM,yBACnB,UAAC,sBAAoB,WACnB,UAAC,SAAI,EAAC,UCf2G,2BDexE,UAAW,CAAE,QAAS,EAAG,OAAQ,MAAO,WAC/E,WAAC,SAAM,EAAC,MAAO,CAAE,OAAQ,MAAO,YAC9B,UAAC,IAAM,MAAM,QAAQ,MAAO,GAAI,UCjBZ,iCDkBlB,UAAC,SAEH,UAAC,IAAQ,UCpBgJ,kCDqBvJ,UAAC,SAEH,WAAC,IAAM,MAAM,QAAQ,MAAO,IAAK,UCvB8B,qCDwB7D,UAAC,OACD,UAAC,OACD,UAAC,sOEzBR,IAAM,EAAa,AAAC,IACzB,GAAM,CAAC,EAAS,EAAW,CAAG,GAAA,UAAQ,EAAW,EAAE,EAC7C,CAAC,EAAc,EAAgB,CAAG,GAAA,UAAQ,EAAS,IACnD,CAAC,EAAqB,EAAuB,CAAG,GAAA,UAAQ,EAAU,CAAA,GAgDxE,MAAO,CACL,UA/CgB,GAAA,aAAW,EAAC,KAC5B,GAAI,CAAC,GAAU,EAAqB,OAEpC,IAAM,EAAO,KAAK,SAAS,CAAC,EAAO,MAAM,IAGnC,EAAa,EAAQ,KAAK,CAAC,EAAG,EAAe,GACnD,EAAW,IAAI,CAAC,GAGZ,EAAW,MAAM,CAAG,IACtB,EAAW,KAAK,GAGlB,EAAW,GACX,EAAgB,EAAW,MAAM,CAAG,GACtC,EAAG,CAAC,EAAQ,EAAS,EAAc,EAAoB,EAgCrD,KA9BW,GAAA,aAAW,EAAC,KACvB,GAAI,CAAC,GAAU,GAAgB,GAAK,EAAqB,OAEzD,EAAuB,CAAA,GACvB,IAAM,EAAW,EAAe,EAC1B,EAAO,CAAO,CAAC,EAAS,CAE9B,EAAO,YAAY,CAAC,KAAK,KAAK,CAAC,GAAO,KACpC,EAAO,SAAS,GAChB,EAAgB,GAChB,EAAuB,CAAA,GACzB,GACF,EAAG,CAAC,EAAQ,EAAS,EAAc,EAAoB,EAmBrD,KAjBW,GAAA,aAAW,EAAC,KACvB,GAAI,CAAC,GAAU,GAAgB,EAAQ,MAAM,CAAG,GAAK,EAAqB,OAE1E,EAAuB,CAAA,GACvB,IAAM,EAAW,EAAe,EAC1B,EAAO,CAAO,CAAC,EAAS,CAE9B,EAAO,YAAY,CAAC,KAAK,KAAK,CAAC,GAAO,KACpC,EAAO,SAAS,GAChB,EAAgB,GAChB,EAAuB,CAAA,GACzB,GACF,EAAG,CAAC,EAAQ,EAAS,EAAc,EAAoB,EAMrD,QAAS,EAAe,EACxB,QAAS,EAAe,EAAQ,MAAM,CAAG,CAC3C,EACF,ECzCM,EAAsB,GAAA,eAAa,EAAsC,KAAA,GAElE,EAAgE,CAAC,CAAE,SAAA,CAAQ,CAAE,IACxF,GAAM,CAAC,EAAQ,EAAU,CAAG,GAAA,UAAQ,EAAgB,MAC9C,CAAC,EAAgB,EAAkB,CAAG,GAAA,UAAQ,EAAsB,MACpE,CAAC,EAAY,EAAc,CAAG,GAAA,UAAQ,EAAS,UAE/C,EAAU,EAAW,GAE3B,MACE,UAAC,EAAoB,QAAQ,EAC3B,MAAO,CACL,OAAA,EACA,UAAA,EACA,eAAA,EACA,kBAAA,EACA,WAAA,EACA,cAAA,EACA,QAAA,CACF,WAEC,IAGP,EAEa,EAAkB,KAC7B,IAAM,EAAU,GAAA,YAAU,EAAC,GAC3B,GAAI,CAAC,EACH,MAAM,AAAI,MAAM,8DAElB,OAAO,EACT"}