(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["9b232423"],{"0be78c77":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return ei;}});var r=a("777fffbe"),i=a("852bbaa9"),d=a("1a7c85b4"),o=a("d322be42"),n=i._(o),s=a("cec50f65"),l=r._(s),c=a("b2a1469e"),u=r._(c),p=a("e9bcd22d"),h=r._(p),f=a("6effc0fd"),y=r._(f),w=a("ea21718c"),m=r._(w),b=a("c9d8dc0b"),g=r._(b),v=a("28c7d19c"),J=a("3c9e49cc"),S=a("8b216428"),W=r._(S),T=a("0c32acfb"),H=r._(T),k=a("c923f942"),x=r._(k),I=async(e,t,a)=>{let r=await (0,x.default)(e,t,"sign");return(0,H.default)(e,r),new Uint8Array(await crypto.subtle.sign((0,W.default)(e,r.algorithm),r,a));},j=a("e7fa9173"),C=r._(j),P=a("7f907bd6"),_=a("e48ac8f7"),A=a("45d10e5b"),E=r._(A),N=a("77e4a257"),F=r._(N),O=a("43adda83"),U=r._(O);class M{#e;#t;#a;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#e=e;}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this;}setUnprotectedHeader(e){if(this.#a)throw TypeError("setUnprotectedHeader can only be called once");return this.#a=e,this;}async sign(e,t){let a;if(!this.#t&&!this.#a)throw new P.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,C.default)(this.#t,this.#a))throw new P.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let r={...this.#t,...this.#a},i=(0,F.default)(P.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this.#t,r),d=!0;if(i.has("b64")&&"boolean"!=typeof(d=this.#t.b64))throw new P.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:o}=r;if("string"!=typeof o||!o)throw new P.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,E.default)(o,e,"sign");let n=this.#e;d&&(n=_.encoder.encode((0,J.encode)(n))),a=this.#t?_.encoder.encode((0,J.encode)(JSON.stringify(this.#t))):_.encoder.encode("");let s=(0,_.concat)(a,_.encoder.encode("."),n),l=await (0,U.default)(e,o),c=await I(o,l,s),u={signature:(0,J.encode)(c),payload:""};return d&&(u.payload=_.decoder.decode(n)),this.#a&&(u.header=this.#a),this.#t&&(u.protected=_.decoder.decode(a)),u;}}class V{#r;constructor(e){this.#r=new M(e);}setProtectedHeader(e){return this.#r.setProtectedHeader(e),this;}async sign(e,t){let a=await this.#r.sign(e,t);if(void 0===a.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${a.protected}.${a.payload}.${a.signature}`;}}var D=e=>Math.floor(e.getTime()/1e3);let $=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;var B=e=>{let t;let a=$.exec(e);if(!a||a[4]&&a[1])throw TypeError("Invalid time period format");let r=parseFloat(a[2]);switch(a[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*r);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*r);break;case"day":case"days":case"d":t=Math.round(86400*r);break;case"week":case"weeks":case"w":t=Math.round(604800*r);break;default:t=Math.round(31557600*r);}return"-"===a[1]||"ago"===a[4]?-t:t;},L=a("108b3a85"),z=r._(L);function q(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t;}let G=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,K=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));class R{#e;constructor(e){if(!(0,z.default)(e))throw TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(e);}data(){return _.encoder.encode(JSON.stringify(this.#e));}get iss(){return this.#e.iss;}set iss(e){this.#e.iss=e;}get sub(){return this.#e.sub;}set sub(e){this.#e.sub=e;}get aud(){return this.#e.aud;}set aud(e){this.#e.aud=e;}set jti(e){this.#e.jti=e;}set nbf(e){"number"==typeof e?this.#e.nbf=q("setNotBefore",e):e instanceof Date?this.#e.nbf=q("setNotBefore",D(e)):this.#e.nbf=D(new Date)+B(e);}set exp(e){"number"==typeof e?this.#e.exp=q("setExpirationTime",e):e instanceof Date?this.#e.exp=q("setExpirationTime",D(e)):this.#e.exp=D(new Date)+B(e);}set iat(e){void 0===e?this.#e.iat=D(new Date):e instanceof Date?this.#e.iat=q("setIssuedAt",D(e)):"string"==typeof e?this.#e.iat=q("setIssuedAt",D(new Date)+B(e)):this.#e.iat=q("setIssuedAt",e);}}class Z{#t;#i;constructor(e={}){this.#i=new R(e);}setIssuer(e){return this.#i.iss=e,this;}setSubject(e){return this.#i.sub=e,this;}setAudience(e){return this.#i.aud=e,this;}setJti(e){return this.#i.jti=e,this;}setNotBefore(e){return this.#i.nbf=e,this;}setExpirationTime(e){return this.#i.exp=e,this;}setIssuedAt(e){return this.#i.iat=e,this;}setProtectedHeader(e){return this.#t=e,this;}async sign(e,t){var a;let r=new V(this.#i.data());if(r.setProtectedHeader(this.#t),Array.isArray(null===(a=this.#t)||void 0===a?void 0:a.crit)&&this.#t.crit.includes("b64")&&!1===this.#t.b64)throw new P.JWTInvalid("JWTs MUST NOT use unencoded payload");return r.sign(e,t);}}var Q=async(e,t,a,r)=>{let i=await (0,x.default)(e,t,"verify");(0,H.default)(e,i);let d=(0,W.default)(e,i.algorithm);try{return await crypto.subtle.verify(d,i,a,r);}catch{return!1;}},X=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t);};async function Y(e,t,a){let r,i;if(!(0,z.default)(e))throw new P.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new P.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new P.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new P.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new P.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,z.default)(e.header))throw new P.JWSInvalid("JWS Unprotected Header incorrect type");let d={};if(e.protected)try{let t=(0,J.decode)(e.protected);d=JSON.parse(_.decoder.decode(t));}catch{throw new P.JWSInvalid("JWS Protected Header is invalid");}if(!(0,C.default)(d,e.header))throw new P.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let o={...d,...e.header},n=(0,F.default)(P.JWSInvalid,new Map([["b64",!0]]),null==a?void 0:a.crit,d,o),s=!0;if(n.has("b64")&&"boolean"!=typeof(s=d.b64))throw new P.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:l}=o;if("string"!=typeof l||!l)throw new P.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let c=a&&X("algorithms",a.algorithms);if(c&&!c.has(l))throw new P.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(s){if("string"!=typeof e.payload)throw new P.JWSInvalid("JWS Payload must be a string");}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new P.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let u=!1;"function"==typeof t&&(t=await t(d,e),u=!0),(0,E.default)(l,t,"verify");let p=(0,_.concat)(_.encoder.encode(e.protected??""),_.encoder.encode("."),"string"==typeof e.payload?_.encoder.encode(e.payload):e.payload);try{r=(0,J.decode)(e.signature);}catch{throw new P.JWSInvalid("Failed to base64url decode the signature");}let h=await (0,U.default)(t,l);if(!await Q(l,h,r,p))throw new P.JWSSignatureVerificationFailed;if(s)try{i=(0,J.decode)(e.payload);}catch{throw new P.JWSInvalid("Failed to base64url decode the payload");}else i="string"==typeof e.payload?_.encoder.encode(e.payload):e.payload;let f={payload:i};return(void 0!==e.protected&&(f.protectedHeader=d),void 0!==e.header&&(f.unprotectedHeader=e.header),u)?{...f,key:h}:f;}async function ee(e,t,a){if(e instanceof Uint8Array&&(e=_.decoder.decode(e)),"string"!=typeof e)throw new P.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:r,1:i,2:d,length:o}=e.split(".");if(3!==o)throw new P.JWSInvalid("Invalid Compact JWS");let n=await Y({payload:i,protected:r,signature:d},t,a),s={payload:n.payload,protectedHeader:n.protectedHeader};return"function"==typeof t?{...s,key:n.key}:s;}async function et(e,t,a){var r;let i=await ee(e,t,a);if((null===(r=i.protectedHeader.crit)||void 0===r?void 0:r.includes("b64"))&&!1===i.protectedHeader.b64)throw new P.JWTInvalid("JWTs MUST NOT use unencoded payload");let d={payload:function(e,t,a={}){let r,i;try{r=JSON.parse(_.decoder.decode(t));}catch{}if(!(0,z.default)(r))throw new P.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{typ:d}=a;if(d&&("string"!=typeof e.typ||G(e.typ)!==G(d)))throw new P.JWTClaimValidationFailed('unexpected "typ" JWT header value',r,"typ","check_failed");let{requiredClaims:o=[],issuer:n,subject:s,audience:l,maxTokenAge:c}=a,u=[...o];for(let e of(void 0!==c&&u.push("iat"),void 0!==l&&u.push("aud"),void 0!==s&&u.push("sub"),void 0!==n&&u.push("iss"),new Set(u.reverse())))if(!(e in r))throw new P.JWTClaimValidationFailed(`missing required "${e}" claim`,r,e,"missing");if(n&&!(Array.isArray(n)?n:[n]).includes(r.iss))throw new P.JWTClaimValidationFailed('unexpected "iss" claim value',r,"iss","check_failed");if(s&&r.sub!==s)throw new P.JWTClaimValidationFailed('unexpected "sub" claim value',r,"sub","check_failed");if(l&&!K(r.aud,"string"==typeof l?[l]:l))throw new P.JWTClaimValidationFailed('unexpected "aud" claim value',r,"aud","check_failed");switch(typeof a.clockTolerance){case"string":i=B(a.clockTolerance);break;case"number":i=a.clockTolerance;break;case"undefined":i=0;break;default:throw TypeError("Invalid clockTolerance option type");}let{currentDate:p}=a,h=D(p||new Date);if((void 0!==r.iat||c)&&"number"!=typeof r.iat)throw new P.JWTClaimValidationFailed('"iat" claim must be a number',r,"iat","invalid");if(void 0!==r.nbf){if("number"!=typeof r.nbf)throw new P.JWTClaimValidationFailed('"nbf" claim must be a number',r,"nbf","invalid");if(r.nbf>h+i)throw new P.JWTClaimValidationFailed('"nbf" claim timestamp check failed',r,"nbf","check_failed");}if(void 0!==r.exp){if("number"!=typeof r.exp)throw new P.JWTClaimValidationFailed('"exp" claim must be a number',r,"exp","invalid");if(r.exp<=h-i)throw new P.JWTExpired('"exp" claim timestamp check failed',r,"exp","check_failed");}if(c){let e=h-r.iat;if(e-i>("number"==typeof c?c:B(c)))throw new P.JWTExpired('"iat" claim timestamp check failed (too far in the past)',r,"iat","check_failed");if(e<0-i)throw new P.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',r,"iat","check_failed");}return r;}(i.protectedHeader,i.payload,a),protectedHeader:i.protectedHeader};return"function"==typeof t?{...d,key:i.key}:d;}let{TextArea:ea}=l.default,{Title:er}=y.default,ei=()=>{let[e,t]=(0,n.useState)(""),[a,r]=(0,n.useState)(""),[i,o]=(0,n.useState)(""),[s,c]=(0,n.useState)(""),p=new TextEncoder,f=e=>{let t=e.trim();try{return JSON.parse(t);}catch{try{let e=t.replace(/'/g,'"').replace(/([a-zA-Z0-9_]+):/g,'"$1":');return JSON.parse(e);}catch{throw Error("Invalid JSON payload format.");}}},y=async()=>{try{let t=f(a),r=p.encode(e),i=await new Z(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("2h").sign(r);o(i),g.default.success("JWT token created successfully!");}catch(e){console.error(e),g.default.error(e.message||"Error creating JWT.");}},w=async()=>{try{let t=p.encode(e),{payload:a}=await et(i,t);c(JSON.stringify(a,null,2)),g.default.success("Token verified successfully!");}catch(e){g.default.error(`Invalid token: ${e.message}`);}};return(0,d.jsx)(v.PageContainer,{children:(0,d.jsx)(h.default,{title:"\u{1F510} JWT Encrypt / Decrypt Tool",bordered:!1,children:(0,d.jsxs)(m.default,{direction:"vertical",style:{width:"100%"},size:"large",children:[(0,d.jsx)(l.default.Password,{placeholder:"Enter Secret Key",value:e,onChange:e=>t(e.target.value)}),(0,d.jsx)(ea,{rows:4,placeholder:"Enter Payload JSON (e.g. { 'user': 'admin' })",value:a,onChange:e=>r(e.target.value)}),(0,d.jsxs)(m.default,{children:[(0,d.jsx)(u.default,{type:"primary",onClick:y,children:"Encrypt (Sign JWT)"}),(0,d.jsx)(u.default,{onClick:()=>{try{let e=f(a);r(JSON.stringify(e,null,2)),g.default.success("Payload formatted successfully!");}catch{g.default.error("Cannot format: invalid JSON.");}},children:"Prettify JSON"})]}),(0,d.jsx)(ea,{rows:4,placeholder:"Generated or Existing JWT Token",value:i,onChange:e=>o(e.target.value)}),(0,d.jsx)(u.default,{onClick:w,children:"Decrypt (Verify JWT)"}),s&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(er,{level:5,children:"Decoded Payload:"}),(0,d.jsx)("pre",{style:{background:"#f7f7f7",padding:12,borderRadius:6,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s})]})]})})});};}}]);
//# sourceMappingURL=9b232423-async.4d258063.js.map