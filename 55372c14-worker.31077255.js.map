{"version":3,"sources":["_mako_internal/runtime_entry.js","src/pages/PhotoEditor/workers/imageProcessing.worker.ts?asworker"],"sourcesContent":["function createRuntime(makoModules, entryModuleId, global) {\n\n  var modulesRegistry = {};\n\n\n  function requireModule(moduleId) {\n    var cachedModule = modulesRegistry[moduleId];\n\n    if (cachedModule !== undefined) {\n\n      return cachedModule.exports;\n    }\n\n    var module = {\n      id: moduleId,\n      exports: {},\n    };\n    modulesRegistry[moduleId] = module;\n\n\n      var execOptions = {\n        id: moduleId,\n        module: module,\n        factory: makoModules[moduleId],\n        require: requireModule,\n      };\n      requireModule.requireInterceptors.forEach(function (interceptor) {\n        interceptor(execOptions);\n      });\n      execOptions.factory.call(\n        execOptions.module.exports,\n        execOptions.module,\n        execOptions.module.exports,\n        execOptions.require,\n      );\n\n\n    return module.exports;\n  }\n\n  // module execution interceptor\n  requireModule.requireInterceptors = [];\n\n  // module utils\n  requireModule.e = function(target, all) {\n    for (var name in all)\n      Object.defineProperty(target, name, {\n        enumerable: true,\n        get: all[name],\n      });\n  };\n\n  // hasOwnProperty shorthand\n  requireModule.o = function (obj, prop) { return (Object.prototype.hasOwnProperty.call(obj, prop));};\n\n  // required modules\n  requireModule.m  = makoModules;\n\n  // modules registry\n  requireModule.c  = modulesRegistry;\n\n\n  // Export Star util for concatenated modules\n  requireModule.es = function(to, from) {\n    Object.keys(from).forEach(function(k) {\n        if (k !== \"default\" && !requireModule.o(to, k)) {\n            Object.defineProperty(to, k, {\n                enumerable: true,\n                get: from[k]\n            });\n        }\n    });\n  };\n\n  requireModule.d = Object.defineProperty.bind(Object);\n\n  !(function(){\n    function isPromise(obj) {\n      return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n    }\n\n    requireModule.dr = function(interop, mr) {\n      return function(){\n        var m = mr();\n        if(isPromise(m)){\n          return m.then(function(rm){ return interop(rm)})\n        }\n        return interop(m);\n      }\n    };\n  })();\n\n\n\n  /* mako/runtime/ensure chunk */\n  !(function () {\n    requireModule.chunkEnsures = {};\n    // This file contains only the entry chunk.\n    // The chunk loading function for additional chunks\n    requireModule.ensure = function (chunkId) {\n      return Promise.all(\n        Object.keys(requireModule.chunkEnsures).reduce(function (\n          promises,\n          key,\n        ) {\n          requireModule.chunkEnsures[key](chunkId, promises);\n          return promises;\n        }, []),\n      );\n    };\n  })();\n\n  /* mako/runtime/ensure load js Chunk */\n  !(function () {\n    requireModule.jsonpInstalled = {};\n    var installedChunks = requireModule.jsonpInstalled;\n\n    \n    requireModule.chunkEnsures.jsonp = function (chunkId, promises) {\n      var data = installedChunks[chunkId];\n      if (data === 0) return;\n\n      \n\n      if (data) {\n        //     0       1        2\n        // [resolve, reject, promise]\n        promises.push(data[2]);\n      } else {\n        var promise = new Promise(function (resolve, reject) {\n          data = installedChunks[chunkId] = [resolve, reject];\n        });\n        promises.push((data[2] = promise));\n        var url = requireModule.publicPath + chunksIdToUrlMap[chunkId];\n        var error = new Error();\n        var onLoadEnd = function (event) {\n          data = installedChunks[chunkId];\n          if (data !== 0) installedChunks[chunkId] = undefined;\n          if (data) {\n            var errorType = event && event.type;\n            var src = event && event.target && event.target.src;\n            error.message =\n              'Loading chunk ' +\n              chunkId +\n              ' failed. (' +\n              errorType +\n              ' : ' +\n              src +\n              ')';\n            error.name = 'ChunkLoadError';\n            error.type = errorType;\n            data[1](error);\n          }\n        };\n        // load\n        requireModule.loadScript(url, onLoadEnd, 'chunk-' + chunkId);\n        return promise;\n      }\n    };\n    \n  })();\n  // chunk and async load\n\n  /* mako/runtime/ensure load css chunk */\n  !(function () {\n    var publicPathWithoutOrigin;\n    requireModule.cssInstalled = cssInstalledChunks;\n    // __CSS_CHUNKS_URL_MAP\n    requireModule.findStylesheet = function (url) {\n      try {\n        if (!publicPathWithoutOrigin) {\n          publicPathWithoutOrigin = new URL(\n            requireModule.publicPath.replace(/^(\\/\\/)/, 'https:$1')\n          ).pathname;\n        }\n      } catch(e) {}\n      return Array.from(\n        document.querySelectorAll('link[href][rel=stylesheet]'),\n      ).find(function (link) {\n        // why not use link.href?\n        // because link.href contains hostname\n        var linkUrl = link.getAttribute('href').split('?')[0];\n        return (\n          // relative path\n          linkUrl === url ||\n          // absolute path\n          linkUrl === requireModule.publicPath + url ||\n          // absolute path without hostname\n          (publicPathWithoutOrigin && linkUrl === publicPathWithoutOrigin + url)\n        );\n      });\n    };\n\n    requireModule.createStylesheet = function (\n      chunkId,\n      url,\n      oldTag,\n      resolve,\n      reject,\n    ) {\n      var link = document.createElement('link');\n\n      link.rel = 'stylesheet';\n      link.type = 'text/css';\n      link.href = url;\n      \n      link.onerror = link.onload = function (event) {\n        // avoid mem leaks, from webpack\n        link.onerror = link.onload = null;\n\n        if (event.type === 'load') {\n          // finished loading css chunk\n          cssInstalledChunks[chunkId] = 0;\n          resolve();\n        } else {\n          // throw error and reset state\n          delete cssInstalledChunks[chunkId];\n          var errorType = event && event.type;\n          var realHref = event && event.target && event.target.href;\n          var err = new Error(\n            'Loading CSS chunk ' + chunkId + ' failed.\\n(' + realHref + ')',\n          );\n\n          err.code = 'CSS_CHUNK_LOAD_FAILED';\n          err.type = errorType;\n          err.request = realHref;\n          link.parentNode.removeChild(link);\n          reject(err);\n        }\n      };\n\n      if (oldTag) {\n        oldTag.parentNode.insertBefore(link, oldTag.nextSibling);\n      } else {\n        document.head.appendChild(link);\n      }\n\n      return link;\n    };\n\n    \n    requireModule.chunkEnsures.css = function (chunkId, promises) {\n      if (cssInstalledChunks[chunkId]) {\n        // still pending, avoid duplicate promises\n        promises.push(cssInstalledChunks[chunkId]);\n      } else if (\n        cssInstalledChunks[chunkId] !== 0 &&\n        cssChunksIdToUrlMap[chunkId]\n      ) {\n        // load chunk and save promise\n        cssInstalledChunks[chunkId] = new Promise(function (resolve, reject) {\n          var url = cssChunksIdToUrlMap[chunkId];\n          var fullUrl = requireModule.publicPath + url;\n\n          if (requireModule.findStylesheet(url)) {\n            // already loaded\n            resolve();\n          } else {\n            // load new css chunk\n            requireModule.createStylesheet(\n              chunkId,\n              fullUrl,\n              null,\n              resolve,\n              reject,\n            );\n          }\n        });\n        promises.push(cssInstalledChunks[chunkId]);\n        return promises;\n      }\n    };\n    \n  })();\n\n  /* mako/runtime/load script */\n  !(function () {\n    var inProgress = {};\n    requireModule.loadScript = function (url, done, key) {\n      // Support worker\n      if (!self.document) {\n        importScripts(url);\n        return done();\n      }\n\n      if (inProgress[url]) {\n        return inProgress[url].push(done);\n      }\n      var script = document.querySelector(\n        'script[src=\"' + url + '\"]'\n        \n        + ', script[data-mako=\"' + 'ultimate-tool-web' + ':' + key + '\"]'\n        \n      );\n\n      if (!script) {\n        script = document.createElement('script');\n        script.timeout = 120;\n        script.src = url;\n        \n      }\n\n      inProgress[url] = [done];\n      var onLoadEnd = function (prev, event) {\n        clearTimeout(timeout);\n        var doneFns = inProgress[url];\n        delete inProgress[url];\n        if (script.parentNode) script.parentNode.removeChild(script);\n        if (doneFns) {\n          doneFns.forEach(function (fn) {\n            return fn(event);\n          });\n        }\n        if (prev) return prev(event);\n      };\n      // May not be needed, already has timeout attributes\n      var timeout = setTimeout(\n        onLoadEnd.bind(null, undefined, { type: 'timeout', target: script }),\n        120000,\n      );\n      script.onerror = onLoadEnd.bind(null, script.onerror);\n      script.onload = onLoadEnd.bind(null, script.onload);\n      document.head.appendChild(script);\n    };\n  })();\n\n\n  var registerModules = function(modules) {\n    for (var id in modules) {\n      makoModules[id] = modules[id];\n    }\n  };\n\n\n  var jsonpCallback = function (data) {\n    var installedChunks = requireModule.jsonpInstalled;\n    var chunkIds = data[0];\n    var modules = data[1];\n    if (\n      chunkIds.some(function (id) {\n        return installedChunks[id] !== 0;\n      })\n    ) {\n      registerModules(modules);\n    }\n    for (var i = 0; i < chunkIds.length; i++) {\n      var id = chunkIds[i];\n      if (installedChunks[id]) {\n        installedChunks[id][0]();\n      }\n      installedChunks[id] = 0;\n    }\n  };\n  var chunkLoadingGlobal = global[\"makoChunk_ultimate-tool-web\"] = global[\"makoChunk_ultimate-tool-web\"] || [];\n\tchunkLoadingGlobal.forEach(jsonpCallback.bind(null));\n  chunkLoadingGlobal.push = (function(push, data) {\n    push(data);\n    jsonpCallback(data);\n  }).bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));\n\n\n  \n  /* mako/runtime/publicPath */\n  !function () {\n    requireModule.publicPath= \"/ultimate-tool-web/\";\n  }();\n\n  /* mako/runtime/helpers */\n  registerModules({\n    \"777fffbe\": function(module, exports, __mako_require__) {\n    __mako_require__.d(exports, \"__esModule\", {\n        value: true\n    });\n    function _export(target, all) {\n        for(var name in all)Object.defineProperty(target, name, {\n            enumerable: true,\n            get: all[name]\n        });\n    }\n    __mako_require__.e(exports, {\n        _interop_require_default: function() {\n            return _interop_require_default;\n        },\n        _: function() {\n            return _interop_require_default;\n        }\n    });\n    function _interop_require_default(obj) {\n        return obj && obj.__esModule ? obj : {\n            default: obj\n        };\n    }\n},\n\"852bbaa9\": function(module, exports, __mako_require__) {\n    __mako_require__.d(exports, \"__esModule\", {\n        value: true\n    });\n    function _export(target, all) {\n        for(var name in all)Object.defineProperty(target, name, {\n            enumerable: true,\n            get: all[name]\n        });\n    }\n    __mako_require__.e(exports, {\n        _interop_require_wildcard: function() {\n            return _interop_require_wildcard;\n        },\n        _: function() {\n            return _interop_require_wildcard;\n        }\n    });\n    function _getRequireWildcardCache(nodeInterop) {\n        if (typeof WeakMap !== \"function\") return null;\n        var cacheBabelInterop = new WeakMap();\n        var cacheNodeInterop = new WeakMap();\n        return (_getRequireWildcardCache = function(nodeInterop) {\n            return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n        })(nodeInterop);\n    }\n    function _interop_require_wildcard(obj, nodeInterop) {\n        if (!nodeInterop && obj && obj.__esModule) return obj;\n        if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") return {\n            default: obj\n        };\n        var cache = _getRequireWildcardCache(nodeInterop);\n        if (cache && cache.has(obj)) return cache.get(obj);\n        var newObj = {};\n        var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n        for(var key in obj)if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n            if (desc && (desc.get || desc.set)) Object.defineProperty(newObj, key, desc);\n            else newObj[key] = obj[key];\n        }\n        newObj.default = obj;\n        if (cache) cache.set(obj, newObj);\n        return newObj;\n    }\n},\n\"d1751d7c\": function(module, exports, __mako_require__) {\n    __mako_require__.d(exports, \"__esModule\", {\n        value: true\n    });\n    function _export(target, all) {\n        for(var name in all)Object.defineProperty(target, name, {\n            enumerable: true,\n            get: all[name]\n        });\n    }\n    __mako_require__.e(exports, {\n        _export_star: function() {\n            return _export_star;\n        },\n        _: function() {\n            return _export_star;\n        }\n    });\n    function _export_star(from, to) {\n        Object.keys(from).forEach(function(k) {\n            if (k !== \"default\" && !Object.prototype.hasOwnProperty.call(to, k)) Object.defineProperty(to, k, {\n                enumerable: true,\n                get: function() {\n                    return from[k];\n                }\n            });\n        });\n        return from;\n    }\n}\n  });\n        \n\n  global.__mako_require_module__ = requireModule;\n  global.__mako_chunk_load__ = requireModule.ensure;\n\n  requireModule(entryModuleId);\n\n  return {\n\n    requireModule: requireModule,\n\n    _jsonpCallback: jsonpCallback,\n\n\n  };\n}\n\nvar root = typeof globalThis !== 'undefined' ? globalThis : self;\n\nvar runtime = createRuntime(m, e, root);\n\n\nroot.jsonpCallback = runtime._jsonpCallback;\n\n\n\n\n\n","// WebWorker for heavy image processing operations\n// This worker handles OpenCV blur, Camera Raw filters, and large canvas operations\n// to prevent blocking the main thread\n\nimport { CameraRawSettings, CurvePoint } from '../utils/cameraRawHelpers';\n\nexport type WorkerMessageType =\n  | 'APPLY_BLUR'\n  | 'APPLY_CAMERA_RAW'\n  | 'APPLY_HSL'\n  | 'APPLY_CURVES'\n  | 'PROCESS_IMAGE';\n\nexport interface WorkerMessage {\n  type: WorkerMessageType;\n  id: string;\n  payload: any;\n}\n\nexport interface WorkerResponse {\n  type: WorkerMessageType;\n  id: string;\n  success: boolean;\n  data?: ImageData;\n  error?: string;\n}\n\n// Helper functions for color conversion (duplicated for worker context)\nconst clamp = (value: number, min = 0, max = 255): number =>\n  Math.max(min, Math.min(max, Math.round(value)));\n\nconst clamp01 = (value: number): number => Math.max(0, Math.min(1, value));\n\nconst rgbToHsl = (r: number, g: number, b: number): [number, number, number] => {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  let h = 0;\n  let s = 0;\n  const l = (max + min) / 2;\n\n  if (max !== min) {\n    const d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r:\n        h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\n        break;\n      case g:\n        h = ((b - r) / d + 2) / 6;\n        break;\n      case b:\n        h = ((r - g) / d + 4) / 6;\n        break;\n    }\n  }\n\n  return [h, s, l];\n};\n\nconst hslToRgb = (h: number, s: number, l: number): [number, number, number] => {\n  let r: number, g: number, b: number;\n\n  if (s === 0) {\n    r = g = b = l;\n  } else {\n    const hue2rgb = (p: number, q: number, t: number) => {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n};\n\n// Color ranges for HSL adjustments\nconst colorRanges = [\n  { name: 'red', range: [345, 15] as [number, number] },\n  { name: 'orange', range: [15, 45] as [number, number] },\n  { name: 'yellow', range: [45, 75] as [number, number] },\n  { name: 'green', range: [75, 165] as [number, number] },\n  { name: 'cyan', range: [165, 195] as [number, number] },\n  { name: 'blue', range: [195, 255] as [number, number] },\n  { name: 'purple', range: [255, 285] as [number, number] },\n  { name: 'magenta', range: [285, 345] as [number, number] },\n];\n\n// Spline calculation for curves\nconst calculateSpline = (points: CurvePoint[]): number[] => {\n  const sorted = [...points].sort((a, b) => a.x - b.x);\n  if (sorted[0].x > 0) sorted.unshift({ x: 0, y: sorted[0].y });\n  if (sorted[sorted.length - 1].x < 255) sorted.push({ x: 255, y: sorted[sorted.length - 1].y });\n\n  const xs = sorted.map((p) => p.x);\n  const ys = sorted.map((p) => p.y);\n  const n = xs.length;\n\n  const dys: number[] = [];\n  const dxs: number[] = [];\n  const ms: number[] = [];\n  for (let i = 0; i < n - 1; i++) {\n    const dx = xs[i + 1] - xs[i];\n    const dy = ys[i + 1] - ys[i];\n    dxs.push(dx);\n    dys.push(dy);\n    ms.push(dy / dx);\n  }\n\n  const c1s: number[] = [ms[0]];\n  for (let i = 0; i < n - 2; i++) {\n    const m = ms[i];\n    const mNext = ms[i + 1];\n    if (m * mNext <= 0) {\n      c1s.push(0);\n    } else {\n      const dx = dxs[i];\n      const dxNext = dxs[i + 1];\n      const common = dx + dxNext;\n      c1s.push((3 * common) / ((common + dxNext) / m + (common + dx) / mNext));\n    }\n  }\n  c1s.push(ms[ms.length - 1]);\n\n  const lut: number[] = new Array(256).fill(0);\n  for (let i = 0; i < n - 1; i++) {\n    const xStart = xs[i];\n    const xEnd = xs[i + 1];\n    const yStart = ys[i];\n    const yEnd = ys[i + 1];\n    const m1 = c1s[i];\n    const m2 = c1s[i + 1];\n    const dx = xEnd - xStart;\n\n    for (let x = xStart; x <= xEnd; x++) {\n      if (x >= 256) break;\n      const t = (x - xStart) / dx;\n      const t2 = t * t;\n      const t3 = t2 * t;\n\n      const h00 = 2 * t3 - 3 * t2 + 1;\n      const h10 = t3 - 2 * t2 + t;\n      const h01 = -2 * t3 + 3 * t2;\n      const h11 = t3 - t2;\n\n      const y = h00 * yStart + h10 * dx * m1 + h01 * yEnd + h11 * dx * m2;\n      lut[Math.round(x)] = clamp(Math.round(y));\n    }\n  }\n  return lut;\n};\n\n// Apply Camera Raw pipeline\nconst applyCameraRawPipeline = (imageData: ImageData, settings: CameraRawSettings): ImageData => {\n  const data = imageData.data;\n  const { hsl, curves, colorGrading } = settings;\n\n  const masterLut = calculateSpline(curves.master);\n  const redLut = calculateSpline(curves.red);\n  const greenLut = calculateSpline(curves.green);\n  const blueLut = calculateSpline(curves.blue);\n\n  const shadowRgb = hslToRgb(\n    colorGrading.shadows.h / 360,\n    colorGrading.shadows.s,\n    colorGrading.shadows.l * 2,\n  );\n  const midtoneRgb = hslToRgb(\n    colorGrading.midtones.h / 360,\n    colorGrading.midtones.s,\n    colorGrading.midtones.l * 2,\n  );\n  const highlightRgb = hslToRgb(\n    colorGrading.highlights.h / 360,\n    colorGrading.highlights.s,\n    colorGrading.highlights.l * 2,\n  );\n\n  for (let i = 0; i < data.length; i += 4) {\n    let r = data[i];\n    let g = data[i + 1];\n    let b = data[i + 2];\n\n    // Apply curves\n    r = redLut[r];\n    g = greenLut[g];\n    b = blueLut[b];\n    r = masterLut[r];\n    g = masterLut[g];\n    b = masterLut[b];\n\n    // Apply HSL adjustments\n    let [h, s, l] = rgbToHsl(r, g, b);\n    let deg = (h * 360 + 360) % 360;\n\n    const entry = colorRanges.find(({ range }) => {\n      const [start, end] = range;\n      if (start <= end) return deg >= start && deg <= end;\n      return deg >= start || deg <= end;\n    });\n\n    if (entry) {\n      const adj = hsl[entry.name];\n      if (adj) {\n        const [startRaw, endRaw] = entry.range;\n        let start = startRaw;\n        let end = endRaw;\n        if (start > end) end += 360;\n\n        let degNorm = deg;\n        if (degNorm < start) degNorm += 360;\n\n        if (adj.h !== 0) {\n          let newDeg = degNorm + adj.h;\n          if (newDeg < start) newDeg = start;\n          if (newDeg > end) newDeg = end;\n          deg = ((newDeg % 360) + 360) % 360;\n          h = deg / 360;\n        }\n        if (adj.s !== 0) {\n          const satPercent = Math.abs(adj.s) <= 1 ? adj.s * 100 : adj.s;\n          s = clamp01(s * (1 + satPercent / 100));\n        }\n        if (adj.l !== 0) {\n          const lumPercent = Math.abs(adj.l) <= 1 ? adj.l * 100 : adj.l;\n          l = clamp01(l * (1 + lumPercent / 100));\n        }\n        [r, g, b] = hslToRgb(h, s, l);\n      } else {\n        [r, g, b] = hslToRgb(h, s, l);\n      }\n    }\n\n    // Apply color grading based on luminance\n    const luma = (r * 0.299 + g * 0.587 + b * 0.114) / 255;\n    const blending = colorGrading.blending / 100;\n    const balance = (colorGrading.balance + 100) / 200;\n\n    // Shadows (low luma), Midtones (mid luma), Highlights (high luma)\n    const shadowWeight = Math.max(0, 1 - luma * 2) * blending;\n    const highlightWeight = Math.max(0, (luma - 0.5) * 2) * blending;\n    const midtoneWeight = (1 - Math.abs(luma - 0.5) * 2) * blending;\n\n    r = clamp(\n      r +\n        shadowRgb[0] * shadowWeight +\n        midtoneRgb[0] * midtoneWeight +\n        highlightRgb[0] * highlightWeight,\n    );\n    g = clamp(\n      g +\n        shadowRgb[1] * shadowWeight +\n        midtoneRgb[1] * midtoneWeight +\n        highlightRgb[1] * highlightWeight,\n    );\n    b = clamp(\n      b +\n        shadowRgb[2] * shadowWeight +\n        midtoneRgb[2] * midtoneWeight +\n        highlightRgb[2] * highlightWeight,\n    );\n\n    // Apply temperature and tint\n    const temp = colorGrading.temperature / 100;\n    const tint = colorGrading.tint / 100;\n\n    r = clamp(r + temp * 30);\n    b = clamp(b - temp * 30);\n    g = clamp(g + tint * 20);\n\n    data[i] = r;\n    data[i + 1] = g;\n    data[i + 2] = b;\n  }\n\n  return imageData;\n};\n\n// Gaussian blur implementation (for when OpenCV is not available in worker)\nconst applyGaussianBlur = (imageData: ImageData, radius: number): ImageData => {\n  const { data, width, height } = imageData;\n  const result = new Uint8ClampedArray(data.length);\n\n  // Create Gaussian kernel\n  const kernelSize = Math.max(1, Math.floor(radius)) * 2 + 1;\n  const sigma = radius / 3;\n  const kernel: number[] = [];\n  let kernelSum = 0;\n\n  for (let i = 0; i < kernelSize; i++) {\n    const x = i - Math.floor(kernelSize / 2);\n    const g = Math.exp(-(x * x) / (2 * sigma * sigma));\n    kernel.push(g);\n    kernelSum += g;\n  }\n\n  // Normalize kernel\n  for (let i = 0; i < kernel.length; i++) {\n    kernel[i] /= kernelSum;\n  }\n\n  const halfKernel = Math.floor(kernelSize / 2);\n\n  // Horizontal pass\n  const temp = new Uint8ClampedArray(data.length);\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n      let r = 0,\n        g = 0,\n        b = 0,\n        a = 0;\n      for (let k = -halfKernel; k <= halfKernel; k++) {\n        const px = Math.min(Math.max(x + k, 0), width - 1);\n        const idx = (y * width + px) * 4;\n        const weight = kernel[k + halfKernel];\n        r += data[idx] * weight;\n        g += data[idx + 1] * weight;\n        b += data[idx + 2] * weight;\n        a += data[idx + 3] * weight;\n      }\n      const idx = (y * width + x) * 4;\n      temp[idx] = r;\n      temp[idx + 1] = g;\n      temp[idx + 2] = b;\n      temp[idx + 3] = a;\n    }\n  }\n\n  // Vertical pass\n  for (let y = 0; y < height; y++) {\n    for (let x = 0; x < width; x++) {\n      let r = 0,\n        g = 0,\n        b = 0,\n        a = 0;\n      for (let k = -halfKernel; k <= halfKernel; k++) {\n        const py = Math.min(Math.max(y + k, 0), height - 1);\n        const idx = (py * width + x) * 4;\n        const weight = kernel[k + halfKernel];\n        r += temp[idx] * weight;\n        g += temp[idx + 1] * weight;\n        b += temp[idx + 2] * weight;\n        a += temp[idx + 3] * weight;\n      }\n      const idx = (y * width + x) * 4;\n      result[idx] = r;\n      result[idx + 1] = g;\n      result[idx + 2] = b;\n      result[idx + 3] = a;\n    }\n  }\n\n  return new ImageData(result, width, height);\n};\n\n// Apply blur with mask\nconst applyBlurWithMask = (\n  sourceData: ImageData,\n  maskData: ImageData,\n  blurAmount: number,\n  feather: number,\n): ImageData => {\n  const blurred = applyGaussianBlur(sourceData, blurAmount);\n  const { data: srcData, width, height } = sourceData;\n  const { data: blurData } = blurred;\n  const { data: maskDataArr } = maskData;\n\n  // Optional: feather the mask\n  let featheredMask = maskData;\n  if (feather > 1) {\n    featheredMask = applyGaussianBlur(maskData, feather);\n  }\n  const { data: featheredMaskData } = featheredMask;\n\n  const result = new Uint8ClampedArray(srcData.length);\n\n  for (let i = 0; i < srcData.length; i += 4) {\n    // Use grayscale value of mask as blend factor\n    const maskValue = featheredMaskData[i] / 255;\n\n    result[i] = srcData[i] * (1 - maskValue) + blurData[i] * maskValue;\n    result[i + 1] = srcData[i + 1] * (1 - maskValue) + blurData[i + 1] * maskValue;\n    result[i + 2] = srcData[i + 2] * (1 - maskValue) + blurData[i + 2] * maskValue;\n    result[i + 3] = srcData[i + 3];\n  }\n\n  return new ImageData(result, width, height);\n};\n\n// Message handler\nself.onmessage = (e: MessageEvent<WorkerMessage>) => {\n  const { type, id, payload } = e.data;\n\n  try {\n    let result: ImageData;\n\n    switch (type) {\n      case 'APPLY_BLUR': {\n        const { imageData, maskData, blurAmount, feather } = payload;\n        result = applyBlurWithMask(imageData, maskData, blurAmount, feather);\n        break;\n      }\n\n      case 'APPLY_CAMERA_RAW': {\n        const { imageData, settings } = payload;\n        result = applyCameraRawPipeline(imageData, settings);\n        break;\n      }\n\n      case 'APPLY_CURVES': {\n        const { imageData, curves } = payload;\n        const masterLut = calculateSpline(curves.master);\n        const redLut = calculateSpline(curves.red);\n        const greenLut = calculateSpline(curves.green);\n        const blueLut = calculateSpline(curves.blue);\n\n        const data = imageData.data;\n        for (let i = 0; i < data.length; i += 4) {\n          data[i] = masterLut[redLut[data[i]]];\n          data[i + 1] = masterLut[greenLut[data[i + 1]]];\n          data[i + 2] = masterLut[blueLut[data[i + 2]]];\n        }\n        result = imageData;\n        break;\n      }\n\n      case 'PROCESS_IMAGE': {\n        // Generic image processing - can be extended\n        result = payload.imageData;\n        break;\n      }\n\n      default:\n        throw new Error(`Unknown message type: ${type}`);\n    }\n\n    const response: WorkerResponse = {\n      type,\n      id,\n      success: true,\n      data: result,\n    };\n\n    // Use postMessage with transfer list for better performance\n    (self as unknown as Worker).postMessage(response, [result.data.buffer]);\n  } catch (error) {\n    const response: WorkerResponse = {\n      type,\n      id,\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error',\n    };\n    (self as unknown as Worker).postMessage(response);\n  }\n};\n\nexport {};\n"],"names":[],"mappings":"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"}