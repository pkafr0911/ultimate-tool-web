{"version":3,"sources":["src/pages/WheelOfNames/index.tsx"],"sourcesContent":["import { Button, Card, Input, message, Space, Typography } from 'antd';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport Confetti from 'react-confetti';\r\nimport './styles.less';\r\n\r\nconst { Title } = Typography;\r\nconst colors: string[] = ['#ff7875', '#ffa940', '#ffd666', '#95de64', '#69c0ff', '#b37feb'];\r\n\r\nconst WheelOfNames: React.FC = () => {\r\n  const [nameInput, setNameInput] = useState('Alice\\nBob\\nCharlie\\nDavid');\r\n  const [names, setNames] = useState<string[]>([]);\r\n  const [rotation, setRotation] = useState(0);\r\n  const [spinning, setSpinning] = useState(false);\r\n  const [winner, setWinner] = useState<string | null>(null);\r\n  const [showConfetti, setShowConfetti] = useState(false);\r\n  const [canvasSize, setCanvasSize] = useState(450);\r\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    setNames(nameInput.split('\\n').filter((n) => n.trim() !== ''));\r\n  }, [nameInput]);\r\n\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      const size = Math.min(window.innerWidth * 0.8, 450);\r\n      setCanvasSize(size);\r\n    };\r\n    handleResize();\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    drawWheel(rotation);\r\n  }, [rotation, names, canvasSize]);\r\n\r\n  const drawWheel = (angle: number) => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext('2d');\r\n    if (!ctx) return;\r\n\r\n    const total = names.length || 1;\r\n    const arc = (2 * Math.PI) / total;\r\n\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    ctx.save();\r\n    ctx.translate(canvas.width / 2, canvas.height / 2);\r\n    ctx.rotate((angle * Math.PI) / 180);\r\n\r\n    names.forEach((name, i) => {\r\n      ctx.beginPath();\r\n      ctx.fillStyle = colors[i % colors.length];\r\n      ctx.moveTo(0, 0);\r\n      ctx.arc(0, 0, canvas.width / 2, i * arc, (i + 1) * arc);\r\n      ctx.fill();\r\n\r\n      ctx.save();\r\n      ctx.fillStyle = '#fff';\r\n      ctx.font = `bold ${Math.max(14, canvas.width / 22)}px sans-serif`;\r\n      ctx.translate(\r\n        Math.cos(i * arc + arc / 2) * (canvas.width / 3),\r\n        Math.sin(i * arc + arc / 2) * (canvas.height / 3),\r\n      );\r\n      ctx.rotate(i * arc + arc / 2);\r\n      ctx.fillText(name, -ctx.measureText(name).width / 2, 5);\r\n      ctx.restore();\r\n    });\r\n\r\n    if (!spinning) {\r\n      ctx.fillStyle = '#fff';\r\n      ctx.font = `bold ${Math.max(18, canvas.width / 18)}px sans-serif`;\r\n      ctx.fillText('Tap or Spin', -ctx.measureText('Tap or Spin').width / 2, 10);\r\n    }\r\n\r\n    ctx.restore();\r\n  };\r\n\r\n  const handleSpin = () => {\r\n    if (names.length < 2) {\r\n      message.error('Add at least two names!');\r\n      return;\r\n    }\r\n\r\n    setWinner(null);\r\n    setSpinning(true);\r\n    const newRotation = rotation + 360 * 5 + Math.floor(Math.random() * 360);\r\n    animateSpin(rotation, newRotation, 4000);\r\n  };\r\n\r\n  const animateSpin = (start: number, end: number, duration: number) => {\r\n    const startTime = Date.now();\r\n    const animate = () => {\r\n      const elapsed = Date.now() - startTime;\r\n      const progress = Math.min(elapsed / duration, 1);\r\n      const easeOut = 1 - Math.pow(1 - progress, 3);\r\n      setRotation(start + (end - start) * easeOut);\r\n\r\n      if (progress < 1) {\r\n        requestAnimationFrame(animate);\r\n      } else {\r\n        const normalized = ((end % 360) + 360) % 360;\r\n        const segment = 360 / names.length;\r\n        const winnerIndex = Math.floor((360 - normalized) / segment) % names.length;\r\n        const selectedWinner = names[winnerIndex];\r\n        setWinner(selectedWinner);\r\n        setSpinning(false);\r\n        message.success(`Winner: ${selectedWinner}`);\r\n\r\n        setShowConfetti(true);\r\n        setTimeout(() => setShowConfetti(false), 15000);\r\n      }\r\n    };\r\n    requestAnimationFrame(animate);\r\n  };\r\n\r\n  // Enable tap/spin on mobile touch\r\n  const handleTouch = (e: React.TouchEvent<HTMLCanvasElement>) => {\r\n    e.preventDefault();\r\n    if (!spinning) handleSpin();\r\n  };\r\n\r\n  return (\r\n    <div className=\"wheel-light-container\">\r\n      {showConfetti && <Confetti />}\r\n      <Card className=\"wheel-light-card\" variant=\"borderless\">\r\n        <Title level={3} className=\"wheel-light-title\">\r\n          ðŸŽ¡ Wheel of Names\r\n        </Title>\r\n        <div className=\"wheel-light-content\">\r\n          <div className=\"wheel-light-canvas\">\r\n            <canvas\r\n              ref={canvasRef}\r\n              width={canvasSize}\r\n              height={canvasSize}\r\n              onClick={handleSpin}\r\n              onTouchStart={handleTouch}\r\n              style={{ cursor: 'pointer' }}\r\n            />\r\n            <div className=\"wheel-light-pointer\" />\r\n          </div>\r\n\r\n          <div className=\"wheel-light-controls\">\r\n            <Button\r\n              type=\"primary\"\r\n              size=\"large\"\r\n              className=\"spin-btn-light\"\r\n              onClick={handleSpin}\r\n              disabled={spinning}\r\n            >\r\n              Spin the Wheel\r\n            </Button>\r\n\r\n            {winner && (\r\n              <Title level={4} style={{ color: '#52c41a', marginTop: 10 }}>\r\n                Winner: {winner}\r\n              </Title>\r\n            )}\r\n\r\n            <Space direction=\"vertical\" style={{ width: '100%', marginTop: 16 }}>\r\n              <Input.TextArea\r\n                rows={8}\r\n                value={nameInput}\r\n                onChange={(e) => setNameInput(e.target.value)}\r\n                placeholder=\"Enter names, each on a new line\"\r\n              />\r\n            </Space>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WheelOfNames;\r\n"],"names":[],"mappings":"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"}