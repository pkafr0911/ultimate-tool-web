(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ultimate-tool-web"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ultimate-tool-web"]||[]).push([["9b232423"],{"18b700d5":function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return eE;}});var r=a("777fffbe"),d=a("852bbaa9"),i=a("95bd365d"),n=a("0ec3d373"),o=r._(n),s=a("bb4b9fac"),l=r._(s),c=a("c213ceab"),u=r._(c),h=a("94e78bcf"),f=r._(h),p=a("d977ab6b"),y=r._(p),w=a("e015c964"),m=r._(w),g=a("4f331305"),b=r._(g),v=a("5a83e636"),x=r._(v),J=a("05c9ca64"),j=r._(J),S=a("522a0302"),T=r._(S),W=a("0ed998a9"),H=r._(W),k=a("cb204712"),I=r._(k),N=a("8d8ab812"),_=a("1ef77a82"),C=r._(_),A=a("73dd476b"),E=r._(A),P=a("226295f2"),F=r._(P),O=async(e,t,a)=>{let r=await (0,F.default)(e,t,"sign");return(0,E.default)(e,r),new Uint8Array(await crypto.subtle.sign((0,C.default)(e,r.algorithm),r,a));},U=a("7c6096fc"),D=r._(U),M=a("73ce5a73"),V=a("6271d39b"),z=a("6ac5dabe"),$=r._(z),L=a("03e93dbf"),R=r._(L),B=a("cea8993c"),K=r._(B);class q{#e;#t;#a;constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#e=e;}setProtectedHeader(e){if(this.#t)throw TypeError("setProtectedHeader can only be called once");return this.#t=e,this;}setUnprotectedHeader(e){if(this.#a)throw TypeError("setUnprotectedHeader can only be called once");return this.#a=e,this;}async sign(e,t){let a;if(!this.#t&&!this.#a)throw new M.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,D.default)(this.#t,this.#a))throw new M.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let r={...this.#t,...this.#a},d=(0,R.default)(M.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this.#t,r),i=!0;if(d.has("b64")&&"boolean"!=typeof(i=this.#t.b64))throw new M.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:n}=r;if("string"!=typeof n||!n)throw new M.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,$.default)(n,e,"sign");let o=this.#e;i&&(o=V.encoder.encode((0,N.encode)(o))),a=this.#t?V.encoder.encode((0,N.encode)(JSON.stringify(this.#t))):V.encoder.encode("");let s=(0,V.concat)(a,V.encoder.encode("."),o),l=await (0,K.default)(e,n),c=await O(n,l,s),u={signature:(0,N.encode)(c),payload:""};return i&&(u.payload=V.decoder.decode(o)),this.#a&&(u.header=this.#a),this.#t&&(u.protected=V.decoder.decode(a)),u;}}class G{#r;constructor(e){this.#r=new q(e);}setProtectedHeader(e){return this.#r.setProtectedHeader(e),this;}async sign(e,t){let a=await this.#r.sign(e,t);if(void 0===a.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${a.protected}.${a.payload}.${a.signature}`;}}var Q=e=>Math.floor(e.getTime()/1e3);let X=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;var Y=e=>{let t;let a=X.exec(e);if(!a||a[4]&&a[1])throw TypeError("Invalid time period format");let r=parseFloat(a[2]);switch(a[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":t=Math.round(r);break;case"minute":case"minutes":case"min":case"mins":case"m":t=Math.round(60*r);break;case"hour":case"hours":case"hr":case"hrs":case"h":t=Math.round(3600*r);break;case"day":case"days":case"d":t=Math.round(86400*r);break;case"week":case"weeks":case"w":t=Math.round(604800*r);break;default:t=Math.round(31557600*r);}return"-"===a[1]||"ago"===a[4]?-t:t;},Z=a("5eae92db"),ee=r._(Z);function et(e,t){if(!Number.isFinite(t))throw TypeError(`Invalid ${e} input`);return t;}let ea=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,er=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));class ed{#e;constructor(e){if(!(0,ee.default)(e))throw TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(e);}data(){return V.encoder.encode(JSON.stringify(this.#e));}get iss(){return this.#e.iss;}set iss(e){this.#e.iss=e;}get sub(){return this.#e.sub;}set sub(e){this.#e.sub=e;}get aud(){return this.#e.aud;}set aud(e){this.#e.aud=e;}set jti(e){this.#e.jti=e;}set nbf(e){"number"==typeof e?this.#e.nbf=et("setNotBefore",e):e instanceof Date?this.#e.nbf=et("setNotBefore",Q(e)):this.#e.nbf=Q(new Date)+Y(e);}set exp(e){"number"==typeof e?this.#e.exp=et("setExpirationTime",e):e instanceof Date?this.#e.exp=et("setExpirationTime",Q(e)):this.#e.exp=Q(new Date)+Y(e);}set iat(e){void 0===e?this.#e.iat=Q(new Date):e instanceof Date?this.#e.iat=et("setIssuedAt",Q(e)):"string"==typeof e?this.#e.iat=et("setIssuedAt",Q(new Date)+Y(e)):this.#e.iat=et("setIssuedAt",e);}}class ei{#t;#d;constructor(e={}){this.#d=new ed(e);}setIssuer(e){return this.#d.iss=e,this;}setSubject(e){return this.#d.sub=e,this;}setAudience(e){return this.#d.aud=e,this;}setJti(e){return this.#d.jti=e,this;}setNotBefore(e){return this.#d.nbf=e,this;}setExpirationTime(e){return this.#d.exp=e,this;}setIssuedAt(e){return this.#d.iat=e,this;}setProtectedHeader(e){return this.#t=e,this;}async sign(e,t){var a;let r=new G(this.#d.data());if(r.setProtectedHeader(this.#t),Array.isArray(null===(a=this.#t)||void 0===a?void 0:a.crit)&&this.#t.crit.includes("b64")&&!1===this.#t.b64)throw new M.JWTInvalid("JWTs MUST NOT use unencoded payload");return r.sign(e,t);}}var en=async(e,t,a,r)=>{let d=await (0,F.default)(e,t,"verify");(0,E.default)(e,d);let i=(0,C.default)(e,d.algorithm);try{return await crypto.subtle.verify(i,d,a,r);}catch{return!1;}},eo=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t);};async function es(e,t,a){let r,d;if(!(0,ee.default)(e))throw new M.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new M.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new M.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new M.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new M.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,ee.default)(e.header))throw new M.JWSInvalid("JWS Unprotected Header incorrect type");let i={};if(e.protected)try{let t=(0,N.decode)(e.protected);i=JSON.parse(V.decoder.decode(t));}catch{throw new M.JWSInvalid("JWS Protected Header is invalid");}if(!(0,D.default)(i,e.header))throw new M.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let n={...i,...e.header},o=(0,R.default)(M.JWSInvalid,new Map([["b64",!0]]),null==a?void 0:a.crit,i,n),s=!0;if(o.has("b64")&&"boolean"!=typeof(s=i.b64))throw new M.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:l}=n;if("string"!=typeof l||!l)throw new M.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let c=a&&eo("algorithms",a.algorithms);if(c&&!c.has(l))throw new M.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter value not allowed');if(s){if("string"!=typeof e.payload)throw new M.JWSInvalid("JWS Payload must be a string");}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new M.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let u=!1;"function"==typeof t&&(t=await t(i,e),u=!0),(0,$.default)(l,t,"verify");let h=(0,V.concat)(V.encoder.encode(e.protected??""),V.encoder.encode("."),"string"==typeof e.payload?V.encoder.encode(e.payload):e.payload);try{r=(0,N.decode)(e.signature);}catch{throw new M.JWSInvalid("Failed to base64url decode the signature");}let f=await (0,K.default)(t,l);if(!await en(l,f,r,h))throw new M.JWSSignatureVerificationFailed;if(s)try{d=(0,N.decode)(e.payload);}catch{throw new M.JWSInvalid("Failed to base64url decode the payload");}else d="string"==typeof e.payload?V.encoder.encode(e.payload):e.payload;let p={payload:d};return(void 0!==e.protected&&(p.protectedHeader=i),void 0!==e.header&&(p.unprotectedHeader=e.header),u)?{...p,key:f}:p;}async function el(e,t,a){if(e instanceof Uint8Array&&(e=V.decoder.decode(e)),"string"!=typeof e)throw new M.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:r,1:d,2:i,length:n}=e.split(".");if(3!==n)throw new M.JWSInvalid("Invalid Compact JWS");let o=await es({payload:d,protected:r,signature:i},t,a),s={payload:o.payload,protectedHeader:o.protectedHeader};return"function"==typeof t?{...s,key:o.key}:s;}async function ec(e,t,a){var r;let d=await el(e,t,a);if((null===(r=d.protectedHeader.crit)||void 0===r?void 0:r.includes("b64"))&&!1===d.protectedHeader.b64)throw new M.JWTInvalid("JWTs MUST NOT use unencoded payload");let i={payload:function(e,t,a={}){let r,d;try{r=JSON.parse(V.decoder.decode(t));}catch{}if(!(0,ee.default)(r))throw new M.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{typ:i}=a;if(i&&("string"!=typeof e.typ||ea(e.typ)!==ea(i)))throw new M.JWTClaimValidationFailed('unexpected "typ" JWT header value',r,"typ","check_failed");let{requiredClaims:n=[],issuer:o,subject:s,audience:l,maxTokenAge:c}=a,u=[...n];for(let e of(void 0!==c&&u.push("iat"),void 0!==l&&u.push("aud"),void 0!==s&&u.push("sub"),void 0!==o&&u.push("iss"),new Set(u.reverse())))if(!(e in r))throw new M.JWTClaimValidationFailed(`missing required "${e}" claim`,r,e,"missing");if(o&&!(Array.isArray(o)?o:[o]).includes(r.iss))throw new M.JWTClaimValidationFailed('unexpected "iss" claim value',r,"iss","check_failed");if(s&&r.sub!==s)throw new M.JWTClaimValidationFailed('unexpected "sub" claim value',r,"sub","check_failed");if(l&&!er(r.aud,"string"==typeof l?[l]:l))throw new M.JWTClaimValidationFailed('unexpected "aud" claim value',r,"aud","check_failed");switch(typeof a.clockTolerance){case"string":d=Y(a.clockTolerance);break;case"number":d=a.clockTolerance;break;case"undefined":d=0;break;default:throw TypeError("Invalid clockTolerance option type");}let{currentDate:h}=a,f=Q(h||new Date);if((void 0!==r.iat||c)&&"number"!=typeof r.iat)throw new M.JWTClaimValidationFailed('"iat" claim must be a number',r,"iat","invalid");if(void 0!==r.nbf){if("number"!=typeof r.nbf)throw new M.JWTClaimValidationFailed('"nbf" claim must be a number',r,"nbf","invalid");if(r.nbf>f+d)throw new M.JWTClaimValidationFailed('"nbf" claim timestamp check failed',r,"nbf","check_failed");}if(void 0!==r.exp){if("number"!=typeof r.exp)throw new M.JWTClaimValidationFailed('"exp" claim must be a number',r,"exp","invalid");if(r.exp<=f-d)throw new M.JWTExpired('"exp" claim timestamp check failed',r,"exp","check_failed");}if(c){let e=f-r.iat;if(e-d>("number"==typeof c?c:Y(c)))throw new M.JWTExpired('"iat" claim timestamp check failed (too far in the past)',r,"iat","check_failed");if(e<0-d)throw new M.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',r,"iat","check_failed");}return r;}(d.protectedHeader,d.payload,a),protectedHeader:d.protectedHeader};return"function"==typeof t?{...i,key:d.key}:i;}var eu=a("314fd1a3"),eh=d._(eu),ef=a("2ac36d38"),ep=r._(ef),ey={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"}}]},name:"arrow-right",theme:"outlined"},ew=a("8fb0e3f9"),em=r._(ew),eg=eh.forwardRef(function(e,t){return eh.createElement(em.default,(0,ep.default)((0,ep.default)({},e),{},{ref:t,icon:ey}));}),eb={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},ev=eh.forwardRef(function(e,t){return eh.createElement(em.default,(0,ep.default)((0,ep.default)({},e),{},{ref:t,icon:eb}));}),ex=a("307d4d2d"),eJ=r._(ex),ej=a("4f4539af"),eS=r._(ej),eT=a("7a7f784d"),eW=r._(eT),eH=a("a7018c48"),ek=r._(eH);let{TextArea:eI}=y.default,{Title:eN,Text:e_,Paragraph:eC}=T.default,{Option:eA}=b.default,eE=()=>{let[e,t]=(0,eh.useState)("HS256"),[a,r]=(0,eh.useState)('{\n  "alg": "HS256",\n  "typ": "JWT"\n}'),[d,n]=(0,eh.useState)('{\n  "sub": "1234567890",\n  "name": "John Doe",\n  "iat": 1516239022\n}'),[s,c]=(0,eh.useState)("secret"),[h,p]=(0,eh.useState)(""),[w,g]=(0,eh.useState)("2h"),v=new TextEncoder,J=(e,t)=>{try{return JSON.parse(e);}catch(e){throw Error(`Invalid JSON in ${t}`);}},S=e=>JSON.stringify(e,null,2),T=async()=>{try{let t=J(a,"Header"),i=J(d,"Payload");t.alg=e,r(S(t));let n=v.encode(s),o=new ei(i).setProtectedHeader(t).setIssuedAt();w&&(o=o.setExpirationTime(w));let l=await o.sign(n);p(l),H.default.success("Token generated successfully!");}catch(e){H.default.error(e.message||"Error generating token");}},W=async()=>{if(h)try{let t=v.encode(s),{payload:a,protectedHeader:d}=await ec(h,t,{algorithms:[e]});r(S(d)),n(S(a)),H.default.success("Token verified successfully!");}catch(e){H.default.error(`Verification failed: ${e.message}`);}};return(0,i.jsx)("div",{className:"jwt-container",children:(0,i.jsxs)(l.default,{bordered:!1,className:"jwt-main-card",children:[(0,i.jsxs)("div",{style:{textAlign:"center",marginBottom:24},children:[(0,i.jsx)(eN,{level:2,children:"\u{1F510} JWT Debugger"}),(0,i.jsx)(eC,{type:"secondary",children:"Encode and Decode JSON Web Tokens. Verify signatures with secrets."})]}),(0,i.jsxs)(m.default,{gutter:[32,32],children:[(0,i.jsx)(u.default,{xs:24,lg:12,children:(0,i.jsxs)(l.default,{title:"Decoded",className:"section-card",bordered:!1,children:[(0,i.jsx)(x.default,{direction:"vertical",style:{width:"100%",marginBottom:16},children:(0,i.jsxs)(m.default,{gutter:16,children:[(0,i.jsxs)(u.default,{span:12,children:[(0,i.jsx)(e_,{strong:!0,children:"Algorithm"}),(0,i.jsxs)(b.default,{value:e,onChange:e=>{t(e);try{let t=JSON.parse(a);t.alg=e,r(S(t));}catch{}},style:{width:"100%"},children:[(0,i.jsx)(eA,{value:"HS256",children:"HS256"}),(0,i.jsx)(eA,{value:"HS384",children:"HS384"}),(0,i.jsx)(eA,{value:"HS512",children:"HS512"})]})]}),(0,i.jsxs)(u.default,{span:12,children:[(0,i.jsx)(e_,{strong:!0,children:"Expiration"}),(0,i.jsx)(y.default,{value:w,onChange:e=>g(e.target.value),placeholder:"e.g. 2h, 10m, 7d"})]})]})}),(0,i.jsx)(j.default,{defaultActiveKey:"payload",items:[{key:"header",label:"Header",children:(0,i.jsx)("div",{className:"json-editor-container header-editor",children:(0,i.jsx)(eI,{value:a,onChange:e=>r(e.target.value),autoSize:{minRows:4,maxRows:8},className:"code-font"})})},{key:"payload",label:"Payload",children:(0,i.jsx)("div",{className:"json-editor-container payload-editor",children:(0,i.jsx)(eI,{value:d,onChange:e=>n(e.target.value),autoSize:{minRows:8,maxRows:16},className:"code-font"})})}]}),(0,i.jsxs)("div",{style:{marginTop:16},children:[(0,i.jsx)(e_,{strong:!0,children:"Secret Key"}),(0,i.jsx)(y.default.Password,{value:s,onChange:e=>c(e.target.value),placeholder:"your-256-bit-secret",iconRender:e=>e?(0,i.jsx)(ek.default,{}):(0,i.jsx)(eW.default,{})})]}),(0,i.jsx)("div",{style:{marginTop:24,textAlign:"right"},children:(0,i.jsx)(o.default,{type:"primary",icon:(0,i.jsx)(eg,{}),onClick:T,size:"large",children:"Sign / Encode"})})]})}),(0,i.jsx)(u.default,{xs:24,lg:12,children:(0,i.jsxs)(l.default,{title:"Encoded",className:"section-card",bordered:!1,children:[(0,i.jsxs)("div",{className:"encoded-container",children:[(0,i.jsx)(eI,{value:h,onChange:e=>p(e.target.value),placeholder:"Paste a JWT here...",autoSize:{minRows:8,maxRows:12},className:"code-font token-input"}),(0,i.jsxs)(x.default,{style:{marginTop:16,width:"100%",justifyContent:"space-between"},children:[(0,i.jsxs)(x.default,{children:[(0,i.jsx)(o.default,{icon:(0,i.jsx)(eJ.default,{}),onClick:()=>{if(h)try{let e=function(e){let t;if("string"==typeof e){let a=e.split(".");(3===a.length||5===a.length)&&([t]=a);}else if("object"==typeof e&&e){if("protected"in e)t=e.protected;else throw TypeError("Token does not contain a Protected Header");}try{if("string"!=typeof t||!t)throw Error();let e=JSON.parse(V.decoder.decode((0,N.decode)(t)));if(!(0,ee.default)(e))throw Error();return e;}catch{throw TypeError("Invalid Token or Protected Header formatting");}}(h),a=function(e){let t,a;if("string"!=typeof e)throw new M.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:r,length:d}=e.split(".");if(5===d)throw new M.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==d)throw new M.JWTInvalid("Invalid JWT");if(!r)throw new M.JWTInvalid("JWTs must contain a payload");try{t=(0,N.decode)(r);}catch{throw new M.JWTInvalid("Failed to base64url decode the payload");}try{a=JSON.parse(V.decoder.decode(t));}catch{throw new M.JWTInvalid("Failed to parse the decoded payload as JSON");}if(!(0,ee.default)(a))throw new M.JWTInvalid("Invalid JWT Claims Set");return a;}(h);r(S(e)),n(S(a)),e.alg&&t(e.alg),H.default.info("Token decoded (signature not verified)");}catch(e){H.default.error(`Decoding failed: ${e.message}`);}},children:"Decode Only"}),(0,i.jsx)(I.default,{title:"Copy Token",children:(0,i.jsx)(o.default,{icon:(0,i.jsx)(eS.default,{}),onClick:()=>{navigator.clipboard.writeText(h),H.default.success("Copied!");}})})]}),(0,i.jsx)(o.default,{type:"primary",icon:(0,i.jsx)(ev,{}),onClick:W,size:"large",children:"Verify / Decode"})]})]}),(0,i.jsx)(f.default,{orientation:"left",children:"Visualizer"}),(0,i.jsx)("div",{className:"visualizer-container",children:(()=>{if(!h)return null;let e=h.split(".");return 3!==e.length?(0,i.jsx)(e_,{type:"secondary",children:"Invalid token format"}):(0,i.jsxs)("div",{className:"token-visualizer",children:[(0,i.jsx)("span",{className:"token-part-header",children:e[0]}),(0,i.jsx)("span",{className:"token-dot",children:"."}),(0,i.jsx)("span",{className:"token-part-payload",children:e[1]}),(0,i.jsx)("span",{className:"token-dot",children:"."}),(0,i.jsx)("span",{className:"token-part-signature",children:e[2]})]});})()}),(0,i.jsx)("div",{className:"legend",style:{marginTop:16},children:(0,i.jsxs)(x.default,{size:"large",children:[(0,i.jsxs)(x.default,{children:[(0,i.jsx)("div",{className:"dot header-dot"}),(0,i.jsx)(e_,{type:"secondary",children:"Header"})]}),(0,i.jsxs)(x.default,{children:[(0,i.jsx)("div",{className:"dot payload-dot"}),(0,i.jsx)(e_,{type:"secondary",children:"Payload"})]}),(0,i.jsxs)(x.default,{children:[(0,i.jsx)("div",{className:"dot signature-dot"}),(0,i.jsx)(e_,{type:"secondary",children:"Signature"})]})]})})]})})]})]})});};}}]);
//# sourceMappingURL=9b232423-async.e85d4834.js.map